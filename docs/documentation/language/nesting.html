<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Nested Views | Malloy Documentation</title>
    <link rel="stylesheet" href="/css/document.css" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/img/favicon.ico"
    />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-0M10W7C20Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
    
      gtag("config", "G-0M10W7C20Y");
    </script>
    <style>
      malloy-render::part(table-container) {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="top">
      <div class="header">
        <div class="header-banner">
          <a href="http://www.malloydata.dev" target="_blank">
            <img
              class="logo"
              src="/img/logo.png"
              alt="malloy logo"
            />
          </a>

          Malloy
          <span class="subtitle">Documentation</span>
        </div>
        <div class="header-right">
          <div class="header-links">
            <a href="https://github.com/malloydata/malloy" target="_blank"
              ><img
                src="/img/github.svg"
                style="transform: scale(0.5)"
            /></a>
            <a href="/slack" target="_blank"
              ><img src="/img/slack.svg"
            /></a>
          </div>
          <form onSubmit="() => alert('submit')" action="/search">
            <div class="search-input-outer">
              <img src="/img/search.svg" alt="search" />
              <input placeholder="Search" id="search-input" name="query" />
            </div>
            <input type="submit" style="display: none" />
          </form>
        </div>
      </div>
      <div class="main">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
              <div id=about_malloy
                class="sidebar-section-title {% unless /documentation/index.html,/documentation/about/features.html,/documentation/about/tao.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                About Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation">
                <img src="/img/article_icon.svg" alt="document"/>
                What Is Malloy
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/features">
                <img src="/img/article_icon.svg" alt="document"/>
                Key Features
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/tao">
                <img src="/img/article_icon.svg" alt="document"/>
                The Tao of Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=setting_up malloy
                class="sidebar-section-title {% unless /documentation/setup/extension.html,/documentation/setup/database_support.html,/documentation/setup/config.html,/documentation/setup/cli.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Setting up Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/setup/extension">
                <img src="/img/article_icon.svg" alt="document"/>
                VS Code Extension
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/database_support">
                <img src="/img/article_icon.svg" alt="document"/>
                Database Support
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/config">
                <img src="/img/article_icon.svg" alt="document"/>
                Configuration
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/cli">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=user_guides
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/quickstart_modeling.html,/documentation/user_guides/malloy_by_example.html,/documentation/user_guides/notebooks.html,/documentation/user_guides/publishing/explorer.html,/documentation/user_guides/publishing/publishing.html,/documentation/user_guides/publishing/connections.html,/documentation/user_guides/publishing/rest_api.html,/documentation/user_guides/publishing/publisher_sdk.html,/documentation/user_guides/publishing/mcp_agents.html,/documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html,/documentation/user_guides/transform.html,/documentation/user_guides/malloy_for_dbt.html,/documentation/user_guides/troubleshooting.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                User Guides
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class="sidebar-section">
              <div id=getting_started
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/quickstart_modeling.html,/documentation/user_guides/malloy_by_example.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Getting Started
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/querying_a_model">
                <img src="/img/article_icon.svg" alt="document"/>
                Querying a Semantic Model
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/quickstart_modeling">
                <img src="/img/article_icon.svg" alt="document"/>
                Building a Semantic Model
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_by_example">
                <img src="/img/article_icon.svg" alt="document"/>
                Advanced Modeling
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=analyzing_& exploring
                class="sidebar-section-title {% unless /documentation/user_guides/notebooks.html,/documentation/user_guides/publishing/explorer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Analyzing & Exploring
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/notebooks">
                <img src="/img/article_icon.svg" alt="document"/>
                Analyzing with Notebooks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/explorer">
                <img src="/img/article_icon.svg" alt="document"/>
                Explorer UI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=publishing
                class="sidebar-section-title {% unless /documentation/user_guides/publishing/publishing.html,/documentation/user_guides/publishing/connections.html,/documentation/user_guides/publishing/rest_api.html,/documentation/user_guides/publishing/publisher_sdk.html,/documentation/user_guides/publishing/mcp_agents.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Publishing
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/publishing">
                <img src="/img/article_icon.svg" alt="document"/>
                Publish Your Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Publisher Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/rest_api">
                <img src="/img/article_icon.svg" alt="document"/>
                REST API
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/publisher_sdk">
                <img src="/img/article_icon.svg" alt="document"/>
                Publisher SDK (React)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/mcp_agents">
                <img src="/img/article_icon.svg" alt="document"/>
                MCP for AI Agents
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=for_sql users
                class="sidebar-section-title {% unless /documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                For SQL Users
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts1">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for SQL Folks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts2">
                <img src="/img/article_icon.svg" alt="document"/>
                Refactoring SQL to Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=data_transformation
                class="sidebar-section-title {% unless /documentation/user_guides/transform.html,/documentation/user_guides/malloy_for_dbt.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Data Transformation
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform & Materialize
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_for_dbt">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for dbt Users
              </a>
            </div>
              </div>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/troubleshooting">
                <img src="/img/article_icon.svg" alt="document"/>
                Troubleshooting
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=language_reference
                class="sidebar-section-title {% unless /documentation/language/statement.html,/documentation/language/source.html,/documentation/language/query.html,/documentation/language/views.html,/documentation/language/datatypes.html,/documentation/language/fields.html,/documentation/language/aggregates.html,/documentation/language/expressions.html,/documentation/language/functions.html,/documentation/language/filters.html,/documentation/language/calculations_windows.html,/documentation/language/order_by.html,/documentation/language/join.html,/documentation/language/nesting.html,/documentation/language/sql_sources.html,/documentation/language/imports.html,/documentation/language/connections.html,/documentation/language/tags.html,/documentation/language/quick_reference.html,/documentation/language/changelog.html,/documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html,/documentation/language/dialect/mssql-via-duckdb.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Language Reference
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/statement">
                <img src="/img/article_icon.svg" alt="document"/>
                Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/source">
                <img src="/img/article_icon.svg" alt="document"/>
                Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/query">
                <img src="/img/article_icon.svg" alt="document"/>
                Queries
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/views">
                <img src="/img/article_icon.svg" alt="document"/>
                Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/datatypes">
                <img src="/img/article_icon.svg" alt="document"/>
                Data Types
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/fields">
                <img src="/img/article_icon.svg" alt="document"/>
                Fields
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/aggregates">
                <img src="/img/article_icon.svg" alt="document"/>
                Aggregates
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/functions">
                <img src="/img/article_icon.svg" alt="document"/>
                Functions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/filters">
                <img src="/img/article_icon.svg" alt="document"/>
                Filters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/calculations_windows">
                <img src="/img/article_icon.svg" alt="document"/>
                Calculations (window functions)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/order_by">
                <img src="/img/article_icon.svg" alt="document"/>
                Ordering and Limiting
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/join">
                <img src="/img/article_icon.svg" alt="document"/>
                Joins
              </a>
            </div>
        <div class='sidebar-item active'>
              <a href="/documentation/language/nesting">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/sql_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/imports">
                <img src="/img/article_icon.svg" alt="document"/>
                Imports
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/tags">
                <img src="/img/article_icon.svg" alt="document"/>
                Tags
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/quick_reference.html">
                <img src="/img/article_icon.svg" alt="document"/>
                Quick Reference
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/changelog">
                <img src="/img/article_icon.svg" alt="document"/>
                Change Log
              </a>
            </div>
        <div class="sidebar-section">
              <div id=dialects
                class="sidebar-section-title {% unless /documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html,/documentation/language/dialect/mssql-via-duckdb.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Dialects
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/dialect/bigquery">
                <img src="/img/article_icon.svg" alt="document"/>
                BigQuery
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/presto-trino">
                <img src="/img/article_icon.svg" alt="document"/>
                Presto / Trino
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/snowflake">
                <img src="/img/article_icon.svg" alt="document"/>
                Snowflake
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mysql">
                <img src="/img/article_icon.svg" alt="document"/>
                MySQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                DuckDB
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/postgres">
                <img src="/img/article_icon.svg" alt="document"/>
                PostgreSQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mssql-via-duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                MSSQL via DuckDB
              </a>
            </div>
              </div>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=common_patterns
                class="sidebar-section-title {% unless /documentation/patterns/yoy.html,/documentation/patterns/foreign_sums.html,/documentation/patterns/reading_nested.html,/documentation/patterns/percent_of_total.html,/documentation/patterns/cohorts.html,/documentation/patterns/nested_subtotals.html,/documentation/patterns/other.html,/documentation/patterns/autobin.html,/documentation/patterns/moving_avg.html,/documentation/patterns/transform.html,/documentation/patterns/sessionize.html,/documentation/patterns/dim_index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Common Patterns
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/patterns/yoy">
                <img src="/img/article_icon.svg" alt="document"/>
                Comparing Timeframes
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/foreign_sums">
                <img src="/img/article_icon.svg" alt="document"/>
                Foreign Sums and Averages
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/reading_nested">
                <img src="/img/article_icon.svg" alt="document"/>
                Reading Nested Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/percent_of_total">
                <img src="/img/article_icon.svg" alt="document"/>
                Percent of Total
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/cohorts">
                <img src="/img/article_icon.svg" alt="document"/>
                Cohort Analysis
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/nested_subtotals">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Subtotals
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/other">
                <img src="/img/article_icon.svg" alt="document"/>
                Bucketing with 'Other'
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/autobin">
                <img src="/img/article_icon.svg" alt="document"/>
                Auto-binning Histograms
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/moving_avg">
                <img src="/img/article_icon.svg" alt="document"/>
                Moving Average
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/sessionize">
                <img src="/img/article_icon.svg" alt="document"/>
                Sessionize - Map/Reduce
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/dim_index">
                <img src="/img/article_icon.svg" alt="document"/>
                Dimensional Indexes
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_results
                class="sidebar-section-title {% unless /documentation/visualizations/about_rendering.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Results
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/about_rendering">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_legacy docs
                class="sidebar-section-title {% unless /documentation/visualizations/overview.html,/documentation/visualizations/numbers.html,/documentation/visualizations/links.html,/documentation/visualizations/pivots.html,/documentation/visualizations/transpose.html,/documentation/visualizations/dashboards.html,/documentation/visualizations/lists.html,/documentation/visualizations/bar_charts.html,/documentation/visualizations/charts_line_chart.html,/documentation/visualizations/scatter_charts.html,/documentation/visualizations/shape_maps.html,/documentation/visualizations/segment_maps.html,/documentation/visualizations/legacy_renderer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Legacy Docs
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/overview">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/numbers">
                <img src="/img/article_icon.svg" alt="document"/>
                Numbers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/links">
                <img src="/img/article_icon.svg" alt="document"/>
                Links
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/pivots">
                <img src="/img/article_icon.svg" alt="document"/>
                Pivoted Tables
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/transpose">
                <img src="/img/article_icon.svg" alt="document"/>
                Table Transpose
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/dashboards">
                <img src="/img/article_icon.svg" alt="document"/>
                Dashboards
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/lists">
                <img src="/img/article_icon.svg" alt="document"/>
                Lists
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/bar_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Bar Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/charts_line_chart">
                <img src="/img/article_icon.svg" alt="document"/>
                Line Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/scatter_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Scatter Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/shape_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Shape Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/segment_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Segment Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/legacy_renderer">
                <img src="/img/article_icon.svg" alt="document"/>
                Legacy Renderer
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloysql
                class="sidebar-section-title {% unless /documentation/malloy_sql/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                MalloySQL
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_sql/index">
                <img src="/img/article_icon.svg" alt="document"/>
                Using MalloySQL
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_cli
                class="sidebar-section-title {% unless /documentation/malloy_cli/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy CLI
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_cli/index">
                <img src="/img/article_icon.svg" alt="document"/>
                The Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_with python
                class="sidebar-section-title {% unless /documentation/malloy_python/python_package.html,/documentation/malloy_python/jupyter.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy with Python
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_python/python_package">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy Python Package
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/malloy_python/jupyter">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy in Jupyter Notebooks
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=experiments_(in process features)
                class="sidebar-section-title {% unless /documentation/experiments/experiments.html,/documentation/experiments/joins.html,/documentation/experiments/sql_expressions.html,/documentation/experiments/window.html,/documentation/experiments/parameters.html,/documentation/experiments/composite_sources.html,/documentation/experiments/include.html,/documentation/experiments/persistence.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Experiments (in process features)
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/experiments/experiments">
                <img src="/img/article_icon.svg" alt="document"/>
                Experiments
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/joins">
                <img src="/img/article_icon.svg" alt="document"/>
                Join INNER/RIGHT/FULL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/sql_expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/window">
                <img src="/img/article_icon.svg" alt="document"/>
                Window Partitions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/parameters">
                <img src="/img/article_icon.svg" alt="document"/>
                Parameters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/composite_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                Composite "Cube" Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/include">
                <img src="/img/article_icon.svg" alt="document"/>
                Access Modifiers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/persistence">
                <img src="/img/article_icon.svg" alt="document"/>
                Persistence
              </a>
            </div>
              </div>
            </div>
          </div>        <script src="/js/sidebar_state.js"></script>
        <div class="content">
          <div class="footer">
            
<div class="linear-navigation">
  <div class="item">
      <a href="join.html"><img src="/img/previous.svg" alt="previous"/>Joins</a>
  </div>
  <div class="item">
      <a href="sql_sources.html">SQL Sources<img src="/img/next.svg" alt="next"/></a>
  </div>
</div> 
          </div>
          <div class="document-outer"><div class="document"><div class="title-row">
        
      <h1>
        <a id="nested-views" class="header-link anchor" href="#nested-views">
          Nested Views
        </a>
      </h1>
    
        <a class="edit-link" target="_blank" href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/language/nesting.malloynb#C1">VSCode <img src="/img/open_notebook.svg" alt="document"/></a>
        </div>
      <p>Nested views are views included in other views. When a nested view is used in a query, it generates an <em>aggregating subquery</em>, which produces a subtable per row in the view in which it is embedded. The term <em>nested query</em> is often used to refer to a query which uses a nested view.</p>
<div class="code-wrapper"></div><div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/language/nesting.malloynb#C3" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> -&gt; {  </span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">state</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">by_facility</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">fac_type</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="a3273e10-1695-43c6-9e65-00a80965810b">
        <script>(()=>{var e=document.getElementById("a3273e10-1695-43c6-9e65-00a80965810b"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:[],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},arguments:{}},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}]}],filterList:[],fieldUsage:[{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],modelAnnotation:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],dependencies:{},annotation:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},text:"fac_type"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"}],imports:[]},a.queryResult={lastStageName:"__stage1",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    base."state" as "state__0",\n    CASE WHEN group_set=0 THEN\n      COUNT(1)\n      END as "airport_count__0",\n    CASE WHEN group_set=1 THEN\n      base."fac_type"\n      END as "fac_type__1",\n    CASE WHEN group_set=1 THEN\n      COUNT(1)\n      END as "airport_count__1"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,1,1)) as group_set  ) as group_set\n  GROUP BY 1,2,4\n)\nSELECT\n  "state__0" as "state",\n  MAX(CASE WHEN group_set=0 THEN "airport_count__0" END) as "airport_count",\n  COALESCE(LIST({\n    "fac_type": "fac_type__1", \n    "airport_count": "airport_count__1"}  ORDER BY  "airport_count__1" desc NULLS LAST) FILTER (WHERE group_set=1),[]) as "by_facility"\nFROM __stage0\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage1",fields:[{name:"state",type:"string",resultMetadata:{sourceField:"state",sourceClasses:["state"],referenceId:"b654fb02-ffc8-42be-892d-008a30ee11e9",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"3dd9ad8a-ea52-427c-9f0d-2a81d731c8d0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}}},{type:"array",name:"by_facility",fields:[{name:"fac_type",type:"string",resultMetadata:{sourceField:"fac_type",sourceClasses:["fac_type"],referenceId:"0996745e-900c-4f37-8912-5e31f9efd472",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"by_facility"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"3dd9ad8a-ea52-427c-9f0d-2a81d731c8d0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"by_facility"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"by_facility",filterList:[],sourceClasses:["by_facility"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many"}],dialect:"duckdb",primaryKey:"state",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],sourceExplore:"airports",sourceArguments:{},connectionName:"duckdb",result:[{state:"TX",airport_count:1845,by_facility:[{fac_type:"AIRPORT",airport_count:1389},{fac_type:"HELIPORT",airport_count:435},{fac_type:"STOLPORT",airport_count:8},{fac_type:"ULTRALIGHT",airport_count:8},{fac_type:"GLIDERPORT",airport_count:5}]},{state:"CA",airport_count:984,by_facility:[{fac_type:"AIRPORT",airport_count:569},{fac_type:"HELIPORT",airport_count:396},{fac_type:"SEAPLANE BASE",airport_count:12},{fac_type:"GLIDERPORT",airport_count:3},{fac_type:"STOLPORT",airport_count:2},{fac_type:"ULTRALIGHT",airport_count:2}]},{state:"IL",airport_count:890,by_facility:[{fac_type:"AIRPORT",airport_count:625},{fac_type:"HELIPORT",airport_count:245},{fac_type:"SEAPLANE BASE",airport_count:8},{fac_type:"ULTRALIGHT",airport_count:6},{fac_type:"BALLOONPORT",airport_count:2},{fac_type:"GLIDERPORT",airport_count:2},{fac_type:"STOLPORT",airport_count:2}]},{state:"FL",airport_count:856,by_facility:[{fac_type:"AIRPORT",airport_count:511},{fac_type:"HELIPORT",airport_count:280},{fac_type:"SEAPLANE BASE",airport_count:43},{fac_type:"STOLPORT",airport_count:13},{fac_type:"ULTRALIGHT",airport_count:5},{fac_type:"GLIDERPORT",airport_count:4}]},{state:"PA",airport_count:804,by_facility:[{fac_type:"AIRPORT",airport_count:468},{fac_type:"HELIPORT",airport_count:307},{fac_type:"ULTRALIGHT",airport_count:13},{fac_type:"SEAPLANE BASE",airport_count:10},{fac_type:"GLIDERPORT",airport_count:3},{fac_type:"STOLPORT",airport_count:3}]}],totalRows:5},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TX&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1845</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1389</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">435</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">984</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">569</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">396</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;IL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">890</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">625</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">245</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BALLOONPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;FL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">856</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">511</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">280</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">43</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">804</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">468</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">307</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;fac_type&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;fac_type__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;fac_type__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;by_facility&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="nesting-nested-views" class="header-link anchor" href="#nesting-nested-views">
          Nesting Nested Views
        </a>
      </h2>
    <p>Aggregating subqueries can be nested infinitely, meaning that a nested view can contain another nested view.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/language/nesting.malloynb#C5" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">state</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">top_5_counties</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">county</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">by_facility</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">fac_type</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="c1aeeadf-659c-4c5f-a6f8-d5eb6f94e1a6">
        <script>(()=>{var e=document.getElementById("c1aeeadf-659c-4c5f-a6f8-d5eb6f94e1a6"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:[],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},arguments:{}},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]},{type:"turtle",name:"top_5_counties",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"],drillView:"top_5_counties"},{type:"fieldref",path:["airport_count"],drillView:"top_5_counties"},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],drillView:"top_5_counties"}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["county"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]}]}],filterList:[],fieldUsage:[{path:["state"]},{path:["airport_count"]},{path:["county"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],modelAnnotation:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],dependencies:{},annotation:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"county",fieldUsage:[{path:["county"]}]},text:"county"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},text:"fac_type"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"}],imports:[]},a.queryResult={lastStageName:"__stage2",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    base."state" as "state__0",\n    CASE WHEN group_set=0 THEN\n      COUNT(1)\n      END as "airport_count__0",\n    CASE WHEN group_set IN (1,2) THEN\n      base."county"\n      END as "county__1",\n    CASE WHEN group_set=1 THEN\n      COUNT(1)\n      END as "airport_count__1",\n    CASE WHEN group_set=2 THEN\n      base."fac_type"\n      END as "fac_type__2",\n    CASE WHEN group_set=2 THEN\n      COUNT(1)\n      END as "airport_count__2"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,2,1)) as group_set  ) as group_set\n  GROUP BY 1,2,4,6\n)\n, __stage1 AS (\n  SELECT \n    CASE WHEN group_set=2 THEN 1 ELSE group_set END as group_set,\n    "state__0" as "state__0",\n    FIRST("airport_count__0") FILTER (WHERE "airport_count__0" IS NOT NULL) as "airport_count__0",\n    CASE WHEN group_set IN (1,2) THEN\n      "county__1"\n      END as "county__1",\n    FIRST("airport_count__1") FILTER (WHERE "airport_count__1" IS NOT NULL) as "airport_count__1",\n    COALESCE(LIST({\n      "fac_type": "fac_type__2", \n      "airport_count": "airport_count__2"}  ORDER BY  "airport_count__2" desc NULLS LAST) FILTER (WHERE group_set=2),[]) as "by_facility__1"\n  FROM __stage0\n  GROUP BY 1,2,4\n)\nSELECT\n  "state__0" as "state",\n  MAX(CASE WHEN group_set=0 THEN "airport_count__0" END) as "airport_count",\n  COALESCE(LIST({\n    "county": "county__1", \n    "airport_count": "airport_count__1", \n    "by_facility": "by_facility__1"}  ORDER BY  "airport_count__1" desc NULLS LAST) FILTER (WHERE group_set=1)[1:5],[]) as "top_5_counties"\nFROM __stage1\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage2",fields:[{name:"state",type:"string",resultMetadata:{sourceField:"state",sourceClasses:["state"],referenceId:"cfe82b80-4892-4bc2-9787-74e9fcdbe2ba",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"81f3aa67-719a-482f-a36a-a5a395f6c8e0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}}},{type:"array",name:"top_5_counties",fields:[{name:"county",type:"string",resultMetadata:{sourceField:"county",sourceClasses:["county"],referenceId:"a9394df6-c76b-4668-b6c7-8abf5228410e",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"top_5_counties"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"81f3aa67-719a-482f-a36a-a5a395f6c8e0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"top_5_counties"},{type:"array",name:"by_facility",fields:[{name:"fac_type",type:"string",resultMetadata:{sourceField:"fac_type",sourceClasses:["fac_type"],referenceId:"3a5c806e-e7bb-4bb0-9d84-c048bf5d0a1a",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"by_facility"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"81f3aa67-719a-482f-a36a-a5a395f6c8e0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"by_facility"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"by_facility",filterList:[],sourceClasses:["by_facility"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many",drillView:"top_5_counties"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"top_5_counties",filterList:[],sourceClasses:["top_5_counties"],fieldKind:"struct",limit:5,orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many"}],dialect:"duckdb",primaryKey:"state",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],sourceExplore:"airports",sourceArguments:{},connectionName:"duckdb",result:[{state:"TX",airport_count:1845,top_5_counties:[{county:"HARRIS",airport_count:135,by_facility:[{fac_type:"HELIPORT",airport_count:110},{fac_type:"AIRPORT",airport_count:25}]},{county:"TARRANT",airport_count:63,by_facility:[{fac_type:"HELIPORT",airport_count:35},{fac_type:"AIRPORT",airport_count:26},{fac_type:"STOLPORT",airport_count:1},{fac_type:"ULTRALIGHT",airport_count:1}]},{county:"DENTON",airport_count:53,by_facility:[{fac_type:"AIRPORT",airport_count:47},{fac_type:"HELIPORT",airport_count:6}]},{county:"DALLAS",airport_count:42,by_facility:[{fac_type:"HELIPORT",airport_count:32},{fac_type:"AIRPORT",airport_count:9},{fac_type:"STOLPORT",airport_count:1}]},{county:"BEXAR",airport_count:40,by_facility:[{fac_type:"AIRPORT",airport_count:24},{fac_type:"HELIPORT",airport_count:16}]}]},{state:"CA",airport_count:984,top_5_counties:[{county:"LOS ANGELES",airport_count:176,by_facility:[{fac_type:"HELIPORT",airport_count:151},{fac_type:"AIRPORT",airport_count:23},{fac_type:"SEAPLANE BASE",airport_count:2}]},{county:"SAN BERNARDINO",airport_count:71,by_facility:[{fac_type:"AIRPORT",airport_count:47},{fac_type:"HELIPORT",airport_count:24}]},{county:"ORANGE",airport_count:53,by_facility:[{fac_type:"HELIPORT",airport_count:47},{fac_type:"AIRPORT",airport_count:6}]},{county:"KERN",airport_count:49,by_facility:[{fac_type:"AIRPORT",airport_count:41},{fac_type:"HELIPORT",airport_count:7},{fac_type:"ULTRALIGHT",airport_count:1}]},{county:"SAN DIEGO",airport_count:49,by_facility:[{fac_type:"AIRPORT",airport_count:30},{fac_type:"HELIPORT",airport_count:17},{fac_type:"GLIDERPORT",airport_count:2}]}]},{state:"IL",airport_count:890,top_5_counties:[{county:"COOK",airport_count:51,by_facility:[{fac_type:"HELIPORT",airport_count:44},{fac_type:"AIRPORT",airport_count:7}]},{county:"LA SALLE",airport_count:39,by_facility:[{fac_type:"AIRPORT",airport_count:35},{fac_type:"HELIPORT",airport_count:4}]},{county:"MC HENRY",airport_count:29,by_facility:[{fac_type:"AIRPORT",airport_count:20},{fac_type:"HELIPORT",airport_count:7},{fac_type:"SEAPLANE BASE",airport_count:2}]},{county:"DE KALB",airport_count:27,by_facility:[{fac_type:"AIRPORT",airport_count:24},{fac_type:"HELIPORT",airport_count:3}]},{county:"WINNEBAGO",airport_count:24,by_facility:[{fac_type:"AIRPORT",airport_count:15},{fac_type:"HELIPORT",airport_count:9}]}]},{state:"FL",airport_count:856,top_5_counties:[{county:"PALM BEACH",airport_count:45,by_facility:[{fac_type:"HELIPORT",airport_count:30},{fac_type:"AIRPORT",airport_count:14},{fac_type:"GLIDERPORT",airport_count:1}]},{county:"DADE",airport_count:44,by_facility:[{fac_type:"HELIPORT",airport_count:27},{fac_type:"AIRPORT",airport_count:12},{fac_type:"GLIDERPORT",airport_count:2},{fac_type:"SEAPLANE BASE",airport_count:2},{fac_type:"STOLPORT",airport_count:1}]},{county:"POLK",airport_count:43,by_facility:[{fac_type:"AIRPORT",airport_count:18},{fac_type:"HELIPORT",airport_count:16},{fac_type:"SEAPLANE BASE",airport_count:9}]},{county:"MARION",airport_count:37,by_facility:[{fac_type:"AIRPORT",airport_count:27},{fac_type:"HELIPORT",airport_count:7},{fac_type:"SEAPLANE BASE",airport_count:2},{fac_type:"STOLPORT",airport_count:1}]},{county:"ORANGE",airport_count:36,by_facility:[{fac_type:"HELIPORT",airport_count:24},{fac_type:"AIRPORT",airport_count:8},{fac_type:"SEAPLANE BASE",airport_count:4}]}]},{state:"PA",airport_count:804,top_5_counties:[{county:"BUCKS",airport_count:55,by_facility:[{fac_type:"AIRPORT",airport_count:32},{fac_type:"HELIPORT",airport_count:19},{fac_type:"ULTRALIGHT",airport_count:2},{fac_type:"STOLPORT",airport_count:1},{fac_type:"GLIDERPORT",airport_count:1}]},{county:"MONTGOMERY",airport_count:44,by_facility:[{fac_type:"HELIPORT",airport_count:29},{fac_type:"AIRPORT",airport_count:14},{fac_type:"SEAPLANE BASE",airport_count:1}]},{county:"ALLEGHENY",airport_count:31,by_facility:[{fac_type:"HELIPORT",airport_count:22},{fac_type:"AIRPORT",airport_count:8},{fac_type:"SEAPLANE BASE",airport_count:1}]},{county:"CHESTER",airport_count:27,by_facility:[{fac_type:"HELIPORT",airport_count:16},{fac_type:"AIRPORT",airport_count:11}]},{county:"PHILADELPHIA",airport_count:26,by_facility:[{fac_type:"HELIPORT",airport_count:22},{fac_type:"AIRPORT",airport_count:4}]}]}],totalRows:5},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TX&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1845</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HARRIS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">135</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">110</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">25</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TARRANT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">63</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">35</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DENTON&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">53</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DALLAS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">42</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BEXAR&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">40</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">984</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LOS ANGELES&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">176</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">151</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SAN BERNARDINO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">71</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ORANGE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">53</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;KERN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">41</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SAN DIEGO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;IL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">890</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;COOK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">51</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">44</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LA SALLE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">39</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">35</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MC HENRY&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">29</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DE KALB&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WINNEBAGO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;FL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">856</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PALM BEACH&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DADE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">44</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;POLK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">43</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MARION&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">37</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ORANGE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">36</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">804</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BUCKS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">19</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MONTGOMERY&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">44</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">29</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ALLEGHENY&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">22</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CHESTER&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHILADELPHIA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">22</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;county&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;fac_type&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;fac_type__2&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__2&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span><span style="color: #000000">,</span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">, __stage1 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;county__1&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;fac_type__2&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__2&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__2&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;by_facility__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;by_facility&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;by_facility__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">)[1:5],[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;top_5_counties&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage1</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="filtering-nested-views" class="header-link anchor" href="#filtering-nested-views">
          Filtering Nested Views
        </a>
      </h2>
    <p>Filters can be applied at any level within nested views.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/language/nesting.malloynb#C7" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">state</span><span style="color: #000000"> ? </span><span style="color: #A31515">&#39;CA&#39;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#39;NY&#39;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#39;MN&#39;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">state</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">top_5_counties</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">county</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">major_facilities</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">major</span><span style="color: #000000"> = </span><span style="color: #A31515">&#39;Y&#39;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">name</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">concat</span><span style="color: #000000">(</span><span style="color: #001080">code</span><span style="color: #000000">, </span><span style="color: #A31515">&#39; - &#39;</span><span style="color: #000000">, </span><span style="color: #001080">full_name</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">by_facility</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">fac_type</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="64d9e160-bf4f-4bd7-9905-9d1f47cf9985">
        <script>(()=>{var e=document.getElementById("64d9e160-bf4f-4bd7-9905-9d1f47cf9985"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:[],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},arguments:{}},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]},{type:"turtle",name:"top_5_counties",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"],drillView:"top_5_counties"},{type:"fieldref",path:["airport_count"],drillView:"top_5_counties"},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)",drillView:"major_facilities"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{},fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],drillView:"top_5_counties"},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],drillView:"top_5_counties"}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["airport_count"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["county"]},{path:["airport_count"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}]}],filterList:[{node:"filterCondition",code:"state ? 'CA' | 'NY' | 'MN'",e:{node:"in",not:!1,kids:{e:{node:"field",path:["state"]},oneOf:[{node:"stringLiteral",literal:"CA"},{node:"stringLiteral",literal:"NY"},{node:"stringLiteral",literal:"MN"}]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["county"]},{path:["airport_count"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],modelAnnotation:{inherits:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],dependencies:{},annotation:{inherits:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"county",fieldUsage:[{path:["county"]}]},text:"county"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"major",fieldUsage:[{path:["major"]}]},text:"major"},{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"fieldReference",definition:{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},text:"full_name"},{type:"fieldReference",definition:{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},text:"fac_type"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"}],imports:[]},a.queryResult={lastStageName:"__stage2",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    base."state" as "state__0",\n    CASE WHEN group_set=0 THEN\n      COUNT(1)\n      END as "airport_count__0",\n    CASE WHEN group_set IN (1,2,3) THEN\n      base."county"\n      END as "county__1",\n    CASE WHEN group_set=1 THEN\n      COUNT(1)\n      END as "airport_count__1",\n    CASE WHEN group_set=2 THEN\n      CONCAT(base."code",\' - \',base."full_name")\n      END as "name__2",\n    CASE WHEN group_set=3 THEN\n      base."fac_type"\n      END as "fac_type__3",\n    CASE WHEN group_set=3 THEN\n      COUNT(1)\n      END as "airport_count__3"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,3,1)) as group_set  ) as group_set\n  WHERE (base."state" IN (\'CA\',\'NY\',\'MN\'))\n  AND ((group_set NOT IN (2) OR (group_set IN (2) AND base."major"=\'Y\')))\n  GROUP BY 1,2,4,6,7\n)\n, __stage1 AS (\n  SELECT \n    CASE WHEN group_set=2 THEN 1 WHEN group_set=3 THEN 1 ELSE group_set END as group_set,\n    "state__0" as "state__0",\n    FIRST("airport_count__0") FILTER (WHERE "airport_count__0" IS NOT NULL) as "airport_count__0",\n    CASE WHEN group_set IN (1,2,3) THEN\n      "county__1"\n      END as "county__1",\n    FIRST("airport_count__1") FILTER (WHERE "airport_count__1" IS NOT NULL) as "airport_count__1",\n    COALESCE(LIST({\n      "name": "name__2"}  ORDER BY  "name__2" asc NULLS LAST) FILTER (WHERE group_set=2),[]) as "major_facilities__1",\n    COALESCE(LIST({\n      "fac_type": "fac_type__3", \n      "airport_count": "airport_count__3"}  ORDER BY  "airport_count__3" desc NULLS LAST) FILTER (WHERE group_set=3),[]) as "by_facility__1"\n  FROM __stage0\n  GROUP BY 1,2,4\n)\nSELECT\n  "state__0" as "state",\n  MAX(CASE WHEN group_set=0 THEN "airport_count__0" END) as "airport_count",\n  COALESCE(LIST({\n    "county": "county__1", \n    "airport_count": "airport_count__1", \n    "major_facilities": "major_facilities__1", \n    "by_facility": "by_facility__1"}  ORDER BY  "airport_count__1" desc NULLS LAST) FILTER (WHERE group_set=1)[1:5],[]) as "top_5_counties"\nFROM __stage1\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage2",fields:[{name:"state",type:"string",resultMetadata:{sourceField:"state",sourceClasses:["state"],referenceId:"3bbcb5e0-49ea-4588-892e-05ba9a645f68",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"22ea9872-29fb-44d6-a4d2-4d80b4b3c4cf",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}}},{type:"array",name:"top_5_counties",fields:[{name:"county",type:"string",resultMetadata:{sourceField:"county",sourceClasses:["county"],referenceId:"47c31c37-0238-41a4-b55b-a96bb7cd97b4",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"top_5_counties"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"22ea9872-29fb-44d6-a4d2-4d80b4b3c4cf",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"top_5_counties"},{type:"array",name:"major_facilities",fields:[{name:"name",type:"string",resultMetadata:{sourceField:"name",sourceExpression:"concat(code, ' - ', full_name)",sourceClasses:["name"],referenceId:"bf7707cb-5060-495a-ae01-1f6310bd0fc6",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:10,character:16},end:{line:10,character:54}}},drillView:"major_facilities"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"major_facilities",filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:9,character:13},end:{line:9,character:18}}},sql:'base."major"'},right:{node:"stringLiteral",literal:"Y",sql:"'Y'"}}},expressionType:"scalar",fieldUsage:[{path:["major"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:9,character:13},end:{line:9,character:18}}}}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],sourceClasses:["major_facilities"],fieldKind:"struct",orderBy:[{field:"name",dir:"asc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many",drillView:"top_5_counties"},{type:"array",name:"by_facility",fields:[{name:"fac_type",type:"string",resultMetadata:{sourceField:"fac_type",sourceClasses:["fac_type"],referenceId:"54939672-ef38-4f23-99ab-3f5122057226",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"by_facility"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"22ea9872-29fb-44d6-a4d2-4d80b4b3c4cf",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"by_facility"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"by_facility",filterList:[],sourceClasses:["by_facility"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many",drillView:"top_5_counties"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"top_5_counties",filterList:[],sourceClasses:["top_5_counties"],fieldKind:"struct",limit:5,orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{},elementTypeDef:{type:"record_element"},join:"many"}],dialect:"duckdb",primaryKey:"state",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[{node:"filterCondition",code:"state ? 'CA' | 'NY' | 'MN'",e:{node:"in",not:!1,kids:{e:{node:"field",path:["state"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:1,character:9},end:{line:1,character:14}}},sql:'base."state"'},oneOf:[{node:"stringLiteral",literal:"CA",sql:"'CA'"},{node:"stringLiteral",literal:"NY",sql:"'NY'"},{node:"stringLiteral",literal:"MN",sql:"'MN'"}]}},expressionType:"scalar",fieldUsage:[{path:["state"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:1,character:9},end:{line:1,character:14}}}}]}],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],sourceExplore:"airports",sourceArguments:{},connectionName:"duckdb",result:[{state:"CA",airport_count:984,top_5_counties:[{county:"LOS ANGELES",airport_count:176,major_facilities:[{name:"BUR - BURBANK-GLENDALE-PASADENA"},{name:"LAX - LOS ANGELES INTL"},{name:"LGB - LONG BEACH /DAUGHERTY FIELD/"}],by_facility:[{fac_type:"HELIPORT",airport_count:151},{fac_type:"AIRPORT",airport_count:23},{fac_type:"SEAPLANE BASE",airport_count:2}]},{county:"SAN BERNARDINO",airport_count:71,major_facilities:[{name:"ONT - ONTARIO INTL"}],by_facility:[{fac_type:"AIRPORT",airport_count:47},{fac_type:"HELIPORT",airport_count:24}]},{county:"ORANGE",airport_count:53,major_facilities:[{name:"SNA - JOHN WAYNE AIRPORT-ORANGE COUNTY"}],by_facility:[{fac_type:"HELIPORT",airport_count:47},{fac_type:"AIRPORT",airport_count:6}]},{county:"SAN DIEGO",airport_count:49,major_facilities:[{name:"SAN - SAN DIEGO INTL-LINDBERGH FLD"}],by_facility:[{fac_type:"AIRPORT",airport_count:30},{fac_type:"HELIPORT",airport_count:17},{fac_type:"GLIDERPORT",airport_count:2}]},{county:"KERN",airport_count:49,major_facilities:[{name:"BFL - MEADOWS FIELD"},{name:"IYK - INYOKERN"}],by_facility:[{fac_type:"AIRPORT",airport_count:41},{fac_type:"HELIPORT",airport_count:7},{fac_type:"ULTRALIGHT",airport_count:1}]}]},{state:"NY",airport_count:576,top_5_counties:[{county:"SUFFOLK",airport_count:34,major_facilities:[{name:"ISP - LONG ISLAND MAC ARTHUR"}],by_facility:[{fac_type:"HELIPORT",airport_count:18},{fac_type:"AIRPORT",airport_count:15},{fac_type:"SEAPLANE BASE",airport_count:1}]},{county:"ERIE",airport_count:26,major_facilities:[{name:"BUF - BUFFALO NIAGARA INTL"}],by_facility:[{fac_type:"AIRPORT",airport_count:18},{fac_type:"HELIPORT",airport_count:8}]},{county:"DUTCHESS",airport_count:20,major_facilities:[],by_facility:[{fac_type:"HELIPORT",airport_count:12},{fac_type:"AIRPORT",airport_count:8}]},{county:"NIAGARA",airport_count:20,major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:15},{fac_type:"HELIPORT",airport_count:5}]},{county:"ONEIDA",airport_count:18,major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:13},{fac_type:"HELIPORT",airport_count:5}]}]},{state:"MN",airport_count:507,top_5_counties:[{county:"ST LOUIS",airport_count:28,major_facilities:[{name:"DLH - DULUTH INTL"}],by_facility:[{fac_type:"AIRPORT",airport_count:13},{fac_type:"SEAPLANE BASE",airport_count:10},{fac_type:"HELIPORT",airport_count:5}]},{county:"HENNEPIN",airport_count:23,major_facilities:[{name:"MSP - MINNEAPOLIS-ST PAUL INTL/WOLD-CHAMBERLAIN/"}],by_facility:[{fac_type:"HELIPORT",airport_count:9},{fac_type:"SEAPLANE BASE",airport_count:8},{fac_type:"AIRPORT",airport_count:6}]},{county:"DAKOTA",airport_count:17,major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:14},{fac_type:"SEAPLANE BASE",airport_count:3}]},{county:"CROW WING",airport_count:17,major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:8},{fac_type:"SEAPLANE BASE",airport_count:6},{fac_type:"ULTRALIGHT",airport_count:1},{fac_type:"HELIPORT",airport_count:1},{fac_type:"STOLPORT",airport_count:1}]},{county:"ANOKA",airport_count:14,major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:9},{fac_type:"SEAPLANE BASE",airport_count:3},{fac_type:"HELIPORT",airport_count:2}]}]}],totalRows:3},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">984</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LOS ANGELES&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">176</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BUR - BURBANK-GLENDALE-PASADENA&quot;</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LAX - LOS ANGELES INTL&quot;</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LGB - LONG BEACH /DAUGHERTY FIELD/&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">151</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SAN BERNARDINO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">71</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ONT - ONTARIO INTL&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ORANGE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">53</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SNA - JOHN WAYNE AIRPORT-ORANGE COUNTY&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SAN DIEGO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SAN - SAN DIEGO INTL-LINDBERGH FLD&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;GLIDERPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;KERN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BFL - MEADOWS FIELD&quot;</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;IYK - INYOKERN&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">41</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NY&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">576</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SUFFOLK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">34</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ISP - LONG ISLAND MAC ARTHUR&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ERIE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BUF - BUFFALO NIAGARA INTL&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DUTCHESS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NIAGARA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ONEIDA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">507</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_5_counties&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ST LOUIS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">28</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DLH - DULUTH INTL&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HENNEPIN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MSP - MINNEAPOLIS-ST PAUL INTL/WOLD-CHAMBERLAIN/&quot;</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DAKOTA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CROW WING&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ULTRALIGHT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STOLPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ANOKA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">          },</span></span>
<span class="line"><span style="color: #000000">          {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">          }</span></span>
<span class="line"><span style="color: #000000">        ]</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">3</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;county&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">CONCAT</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">,</span><span style="color: #A31515">&#39; - &#39;</span><span style="color: #000000">,base.</span><span style="color: #A31515">&quot;full_name&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;name__2&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">3</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;fac_type&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;fac_type__3&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">3</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__3&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">3</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #A31515">&#39;CA&#39;</span><span style="color: #000000">,</span><span style="color: #A31515">&#39;NY&#39;</span><span style="color: #000000">,</span><span style="color: #A31515">&#39;MN&#39;</span><span style="color: #000000">))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">AND</span><span style="color: #000000"> ((group_set </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">OR</span><span style="color: #000000"> (group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">AND</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;major&quot;</span><span style="color: #000000">=</span><span style="color: #A31515">&#39;Y&#39;</span><span style="color: #000000">)))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span><span style="color: #000000">,</span><span style="color: #098658">6</span><span style="color: #000000">,</span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">, __stage1 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">3</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">3</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;county__1&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;name__2&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;name__2&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">asc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;major_facilities__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;fac_type__3&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__3&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__3&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">3</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;by_facility__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;county__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;major_facilities&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;major_facilities__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;by_facility&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;by_facility__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">)[1:5],[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;top_5_counties&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage1</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="nesting-named-views" class="header-link anchor" href="#nesting-named-views">
          Nesting Named Views
        </a>
      </h2>
    <p>Any views defined in a source can be used by name in a <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">nest</span><span style="color: #000000">:</span></span></code> clause or a query.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/language/nesting.malloynb#C9" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">airports_with_views</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">airports</span><span style="color: #000000"> </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">by_facility</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">fac_type</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">major_facilities</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">major</span><span style="color: #000000"> = </span><span style="color: #A31515">&#39;Y&#39;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">name</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">concat</span><span style="color: #000000">(</span><span style="color: #001080">code</span><span style="color: #000000">, </span><span style="color: #A31515">&#39; - &#39;</span><span style="color: #000000">, </span><span style="color: #001080">full_name</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">top_5_counties</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">county</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">major_facilities</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">by_facility</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports_with_views</span><span style="color: #000000"> -&gt; </span><span style="color: #001080">top_5_counties</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="afb84302-ff3a-4810-9717-fbf702012e44">
        <script>(()=>{var e=document.getElementById("afb84302-ff3a-4810-9717-fbf702012e44"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:["airports_with_views"],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}},airports_with_views:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"top_5_counties",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"]},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)",drillView:"major_facilities"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:15,character:6},end:{line:15,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}]},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:16,character:6},end:{line:16,character:17}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}]}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"county",dir:"asc"}]}],annotation:{}}],primaryKey:"code",parameters:{},as:"airports_with_views",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},arguments:{}}},queryList:[{type:"query",structRef:"airports_with_views",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"],drillView:"top_5_counties"},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)",drillView:"major_facilities"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:15,character:6},end:{line:15,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],drillView:"top_5_counties"},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:16,character:6},end:{line:16,character:17}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],drillView:"top_5_counties"}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"county",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:20,character:28},end:{line:20,character:42}}}}],name:"top_5_counties",annotation:{inherits:{}},modelAnnotation:{inherits:{inherits:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],dependencies:{},annotation:{inherits:{inherits:{inherits:{inherits:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}}],primaryKey:"code",parameters:{},as:"airports",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}},{type:"fieldReference",definition:{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},text:"fac_type"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"string",name:"major",fieldUsage:[{path:["major"]}]},text:"major"},{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"fieldReference",definition:{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},text:"full_name"},{type:"fieldReference",definition:{type:"string",name:"county",fieldUsage:[{path:["county"]}]},text:"county"},{type:"fieldReference",definition:{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},text:"major_facilities"},{type:"fieldReference",definition:{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},text:"by_facility"},{type:"exploreReference",text:"airports_with_views",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"},{type:"string",name:"faa_region_name",e:{node:"case",kids:{caseWhen:[{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASW"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANM"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AEA"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ASO"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AGL"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ACE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"ANE"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AWP"}}},{node:"=",kids:{left:{node:"field",path:["faa_region"]},right:{node:"stringLiteral",literal:"AAL"}}}],caseThen:[{node:"stringLiteral",literal:"Southwest"},{node:"stringLiteral",literal:"Northwest Mountain"},{node:"stringLiteral",literal:"Eastern"},{node:"stringLiteral",literal:"Southern"},{node:"stringLiteral",literal:"Great Lakes"},{node:"stringLiteral",literal:"Central"},{node:"stringLiteral",literal:"New England"},{node:"stringLiteral",literal:"Western Pacific"},{node:"stringLiteral",literal:"Alaska"}],caseElse:{node:"field",path:["faa_region"]}}},fieldUsage:[{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]},{path:["faa_region"]}],expressionType:"scalar",code:"faa_region ?\n    pick 'Southwest' when 'ASW'\n    pick 'Northwest Mountain' when 'ANM'\n    pick 'Eastern' when 'AEA'\n    pick 'Southern' when 'ASO'\n    pick 'Great Lakes' when 'AGL'\n    pick 'Central' when 'ACE'\n    pick 'New England' when 'ANE'\n    pick 'Western Pacific' when 'AWP'\n    pick 'Alaska' when 'AAL'"},{type:"turtle",name:"by_region",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"]},{type:"fieldref",path:["faa_region_name"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"]},{type:"fieldref",path:["airport_count"]}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}]}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"airports_by_region_dashboard",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["faa_region"],drillView:"by_region"},{type:"fieldref",path:["faa_region_name"],drillView:"by_region"},{type:"fieldref",path:["airport_count"],drillView:"by_region"},{type:"turtle",name:"by_state",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["state"],drillView:"by_state"},{type:"fieldref",path:["airport_count"],drillView:"by_state"}],filterList:[{node:"filterCondition",code:"state is not null",e:{node:"is-not-null",e:{node:"field",path:["state"]}},expressionType:"scalar",fieldUsage:[{path:["state"]}],drillView:"by_state"}],fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:47,character:6},end:{line:47,character:14}}}}],annotation:{notes:[{text:"# shape_map\n"}],inherits:{}},fieldUsage:[{path:["state"]},{path:["state"]},{path:["airport_count"]}]},{type:"turtle",name:"by_facility_type",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility_type"},{type:"fieldref",path:["airport_count"],drillView:"by_facility_type"},{type:"number",numberType:"integer",name:"avg_elevation",e:{node:"aggregate",function:"avg",e:{node:"field",path:["elevation"]}},fieldUsage:[{path:["elevation"]}],expressionType:"aggregate",code:"elevation.avg()",drillView:"by_facility_type"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:48,character:6},end:{line:48,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]}]},{type:"turtle",name:"major_airports",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["state"]},{node:"stringLiteral",literal:"-"},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["state"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(state, '-', full_name)",drillView:"major_airports"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_airports"}],fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:49,character:6},end:{line:49,character:20}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["state"]},{path:["full_name"]}]}],filterList:[{node:"filterCondition",code:"faa_region is not null",e:{node:"is-not-null",e:{node:"field",path:["faa_region"]}},expressionType:"scalar",fieldUsage:[{path:["faa_region"]}]}],fieldUsage:[{path:["faa_region"]},{path:["faa_region_name"]},{path:["airport_count"]},{path:["faa_region"]},{path:["state"]},{path:["state"]},{path:["airport_count"]},{path:["fac_type"]},{path:["airport_count"]},{path:["elevation"]},{path:["major"]},{path:["state"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{inherits:{}}},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"]},{type:"fieldref",path:["airport_count"]}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{}},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}}}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}]}],annotation:{}},{type:"turtle",name:"top_5_counties",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"]},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)",drillView:"major_facilities"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:15,character:6},end:{line:15,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}]},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:16,character:6},end:{line:16,character:17}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}]}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"county",dir:"asc"}]}],annotation:{}}],primaryKey:"code",parameters:{},as:"airports_with_views",modelAnnotation:{notes:[{text:"##(docs) hidden\n"}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},arguments:{}}},{type:"fieldReference",definition:{type:"turtle",name:"top_5_counties",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["county"]},{type:"turtle",name:"major_facilities",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"name",e:{node:"function_call",overload:{returnType:{type:"string",expressionType:"scalar",evalSpace:"input"},params:[{name:"values",allowedTypes:[{type:"string",evalSpace:"input"},{type:"number",evalSpace:"input"},{type:"date",evalSpace:"input"},{type:"timestamp",evalSpace:"input"},{type:"boolean",evalSpace:"input"}],isVariadic:!0}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"CAST(",suffix:"AS VARCHAR)"}]},src:["CONCAT(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"spread",e:{node:"function_parameter",name:"values"},prefix:"",suffix:""}]},src:["CONCAT(",")"]}}}},name:"concat",kids:{args:[{node:"field",path:["code"]},{node:"stringLiteral",literal:" - "},{node:"field",path:["full_name"]}]},expressionType:"scalar"},fieldUsage:[{path:["code"]},{path:["full_name"]}],expressionType:"scalar",code:"concat(code, ' - ', full_name)",drillView:"major_facilities"}],filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"]},right:{node:"stringLiteral",literal:"Y"}}},expressionType:"scalar",fieldUsage:[{path:["major"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}],defaultOrderBy:!0,orderBy:[{field:"name",dir:"asc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:15,character:6},end:{line:15,character:22}}}}],annotation:{inherits:{}},fieldUsage:[{path:["major"]},{path:["code"]},{path:["full_name"]}]},{type:"turtle",name:"by_facility",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["fac_type"],drillView:"by_facility"},{type:"fieldref",path:["airport_count"],drillView:"by_facility"}],filterList:[],fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:16,character:6},end:{line:16,character:17}}}}],annotation:{inherits:{}},fieldUsage:[{path:["fac_type"]},{path:["airport_count"]}]}],limit:5,filterList:[],fieldUsage:[{path:["county"]},{path:["major"]},{path:["code"]},{path:["full_name"]},{path:["fac_type"]},{path:["airport_count"]}],defaultOrderBy:!0,orderBy:[{field:"county",dir:"asc"}]}],annotation:{}},text:"top_5_counties"}],imports:[]},a.queryResult={lastStageName:"__stage1",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    base."county" as "county__0",\n    CASE WHEN group_set=1 THEN\n      CONCAT(base."code",\' - \',base."full_name")\n      END as "name__1",\n    CASE WHEN group_set=2 THEN\n      base."fac_type"\n      END as "fac_type__2",\n    CASE WHEN group_set=2 THEN\n      COUNT(1)\n      END as "airport_count__2"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,2,1)) as group_set  ) as group_set\n  WHERE (group_set NOT IN (1) OR (group_set IN (1) AND base."major"=\'Y\'))\n  GROUP BY 1,2,3,4\n)\nSELECT\n  "county__0" as "county",\n  COALESCE(LIST({\n    "name": "name__1"}  ORDER BY  "name__1" asc NULLS LAST) FILTER (WHERE group_set=1),[]) as "major_facilities",\n  COALESCE(LIST({\n    "fac_type": "fac_type__2", \n    "airport_count": "airport_count__2"}  ORDER BY  "airport_count__2" desc NULLS LAST) FILTER (WHERE group_set=2),[]) as "by_facility"\nFROM __stage0\nGROUP BY 1\nORDER BY 1 asc NULLS LAST\nLIMIT 5\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage1",fields:[{name:"county",type:"string",resultMetadata:{sourceField:"county",sourceClasses:["county"],referenceId:"af8e6689-486a-4ec8-b08b-253c5e594bbf",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"top_5_counties"},{type:"array",name:"major_facilities",fields:[{name:"name",type:"string",resultMetadata:{sourceField:"name",sourceExpression:"concat(code, ' - ', full_name)",sourceClasses:["name"],referenceId:"5b3b6233-9688-4dc2-b844-ff06aa408824",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:8,character:14},end:{line:8,character:52}}},drillView:"major_facilities"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"major_facilities",filterList:[{node:"filterCondition",code:"major = 'Y'",e:{node:"=",kids:{left:{node:"field",path:["major"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:7,character:11},end:{line:7,character:16}}},sql:'base."major"'},right:{node:"stringLiteral",literal:"Y",sql:"'Y'"}}},expressionType:"scalar",fieldUsage:[{path:["major"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:7,character:11},end:{line:7,character:16}}}}],stableFilter:{kind:"literal_equality",field_reference:{name:"major",path:[]},value:{kind:"string_literal",string_value:"Y"}},drillView:"major_facilities"}],sourceClasses:["major_facilities"],fieldKind:"struct",orderBy:[{field:"name",dir:"asc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{inherits:{}},elementTypeDef:{type:"record_element"},join:"many",drillView:"top_5_counties"},{type:"array",name:"by_facility",fields:[{name:"fac_type",type:"string",resultMetadata:{sourceField:"fac_type",sourceClasses:["fac_type"],referenceId:"34487e6e-2f82-47b8-9a96-89c51a6e7b26",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:2,character:20},end:{line:2,character:60}}},drillView:"by_facility"},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"f3b1f92e-cf18-4ec8-a34a-e237c28334c4",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/airports.malloy",range:{start:{line:5,character:11},end:{line:5,character:35}}},drillView:"by_facility"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"by_facility",filterList:[],sourceClasses:["by_facility"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"},annotation:{inherits:{}},elementTypeDef:{type:"record_element"},join:"many",drillView:"top_5_counties"}],dialect:"duckdb",primaryKey:"county",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:5,orderBy:[{field:"county",dir:"asc"}],drillable:!0},modelAnnotation:{notes:[{text:"##(docs) hidden\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/language/nesting.malloynb",range:{start:{line:0,character:0},end:{line:0,character:16}}}}],id:"b37a9344-df08-57ac-94cc-ab87097f2cf4"}}],sourceExplore:"airports_with_views",sourceArguments:{},queryName:"top_5_counties",connectionName:"duckdb",annotation:{inherits:{}},result:[{county:"--PUERTO RICO",major_facilities:[{name:"BQN - RAFAEL HERNANDEZ"},{name:"SJU - LUIS MUNOZ MARIN INTL"}],by_facility:[{fac_type:"HELIPORT",airport_count:20},{fac_type:"AIRPORT",airport_count:19},{fac_type:"SEAPLANE BASE",airport_count:1}]},{county:"-TRUST TERR. OF PAC-",major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:1}]},{county:"-VIRGIN ISLANDS-",major_facilities:[{name:"STT - CYRIL E KING"},{name:"STX - HENRY E ROHLSEN"}],by_facility:[{fac_type:"HELIPORT",airport_count:4},{fac_type:"SEAPLANE BASE",airport_count:3},{fac_type:"AIRPORT",airport_count:2}]},{county:"ABBEVILLE",major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:3},{fac_type:"HELIPORT",airport_count:1}]},{county:"ACADIA",major_facilities:[],by_facility:[{fac_type:"AIRPORT",airport_count:9},{fac_type:"HELIPORT",airport_count:3}]}],totalRows:5},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;--PUERTO RICO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BQN - RAFAEL HERNANDEZ&quot;</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SJU - LUIS MUNOZ MARIN INTL&quot;</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ],</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">19</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;-TRUST TERR. OF PAC-&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;-VIRGIN ISLANDS-&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STT - CYRIL E KING&quot;</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;STX - HENRY E ROHLSEN&quot;</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ],</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;SEAPLANE BASE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABBEVILLE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;county&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ACADIA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;major_facilities&quot;</span><span style="color: #000000">: [],</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_facility&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AIRPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HELIPORT&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    base.</span><span style="color: #A31515">&quot;county&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">CONCAT</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">,</span><span style="color: #A31515">&#39; - &#39;</span><span style="color: #000000">,base.</span><span style="color: #A31515">&quot;full_name&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;name__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;fac_type&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;fac_type__2&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__2&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> (group_set </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OR</span><span style="color: #000000"> (group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">AND</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;major&quot;</span><span style="color: #000000">=</span><span style="color: #A31515">&#39;Y&#39;</span><span style="color: #000000">))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">3</span><span style="color: #000000">,</span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&quot;county__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;county&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;name__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;name__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">asc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;major_facilities&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;fac_type&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;fac_type__2&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;airport_count__2&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;airport_count__2&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;by_facility&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">asc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">5</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div></div></div>
        </div>
        <script src="/js/view_toggles.js"></script>
        <script src="/js/jump_to_hash.js"></script>
      </div>
    </div>
    <div id="banner_wrapper">
      <div id="banner">
        <div>
          This site uses cookies from Google to deliver its services and to analyze
          traffic.
          <a
            href="https://policies.google.com/technologies/cookies"
            target="_blank"
          >
            Learn more
          </a>
        </div>
        <button id="banner_button">I Understand</button>
      </div>
    </div>
    <script src="/js/banner.js"></script>
    <script src="/js/generated/malloy-render-0.0.282.js"></script>
  </body>
</html>
