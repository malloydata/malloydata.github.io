<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Comparing Timeframes | Malloy Documentation</title>
    <link rel="stylesheet" href="/css/document.css" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/img/favicon.ico"
    />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-0M10W7C20Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
    
      gtag("config", "G-0M10W7C20Y");
    </script>
    <style>
      malloy-render::part(table-container) {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="top">
      <div class="header">
        <div class="header-banner">
          <a href="http://www.malloydata.dev" target="_blank">
            <img
              class="logo"
              src="/img/logo.png"
              alt="malloy logo"
            />
          </a>

          Malloy
          <span class="subtitle">Documentation</span>
        </div>
        <div class="header-right">
          <div class="header-links">
            <a href="https://github.com/malloydata/malloy" target="_blank"
              ><img
                src="/img/github.svg"
                style="transform: scale(0.5)"
            /></a>
            <a href="/slack" target="_blank"
              ><img src="/img/slack.svg"
            /></a>
          </div>
          <form onSubmit="() => alert('submit')" action="/search">
            <div class="search-input-outer">
              <img src="/img/search.svg" alt="search" />
              <input placeholder="Search" id="search-input" name="query" />
            </div>
            <input type="submit" style="display: none" />
          </form>
        </div>
      </div>
      <div class="main">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
              <div id=about_malloy
                class="sidebar-section-title {% unless /documentation/index.html,/documentation/about/features.html,/documentation/about/tao.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                About Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation">
                <img src="/img/article_icon.svg" alt="document"/>
                What Is Malloy
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/features">
                <img src="/img/article_icon.svg" alt="document"/>
                Key Features
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/tao">
                <img src="/img/article_icon.svg" alt="document"/>
                The Tao of Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=setting_up malloy
                class="sidebar-section-title {% unless /documentation/setup/extension.html,/documentation/setup/connection_instructions.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Setting up Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/setup/extension">
                <img src="/img/article_icon.svg" alt="document"/>
                Installing the Malloy Extension
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/connection_instructions">
                <img src="/img/article_icon.svg" alt="document"/>
                Connecting a Database
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=user_guides
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/malloy_by_example.html,/documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                User Guides
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/querying_a_model">
                <img src="/img/article_icon.svg" alt="document"/>
                Querying a Semantic Model
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_by_example">
                <img src="/img/article_icon.svg" alt="document"/>
                Building Semantic Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts1">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for SQL Folks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts2">
                <img src="/img/article_icon.svg" alt="document"/>
                More Guidance for SQL Users
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=language_reference
                class="sidebar-section-title {% unless /documentation/language/statement.html,/documentation/language/source.html,/documentation/language/query.html,/documentation/language/views.html,/documentation/language/datatypes.html,/documentation/language/fields.html,/documentation/language/aggregates.html,/documentation/language/expressions.html,/documentation/language/functions.html,/documentation/language/filters.html,/documentation/language/calculations_windows.html,/documentation/language/order_by.html,/documentation/language/join.html,/documentation/language/nesting.html,/documentation/language/sql_sources.html,/documentation/language/imports.html,/documentation/language/connections.html,/documentation/language/tags.html,/documentation/language/quick_reference.html,/documentation/language/changelog.html,/documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Language Reference
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/statement">
                <img src="/img/article_icon.svg" alt="document"/>
                Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/source">
                <img src="/img/article_icon.svg" alt="document"/>
                Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/query">
                <img src="/img/article_icon.svg" alt="document"/>
                Queries
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/views">
                <img src="/img/article_icon.svg" alt="document"/>
                Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/datatypes">
                <img src="/img/article_icon.svg" alt="document"/>
                Data Types
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/fields">
                <img src="/img/article_icon.svg" alt="document"/>
                Fields
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/aggregates">
                <img src="/img/article_icon.svg" alt="document"/>
                Aggregates
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/functions">
                <img src="/img/article_icon.svg" alt="document"/>
                Functions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/filters">
                <img src="/img/article_icon.svg" alt="document"/>
                Filters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/calculations_windows">
                <img src="/img/article_icon.svg" alt="document"/>
                Calculations (window functions)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/order_by">
                <img src="/img/article_icon.svg" alt="document"/>
                Ordering and Limiting
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/join">
                <img src="/img/article_icon.svg" alt="document"/>
                Joins
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/nesting">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/sql_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/imports">
                <img src="/img/article_icon.svg" alt="document"/>
                Imports
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/tags">
                <img src="/img/article_icon.svg" alt="document"/>
                Tags
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/quick_reference.html">
                <img src="/img/article_icon.svg" alt="document"/>
                Quick Reference
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/changelog">
                <img src="/img/article_icon.svg" alt="document"/>
                Change Log
              </a>
            </div>
        <div class="sidebar-section">
              <div id=dialects
                class="sidebar-section-title {% unless /documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Dialects
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/dialect/bigquery">
                <img src="/img/article_icon.svg" alt="document"/>
                BigQuery
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/presto-trino">
                <img src="/img/article_icon.svg" alt="document"/>
                Presto / Trino
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/snowflake">
                <img src="/img/article_icon.svg" alt="document"/>
                Snowflake
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mysql">
                <img src="/img/article_icon.svg" alt="document"/>
                MySQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                DuckDB
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/postgres">
                <img src="/img/article_icon.svg" alt="document"/>
                PostgreSQL
              </a>
            </div>
              </div>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=common_patterns
                class="sidebar-section-title {% unless /documentation/patterns/yoy.html,/documentation/patterns/foreign_sums.html,/documentation/patterns/reading_nested.html,/documentation/patterns/percent_of_total.html,/documentation/patterns/cohorts.html,/documentation/patterns/nested_subtotals.html,/documentation/patterns/other.html,/documentation/patterns/autobin.html,/documentation/patterns/moving_avg.html,/documentation/patterns/transform.html,/documentation/patterns/sessionize.html,/documentation/patterns/dim_index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Common Patterns
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item active'>
              <a href="/documentation/patterns/yoy">
                <img src="/img/article_icon.svg" alt="document"/>
                Comparing Timeframes
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/foreign_sums">
                <img src="/img/article_icon.svg" alt="document"/>
                Foreign Sums and Averages
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/reading_nested">
                <img src="/img/article_icon.svg" alt="document"/>
                Reading Nested Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/percent_of_total">
                <img src="/img/article_icon.svg" alt="document"/>
                Percent of Total
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/cohorts">
                <img src="/img/article_icon.svg" alt="document"/>
                Cohort Analysis
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/nested_subtotals">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Subtotals
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/other">
                <img src="/img/article_icon.svg" alt="document"/>
                Bucketing with 'Other'
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/autobin">
                <img src="/img/article_icon.svg" alt="document"/>
                Auto-binning Histograms
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/moving_avg">
                <img src="/img/article_icon.svg" alt="document"/>
                Moving Average
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/sessionize">
                <img src="/img/article_icon.svg" alt="document"/>
                Sessionize - Map/Reduce
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/dim_index">
                <img src="/img/article_icon.svg" alt="document"/>
                Dimensional Indexes
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_results
                class="sidebar-section-title {% unless /documentation/visualizations/about_rendering.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Results
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/about_rendering">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_legacy docs
                class="sidebar-section-title {% unless /documentation/visualizations/overview.html,/documentation/visualizations/numbers.html,/documentation/visualizations/links.html,/documentation/visualizations/pivots.html,/documentation/visualizations/transpose.html,/documentation/visualizations/dashboards.html,/documentation/visualizations/lists.html,/documentation/visualizations/bar_charts.html,/documentation/visualizations/charts_line_chart.html,/documentation/visualizations/scatter_charts.html,/documentation/visualizations/shape_maps.html,/documentation/visualizations/segment_maps.html,/documentation/visualizations/legacy_renderer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Legacy Docs
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/overview">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/numbers">
                <img src="/img/article_icon.svg" alt="document"/>
                Numbers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/links">
                <img src="/img/article_icon.svg" alt="document"/>
                Links
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/pivots">
                <img src="/img/article_icon.svg" alt="document"/>
                Pivoted Tables
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/transpose">
                <img src="/img/article_icon.svg" alt="document"/>
                Table Transpose
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/dashboards">
                <img src="/img/article_icon.svg" alt="document"/>
                Dashboards
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/lists">
                <img src="/img/article_icon.svg" alt="document"/>
                Lists
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/bar_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Bar Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/charts_line_chart">
                <img src="/img/article_icon.svg" alt="document"/>
                Line Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/scatter_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Scatter Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/shape_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Shape Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/segment_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Segment Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/legacy_renderer">
                <img src="/img/article_icon.svg" alt="document"/>
                Legacy Renderer
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloysql
                class="sidebar-section-title {% unless /documentation/malloy_sql/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                MalloySQL
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_sql/index">
                <img src="/img/article_icon.svg" alt="document"/>
                Using MalloySQL
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_cli
                class="sidebar-section-title {% unless /documentation/malloy_cli/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy CLI
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_cli/index">
                <img src="/img/article_icon.svg" alt="document"/>
                The Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_with python
                class="sidebar-section-title {% unless /documentation/malloy_python/python_package.html,/documentation/malloy_python/jupyter.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy with Python
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_python/python_package">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy Python Package
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/malloy_python/jupyter">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy in Jupyter Notebooks
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=experiments_(in process features)
                class="sidebar-section-title {% unless /documentation/experiments/experiments.html,/documentation/experiments/joins.html,/documentation/experiments/sql_expressions.html,/documentation/experiments/window.html,/documentation/experiments/parameters.html,/documentation/experiments/composite_sources.html,/documentation/experiments/include.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Experiments (in process features)
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/experiments/experiments">
                <img src="/img/article_icon.svg" alt="document"/>
                Experiments
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/joins">
                <img src="/img/article_icon.svg" alt="document"/>
                Join INNER/RIGHT/FULL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/sql_expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/window">
                <img src="/img/article_icon.svg" alt="document"/>
                Window Partitions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/parameters">
                <img src="/img/article_icon.svg" alt="document"/>
                Parameters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/composite_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                Composite "Cube" Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/include">
                <img src="/img/article_icon.svg" alt="document"/>
                Access Modifiers
              </a>
            </div>
              </div>
            </div>
          </div>        <script src="/js/sidebar_state.js"></script>
        <div class="content">
          <div class="footer">
            
<div class="linear-navigation">
  <div class="item">
      <a href="../language/dialect/postgres.html"><img src="/img/previous.svg" alt="previous"/>PostgreSQL</a>
  </div>
  <div class="item">
      <a href="foreign_sums.html">Foreign Sums and Averages<img src="/img/next.svg" alt="next"/></a>
  </div>
</div> 
          </div>
          <div class="document-outer"><div class="document"><div class="title-row">
        
      <h1>
        <a id="measuring-change-over-time-by-comparing-timeframes" class="header-link anchor" href="#measuring-change-over-time-by-comparing-timeframes">
          Measuring Change over Time by Comparing Timeframes
        </a>
      </h1>
    
        <a class="edit-link" target="_blank" href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C1">VSCode <img src="/img/open_notebook.svg" alt="document"/></a>
        </div>
      <p>There are a couple of different ways to go about this in Malloy.</p>

      <h2>
        <a id="method-1-pivoting-a-visualization" class="header-link anchor" href="#method-1-pivoting-a-visualization">
          Method 1: Pivoting a Visualization
        </a>
      </h2>
    <p>We can compare performance of different years using the same x and y-axes.  Line charts take the x-axis, y-axis and dimensional (color) axis as parameters.
In this case, the x-axis is <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">month_of_year</span></span></code>, the y-axis is <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">flight_count</span></span></code> and the dimensional (color) axis is the year.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C2" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre></div><div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C3" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">month_of_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">month</span><span style="color: #000000">(</span><span style="color: #001080">dep_time</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="01605a24-97c6-49ab-a7c6-1fb0498503a9">
        <script>(()=>{var e=document.getElementById("01605a24-97c6-49ab-a7c6-1fb0498503a9"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},queryList:[{type:"query",structRef:"flights",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"number",numberType:"integer",name:"month_of_year",e:{node:"extract",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"month(dep_time)"},{type:"fieldref",path:["flight_count"]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"}],filterList:[],fieldUsage:[{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}],annotation:{notes:[],blockNotes:[{text:"#(docs) size=small limit=5000\n"}]}}],dependencies:{},references:[{type:"exploreReference",text:"flights",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   EXTRACT(month FROM base."dep_time") as "month_of_year",\n   COUNT(1) as "flight_count",\n   DATE_TRUNC(\'year\', base."dep_time") as "flight_year"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1,3\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"month_of_year",numberType:"integer",type:"number",resultMetadata:{sourceField:"month_of_year",sourceExpression:"month(dep_time)",sourceClasses:["month_of_year"],referenceId:"776367ac-15ee-4e2e-ad8f-3efe3e257ad4",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:2,character:12},end:{line:2,character:44}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"e214dd80-5c8b-41e9-b103-37900fb216b7",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:1,character:11},end:{line:1,character:34}}}},{name:"flight_year",type:"timestamp",timeframe:"year",resultMetadata:{sourceField:"flight_year",sourceExpression:"dep_time.year",sourceClasses:["flight_year"],referenceId:"f7e96ef8-fe3c-4506-8c4f-faba11d4f5df",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:4,character:12},end:{line:4,character:40}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights",sourceArguments:{},connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) size=small limit=5000\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:0},end:{line:0,character:30}}}}]},result:[{month_of_year:8,flight_count:6415,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:6228,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:6227,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:6202,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:6118,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:6100,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:6084,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:6083,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:6064,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:6043,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:5997,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:8,flight_count:5993,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:5775,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:5770,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:5732,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:5707,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:5689,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:5622,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:5609,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:5533,flight_year:"2005-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:5463,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:5385,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:5223,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:5134,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:5124,flight_year:"2004-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:5117,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:5114,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:5017,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:5005,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:8,flight_count:4918,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:4892,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:4873,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:4729,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:4726,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:4720,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:8,flight_count:4607,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:4451,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:4440,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:4431,flight_year:"2003-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:4407,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:4375,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:4348,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:4346,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:4340,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:4328,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:8,flight_count:4326,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:4261,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:4252,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:8,flight_count:4182,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:4102,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:4086,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:4071,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:5,flight_count:4047,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:4046,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:7,flight_count:4043,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:4020,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:1,flight_count:4008,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:3999,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:3914,flight_year:"2002-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:3876,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:3,flight_count:3869,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:3858,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:3850,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:3819,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:10,flight_count:3809,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:4,flight_count:3778,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:6,flight_count:3774,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:12,flight_count:3744,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:11,flight_count:3718,flight_year:"2000-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:3672,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:9,flight_count:3616,flight_year:"2001-01-01T00:00:00.000Z"},{month_of_year:2,flight_count:3583,flight_year:"2002-01-01T00:00:00.000Z"}],totalRows:72},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6415</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6228</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6227</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6202</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6118</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6100</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6084</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6083</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6064</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6043</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5997</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5993</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5775</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5770</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5732</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5707</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5689</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5622</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5609</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5533</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5463</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5385</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5223</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5134</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5124</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5117</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5114</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5017</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5005</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4918</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4892</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4873</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4729</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4726</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4720</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4607</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4451</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4440</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4431</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4407</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4375</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4348</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4346</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4340</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4328</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4326</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4261</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4252</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4182</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4102</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4086</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4071</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4047</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4046</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4043</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4020</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4008</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3914</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3876</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3869</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3858</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3850</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3819</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3809</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3778</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3774</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3744</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3718</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3672</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3616</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3583</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   EXTRACT(</span><span style="color: #795E26">month</span><span style="color: #000000"> </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;month_of_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_year&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>By adding year as the third column, we can display different years on the same chart. Note the <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #0451A5"># line_chart</span></span></code> tag above the query. This is a hint to the renderer to display the data as a line chart. Changing the definition of <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">flight_year</span></span></code> to <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">year</span><span style="color: #000000">(</span><span style="color: #001080">dep_time</span><span style="color: #000000">)::</span><span style="color: #267F99">string</span></span></code> makes the line chart interpret the year as "categorical," giving distinct colors for each year rather than a gradient.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C5" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #0451A5"># line_chart</span></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">month_of_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">month</span><span style="color: #000000">(</span><span style="color: #001080">dep_time</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">(</span><span style="color: #001080">dep_time</span><span style="color: #000000">)::</span><span style="color: #267F99">string</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="e1f09e61-39c9-4df8-a552-2b09a1eacaab">
        <script>(()=>{var e=document.getElementById("e1f09e61-39c9-4df8-a552-2b09a1eacaab"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},queryList:[{type:"query",structRef:"flights",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"number",numberType:"integer",name:"month_of_year",e:{node:"extract",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"month(dep_time)"},{type:"fieldref",path:["flight_count"]},{type:"string",name:"flight_year",e:{node:"cast",dstType:{type:"string"},e:{node:"extract",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},safe:!1,srcType:{type:"number"}},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"year(dep_time)::string"}],filterList:[],fieldUsage:[{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}],annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n"},{text:"# line_chart\n"}]}}],dependencies:{},references:[{type:"exploreReference",text:"flights",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   EXTRACT(month FROM base."dep_time") as "month_of_year",\n   COUNT(1) as "flight_count",\n   CAST(EXTRACT(year FROM base."dep_time") AS varchar) as "flight_year"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1,3\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"month_of_year",numberType:"integer",type:"number",resultMetadata:{sourceField:"month_of_year",sourceExpression:"month(dep_time)",sourceClasses:["month_of_year"],referenceId:"03c081a4-7278-4377-ac6f-4c1a7b395034",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:3,character:12},end:{line:3,character:44}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"33556861-14a5-4048-a2a1-a0dfec9b4816",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:1,character:11},end:{line:1,character:34}}}},{name:"flight_year",type:"string",resultMetadata:{sourceField:"flight_year",sourceExpression:"year(dep_time)::string",sourceClasses:["flight_year"],referenceId:"e1969267-1b34-4ec9-bb62-e2d29c0e8058",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:5,character:12},end:{line:5,character:49}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights",sourceArguments:{},connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:0},end:{line:1,character:13}}}},{text:"# line_chart\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:0},end:{line:1,character:13}}}}]},result:[{month_of_year:8,flight_count:6415,flight_year:"2005"},{month_of_year:10,flight_count:6228,flight_year:"2004"},{month_of_year:7,flight_count:6227,flight_year:"2005"},{month_of_year:12,flight_count:6202,flight_year:"2004"},{month_of_year:6,flight_count:6118,flight_year:"2005"},{month_of_year:9,flight_count:6100,flight_year:"2005"},{month_of_year:11,flight_count:6084,flight_year:"2004"},{month_of_year:10,flight_count:6083,flight_year:"2005"},{month_of_year:5,flight_count:6064,flight_year:"2005"},{month_of_year:4,flight_count:6043,flight_year:"2005"},{month_of_year:1,flight_count:5997,flight_year:"2005"},{month_of_year:8,flight_count:5993,flight_year:"2004"},{month_of_year:7,flight_count:5775,flight_year:"2004"},{month_of_year:12,flight_count:5770,flight_year:"2005"},{month_of_year:3,flight_count:5732,flight_year:"2005"},{month_of_year:2,flight_count:5707,flight_year:"2005"},{month_of_year:9,flight_count:5689,flight_year:"2004"},{month_of_year:6,flight_count:5622,flight_year:"2004"},{month_of_year:5,flight_count:5609,flight_year:"2004"},{month_of_year:11,flight_count:5533,flight_year:"2005"},{month_of_year:3,flight_count:5463,flight_year:"2004"},{month_of_year:4,flight_count:5385,flight_year:"2004"},{month_of_year:2,flight_count:5223,flight_year:"2004"},{month_of_year:12,flight_count:5134,flight_year:"2003"},{month_of_year:1,flight_count:5124,flight_year:"2004"},{month_of_year:7,flight_count:5117,flight_year:"2003"},{month_of_year:5,flight_count:5114,flight_year:"2003"},{month_of_year:3,flight_count:5017,flight_year:"2003"},{month_of_year:6,flight_count:5005,flight_year:"2003"},{month_of_year:8,flight_count:4918,flight_year:"2003"},{month_of_year:1,flight_count:4892,flight_year:"2003"},{month_of_year:4,flight_count:4873,flight_year:"2003"},{month_of_year:11,flight_count:4729,flight_year:"2003"},{month_of_year:10,flight_count:4726,flight_year:"2003"},{month_of_year:2,flight_count:4720,flight_year:"2003"},{month_of_year:8,flight_count:4607,flight_year:"2001"},{month_of_year:6,flight_count:4451,flight_year:"2001"},{month_of_year:7,flight_count:4440,flight_year:"2001"},{month_of_year:9,flight_count:4431,flight_year:"2003"},{month_of_year:5,flight_count:4407,flight_year:"2001"},{month_of_year:6,flight_count:4375,flight_year:"2002"},{month_of_year:5,flight_count:4348,flight_year:"2002"},{month_of_year:7,flight_count:4346,flight_year:"2002"},{month_of_year:10,flight_count:4340,flight_year:"2002"},{month_of_year:4,flight_count:4328,flight_year:"2001"},{month_of_year:8,flight_count:4326,flight_year:"2002"},{month_of_year:9,flight_count:4261,flight_year:"2002"},{month_of_year:3,flight_count:4252,flight_year:"2000"},{month_of_year:8,flight_count:4182,flight_year:"2000"},{month_of_year:3,flight_count:4102,flight_year:"2002"},{month_of_year:12,flight_count:4086,flight_year:"2001"},{month_of_year:1,flight_count:4071,flight_year:"2001"},{month_of_year:5,flight_count:4047,flight_year:"2000"},{month_of_year:4,flight_count:4046,flight_year:"2002"},{month_of_year:7,flight_count:4043,flight_year:"2000"},{month_of_year:1,flight_count:4020,flight_year:"2000"},{month_of_year:1,flight_count:4008,flight_year:"2002"},{month_of_year:12,flight_count:3999,flight_year:"2002"},{month_of_year:11,flight_count:3914,flight_year:"2002"},{month_of_year:2,flight_count:3876,flight_year:"2000"},{month_of_year:3,flight_count:3869,flight_year:"2001"},{month_of_year:10,flight_count:3858,flight_year:"2000"},{month_of_year:9,flight_count:3850,flight_year:"2000"},{month_of_year:11,flight_count:3819,flight_year:"2001"},{month_of_year:10,flight_count:3809,flight_year:"2001"},{month_of_year:4,flight_count:3778,flight_year:"2000"},{month_of_year:6,flight_count:3774,flight_year:"2000"},{month_of_year:12,flight_count:3744,flight_year:"2000"},{month_of_year:11,flight_count:3718,flight_year:"2000"},{month_of_year:2,flight_count:3672,flight_year:"2001"},{month_of_year:9,flight_count:3616,flight_year:"2001"},{month_of_year:2,flight_count:3583,flight_year:"2002"}],totalRows:72},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6415</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6228</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6227</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6202</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6118</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6100</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6084</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6083</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6064</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6043</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5997</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5993</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5775</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5770</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5732</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5707</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5689</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5622</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5609</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5533</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5463</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5385</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5223</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5134</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5124</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5117</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5114</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5017</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5005</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4918</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4892</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4873</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4729</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4726</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4720</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4607</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4451</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4440</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4431</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4407</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4375</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4348</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4346</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4340</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4328</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4326</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4261</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4252</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4182</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4102</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4086</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4071</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4047</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4046</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4043</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4020</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4008</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3914</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3876</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3869</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3858</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3850</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3819</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3809</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3778</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3774</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3744</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3718</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3672</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3616</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001&quot;</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3583</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002&quot;</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   EXTRACT(</span><span style="color: #795E26">month</span><span style="color: #000000"> </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;month_of_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">CAST</span><span style="color: #000000">(EXTRACT(</span><span style="color: #795E26">year</span><span style="color: #000000"> </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">AS</span><span style="color: #000000"> </span><span style="color: #0000FF">varchar</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_year&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="method-2-filtered-aggregates" class="header-link anchor" href="#method-2-filtered-aggregates">
          Method 2: Filtered Aggregates
        </a>
      </h2>
    <p>Filters make it easy to reuse aggregate calculations for trends analysis.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C7" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carrier</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flights_in_2002</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2002</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flights_in_2003</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5"># percent</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">percent_change</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">      (</span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> } - </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2002</span><span style="color: #000000"> })</span></span>
<span class="line"><span style="color: #000000">        / </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> }, </span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="7eadcae4-367e-4e3e-b65f-5be6fe3902f8">
        <script>(()=>{var e=document.getElementById("7eadcae4-367e-4e3e-b65f-5be6fe3902f8"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},queryList:[{type:"query",structRef:"flights",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carrier"]},{type:"number",numberType:"integer",name:"flights_in_2002",e:{node:"filteredExpr",kids:{e:{node:"field",path:["flight_count"]},filterList:[{node:"filterCondition",code:"dep_time = @2002",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2002-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"dep_time",path:[]},value:{kind:"date_literal",date_value:"2002-01-01",granularity:"year"}}}]}},fieldUsage:[{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]}],expressionType:"aggregate",code:"flight_count { where: dep_time = @2002 }"},{type:"number",numberType:"integer",name:"flights_in_2003",e:{node:"filteredExpr",kids:{e:{node:"field",path:["flight_count"]},filterList:[{node:"filterCondition",code:"dep_time = @2003",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2004-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"dep_time",path:[]},value:{kind:"date_literal",date_value:"2003-01-01",granularity:"year"}}}]}},fieldUsage:[{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]}],expressionType:"aggregate",code:"flight_count { where: dep_time = @2003 }"},{type:"number",name:"percent_change",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"filteredExpr",kids:{e:{node:"field",path:["flight_count"]},filterList:[{node:"filterCondition",code:"dep_time = @2003",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2004-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"dep_time",path:[]},value:{kind:"date_literal",date_value:"2003-01-01",granularity:"year"}}}]}},right:{node:"filteredExpr",kids:{e:{node:"field",path:["flight_count"]},filterList:[{node:"filterCondition",code:"dep_time = @2002",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2002-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"dep_time",path:[]},value:{kind:"date_literal",date_value:"2002-01-01",granularity:"year"}}}]}}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"filteredExpr",kids:{e:{node:"field",path:["flight_count"]},filterList:[{node:"filterCondition",code:"dep_time = @2003",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2004-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"year"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"dep_time",path:[]},value:{kind:"date_literal",date_value:"2003-01-01",granularity:"year"}}}]}},{node:"numberLiteral",literal:"0"}]},expressionType:"aggregate"}}},fieldUsage:[{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]}],expressionType:"aggregate",code:"(flight_count { where: dep_time = @2003 } - flight_count { where: dep_time = @2002 })\n        / nullif(flight_count { where: dep_time = @2003 }, 0)",annotation:{notes:[{text:"# percent\n"}]}}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]},{path:["flight_count"]},{path:["dep_time"]},{path:["dep_time"]}],defaultOrderBy:!0,orderBy:[{field:"flights_in_2002",dir:"desc"}]}],annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n"}]}}],dependencies:{},references:[{type:"exploreReference",text:"flights",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},{type:"fieldReference",definition:{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},text:"carrier"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   base."carrier" as "carrier",\n   (COUNT(CASE WHEN (base."dep_time">=TIMESTAMP \'2002-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2003-01-01 00:00:00\') THEN 1 END)) as "flights_in_2002",\n   (COUNT(CASE WHEN (base."dep_time">=TIMESTAMP \'2003-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2004-01-01 00:00:00\') THEN 1 END)) as "flights_in_2003",\n   ((((COUNT(CASE WHEN (base."dep_time">=TIMESTAMP \'2003-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2004-01-01 00:00:00\') THEN 1 END)))-((COUNT(CASE WHEN (base."dep_time">=TIMESTAMP \'2002-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2003-01-01 00:00:00\') THEN 1 END)))))*1.0/(NULLIF((COUNT(CASE WHEN (base."dep_time">=TIMESTAMP \'2003-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2004-01-01 00:00:00\') THEN 1 END)),0)) as "percent_change"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"carrier",type:"string",resultMetadata:{sourceField:"carrier",sourceClasses:["carrier"],referenceId:"43ff06ca-e31b-4edb-80ba-58f72dbc320a",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:19},end:{line:0,character:58}}}},{name:"flights_in_2002",numberType:"integer",type:"number",resultMetadata:{sourceField:"flights_in_2002",sourceExpression:"flight_count { where: dep_time = @2002 }",sourceClasses:["flights_in_2002"],referenceId:"5008e6d4-62bf-48a4-8699-a8b6c14912c4",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:4,character:4},end:{line:4,character:63}}}},{name:"flights_in_2003",numberType:"integer",type:"number",resultMetadata:{sourceField:"flights_in_2003",sourceExpression:"flight_count { where: dep_time = @2003 }",sourceClasses:["flights_in_2003"],referenceId:"1bd15d97-bfe4-42e3-9af6-6016ba9fafe6",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:5,character:4},end:{line:5,character:63}}}},{name:"percent_change",type:"number",resultMetadata:{sourceField:"percent_change",sourceExpression:"(flight_count { where: dep_time = @2003 } - flight_count { where: dep_time = @2002 })\n        / nullif(flight_count { where: dep_time = @2003 }, 0)",sourceClasses:["percent_change"],referenceId:"0be9de16-be6f-4d2f-aa67-acc6d8211064",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:6,character:4},end:{line:9,character:61}}},annotation:{notes:[{text:"# percent\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:6,character:4},end:{line:6,character:14}}}}]}}],dialect:"duckdb",primaryKey:"carrier",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flights_in_2002",dir:"desc"}],drillable:!0}}],sourceExplore:"flights",sourceArguments:{},connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:0},end:{line:0,character:30}}}}]},result:[{carrier:"WN",flights_in_2002:14708,flights_in_2003:14300,percent_change:-.028531468531468533},{carrier:"US",flights_in_2002:6501,flights_in_2003:4321,percent_change:-.5045128442490164},{carrier:"AA",flights_in_2002:5963,flights_in_2003:5566,percent_change:-.07132590729428674},{carrier:"UA",flights_in_2002:5590,flights_in_2003:6068,percent_change:.07877389584706658},{carrier:"NW",flights_in_2002:5081,flights_in_2003:5187,percent_change:.020435704646230964},{carrier:"DL",flights_in_2002:4400,flights_in_2003:5536,percent_change:.20520231213872833},{carrier:"MQ",flights_in_2002:3469,flights_in_2003:1341,percent_change:-1.586875466070097},{carrier:"HP",flights_in_2002:1586,flights_in_2003:1609,percent_change:.014294592914853946},{carrier:"AS",flights_in_2002:1263,flights_in_2003:1484,percent_change:.14892183288409702},{carrier:"CO",flights_in_2002:1087,flights_in_2003:1162,percent_change:.06454388984509467},{carrier:"EV",flights_in_2002:0,flights_in_2003:5989,percent_change:1},{carrier:"RU",flights_in_2002:0,flights_in_2003:4011,percent_change:1},{carrier:"B6",flights_in_2002:0,flights_in_2003:1530,percent_change:1},{carrier:"OH",flights_in_2002:0,flights_in_2003:0,percent_change:null},{carrier:"TZ",flights_in_2002:0,flights_in_2003:572,percent_change:1}],totalRows:15},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14708</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14300</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.028531468531468533</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6501</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4321</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.5045128442490164</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5963</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5566</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.07132590729428674</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;UA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5590</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6068</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.07877389584706658</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NW&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5081</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5187</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.020435704646230964</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4400</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5536</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.20520231213872833</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MQ&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3469</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1341</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-1.586875466070097</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HP&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1586</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1609</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.014294592914853946</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1263</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1484</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.14892183288409702</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1087</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1162</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.06454388984509467</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;EV&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5989</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;RU&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4011</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;B6&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1530</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;OH&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TZ&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">572</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2002-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flights_in_2002&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2004-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flights_in_2003&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   ((((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2004-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)))-((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2002-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)))))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/(</span><span style="color: #795E26">NULLIF</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2004-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)),</span><span style="color: #098658">0</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;percent_change&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="method-3-calculate-with-lag" class="header-link anchor" href="#method-3-calculate-with-lag">
          Method 3: Calculate with Lag
        </a>
      </h2>
    <p>The <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">calculate</span><span style="color: #000000">:</span></span></code> clause is Malloy's window function equivalent, and allows us to compute year over year calculations using the <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">lag</span></span></code> function:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C9" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">dep_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">calculate</span><span style="color: #000000">: </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">last_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">lag</span><span style="color: #000000">(</span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5"># percent</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">growth</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> (</span><span style="color: #795E26">lag</span><span style="color: #000000">(</span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #098658">1</span><span style="color: #000000">) - </span><span style="color: #001080">flight_count</span><span style="color: #000000">) / </span><span style="color: #795E26">lag</span><span style="color: #000000">(</span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">dep_year</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="b014f7d4-e7a7-4a5f-9f25-389766ad55a4">
        <script>(()=>{var e=document.getElementById("b014f7d4-e7a7-4a5f-9f25-389766ad55a4"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:["flights"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},queryList:[{type:"query",structRef:"flights",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"timestamp",name:"dep_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"fieldref",path:["flight_count"]},{type:"number",numberType:"integer",name:"last_year",e:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar_analytic",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"generic",generic:"T",expressionType:"aggregate",evalSpace:"input"}],isVariadic:!1},{name:"offset",allowedTypes:[{type:"number",expressionType:"scalar",evalSpace:"literal"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"},{type:"boolean"}]}]},name:"lag",kids:{args:[{node:"outputField",name:"flight_count"},{node:"numberLiteral",literal:"1"}]},expressionType:"aggregate_analytic"},fieldUsage:[{path:["flight_count"]}],expressionType:"aggregate_analytic",code:"lag(flight_count, 1)"},{type:"number",name:"growth",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar_analytic",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"generic",generic:"T",expressionType:"aggregate",evalSpace:"input"}],isVariadic:!1},{name:"offset",allowedTypes:[{type:"number",expressionType:"scalar",evalSpace:"literal"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"},{type:"boolean"}]}]},name:"lag",kids:{args:[{node:"outputField",name:"flight_count"},{node:"numberLiteral",literal:"1"}]},expressionType:"aggregate_analytic"},right:{node:"outputField",name:"flight_count"}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar_analytic",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"generic",generic:"T",expressionType:"aggregate",evalSpace:"input"}],isVariadic:!1},{name:"offset",allowedTypes:[{type:"number",expressionType:"scalar",evalSpace:"literal"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"},{node:"function_parameter",name:"offset"}]},src:["LAG(",",",")"]},needsWindowOrderBy:!0}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"},{type:"boolean"}]}]},name:"lag",kids:{args:[{node:"outputField",name:"flight_count"},{node:"numberLiteral",literal:"1"}]},expressionType:"aggregate_analytic"}}},fieldUsage:[{path:["flight_count"]},{path:["flight_count"]},{path:["flight_count"]}],expressionType:"aggregate_analytic",code:"(lag(flight_count, 1) - flight_count) / lag(flight_count, 1)",annotation:{notes:[{text:"# percent\n"}]}}],orderBy:[{field:"dep_year"}],filterList:[],fieldUsage:[{path:["dep_time"]},{path:["flight_count"]},{path:["flight_count"]},{path:["flight_count"]},{path:["flight_count"]},{path:["flight_count"]}]}],annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n"}]}}],dependencies:{},references:[{type:"exploreReference",text:"flights",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"}},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},text:"dep_year"}],imports:[]},a.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   DATE_TRUNC(\'year\', base."dep_time") as "dep_year",\n   COUNT(1) as "flight_count",\n   LAG((COUNT(1)),1) OVER(  ORDER BY  DATE_TRUNC(\'year\', base."dep_time") ASC NULLS LAST ) as "last_year",\n   (((LAG((COUNT(1)),1) OVER(  ORDER BY  DATE_TRUNC(\'year\', base."dep_time") ASC NULLS LAST ))-(COUNT(1))))*1.0/(LAG((COUNT(1)),1) OVER(  ORDER BY  DATE_TRUNC(\'year\', base."dep_time") ASC NULLS LAST )) as "growth"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1\nORDER BY 1 ASC NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"dep_year",type:"timestamp",timeframe:"year",resultMetadata:{sourceField:"dep_year",sourceExpression:"dep_time.year",sourceClasses:["dep_year"],referenceId:"21550765-da94-4968-8430-c519c811f194",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:2,character:12},end:{line:2,character:37}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"c55c201d-99aa-4ecd-90f4-44af883254da",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:1,character:11},end:{line:1,character:34}}}},{name:"last_year",numberType:"integer",type:"number",resultMetadata:{sourceField:"last_year",sourceExpression:"lag(flight_count, 1)",sourceClasses:["last_year"],referenceId:"451311d7-f414-4425-9114-0d9ae180eee7",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:5,character:4},end:{line:5,character:37}}}},{name:"growth",type:"number",resultMetadata:{sourceField:"growth",sourceExpression:"(lag(flight_count, 1) - flight_count) / lag(flight_count, 1)",sourceClasses:["growth"],referenceId:"7c1b681f-c48f-4082-bb8a-1ab72f4c59c8",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:6,character:4},end:{line:7,character:74}}},annotation:{notes:[{text:"# percent\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:6,character:4},end:{line:6,character:14}}}}]}}],dialect:"duckdb",primaryKey:"dep_year",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"dep_year"}],drillable:!0}}],sourceExplore:"flights",sourceArguments:{},connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) size=large limit=5000\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:0,character:0},end:{line:0,character:30}}}}]},result:[{dep_year:"2000-01-01T00:00:00.000Z",flight_count:47142,last_year:null,growth:null},{dep_year:"2001-01-01T00:00:00.000Z",flight_count:49175,last_year:47142,growth:-.043125026515633616},{dep_year:"2002-01-01T00:00:00.000Z",flight_count:49648,last_year:49175,growth:-.00961870869344179},{dep_year:"2003-01-01T00:00:00.000Z",flight_count:58676,last_year:49648,growth:-.18184015468901063},{dep_year:"2004-01-01T00:00:00.000Z",flight_count:68397,last_year:58676,growth:-.16567250664666985},{dep_year:"2005-01-01T00:00:00.000Z",flight_count:71789,last_year:68397,growth:-.04959281839846777}],totalRows:6},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47142</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49175</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47142</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.043125026515633616</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49648</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49175</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.00961870869344179</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">58676</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49648</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.18184015468901063</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">68397</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">58676</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.16567250664666985</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">71789</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">68397</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;growth&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-0.04959281839846777</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;dep_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">LAG</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)),</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OVER</span><span style="color: #000000">(  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000"> ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;last_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   (((</span><span style="color: #795E26">LAG</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)),</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OVER</span><span style="color: #000000">(  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000"> ))-(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">))))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/(</span><span style="color: #795E26">LAG</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)),</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OVER</span><span style="color: #000000">(  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000"> )) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;growth&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="bonus-relative-timeframes-and-expression-reuse" class="header-link anchor" href="#bonus-relative-timeframes-and-expression-reuse">
          Bonus: Relative timeframes and expression reuse
        </a>
      </h2>
    <p>You might like to write queries that automatically adjust based on the current timeframe.  The query below uses date arithmetic to filter the data to time frames relative to now.  These measures probably aren't generally useful in the model so we use the <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">extend</span><span style="color: #000000">:</span></span></code> operation to add these measure so they are only locally accessable within the query.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/yoy.malloynb#C11" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/inventory_items.parquet&#39;</span><span style="color: #000000">) </span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/order_items.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000">  </span><span style="color: #AF00DB">on</span><span style="color: #000000"> </span><span style="color: #001080">inventory_item_id</span><span style="color: #000000"> = </span><span style="color: #001080">inventory_items</span><span style="color: #000000">.</span><span style="color: #001080">id</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">category_growth</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">extend</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// add measures for use just in this query</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #001080">last_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">year</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #001080">prior_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">years</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000">.</span><span style="color: #001080">product_category</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">last_year</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">prior_year</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5"># percent</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">percent_change</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> (</span><span style="color: #001080">last_year</span><span style="color: #000000"> - </span><span style="color: #001080">prior_year</span><span style="color: #000000">) / </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">last_year</span><span style="color: #000000">, </span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000"> -&gt; </span><span style="color: #001080">category_growth</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="5ca31991-5cc8-43f1-aa4b-21e7a7859015">
        <script>(()=>{var e=document.getElementById("5ca31991-5cc8-43f1-aa4b-21e7a7859015"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","inventory_items","order_items"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights"},inventory_items:{type:"table",name:"duckdb:../data/inventory_items.parquet",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},as:"inventory_items",annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]}},order_items:{type:"table",name:"duckdb:../data/order_items.parquet",dialect:"duckdb",tablePath:"../data/order_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"order_id",fieldUsage:[{path:["order_id"]}]},{type:"number",numberType:"integer",name:"user_id",fieldUsage:[{path:["user_id"]}]},{type:"number",numberType:"integer",name:"inventory_item_id",fieldUsage:[{path:["inventory_item_id"]}]},{type:"number",numberType:"float",name:"sale_price",fieldUsage:[{path:["sale_price"]}]},{type:"string",name:"status",fieldUsage:[{path:["status"]}]},{type:"timestamp",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"returned_at",fieldUsage:[{path:["returned_at"]}]},{type:"date",name:"shipped_at",fieldUsage:[{path:["shipped_at"]}]},{type:"date",name:"delivered_at",fieldUsage:[{path:["delivered_at"]}]},{type:"number",numberType:"integer",name:"order_item_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"inventory_items",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["inventory_item_id"],sql:'base."inventory_item_id"'},right:{node:"field",path:["inventory_items","id"],sql:'inventory_items_0."id"'}}},onFieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]}]},{type:"turtle",name:"category_growth",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["inventory_items","product_category"]},{type:"fieldref",path:["last_year"]},{type:"fieldref",path:["prior_year"]},{type:"number",name:"percent_change",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"field",path:["last_year"]},right:{node:"field",path:["prior_year"]}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["last_year"]},{node:"numberLiteral",literal:"0"}]},expressionType:"aggregate"}}},fieldUsage:[{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],expressionType:"aggregate",code:"(last_year - prior_year) / nullif(last_year, 0)",annotation:{notes:[{text:"# percent\n"}]}}],extendSource:[{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"}],limit:10,filterList:[],fieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]},{path:["inventory_items","product_category"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],defaultOrderBy:!0,orderBy:[{field:"last_year",dir:"desc"}]}],annotation:{}}],parameters:{},as:"order_items"}},queryList:[{type:"query",structRef:"order_items",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["inventory_items","product_category"],drillView:"category_growth"},{type:"fieldref",path:["last_year"],drillView:"category_growth"},{type:"fieldref",path:["prior_year"],drillView:"category_growth"},{type:"number",name:"percent_change",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"field",path:["last_year"]},right:{node:"field",path:["prior_year"]}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["last_year"]},{node:"numberLiteral",literal:"0"}]},expressionType:"aggregate"}}},fieldUsage:[{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],expressionType:"aggregate",code:"(last_year - prior_year) / nullif(last_year, 0)",annotation:{notes:[{text:"# percent\n"}]},drillView:"category_growth"}],extendSource:[{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"}],limit:10,filterList:[],fieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]},{path:["inventory_items","product_category"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],defaultOrderBy:!0,orderBy:[{field:"last_year",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:24,character:20},end:{line:24,character:35}}}}],name:"category_growth",annotation:{inherits:{}}}],dependencies:{},references:[{type:"exploreReference",text:"inventory_items",definition:{type:"table",name:"duckdb:../data/inventory_items.parquet",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},as:"inventory_items",annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]}}},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"inventory_item_id",fieldUsage:[{path:["inventory_item_id"]}]},text:"inventory_item_id"},{type:"joinReference",definition:{type:"table",name:"inventory_items",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]},arguments:{},join:"one",matrixOperation:"left"},text:"inventory_items"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},text:"id"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"order_item_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"order_item_count"},{type:"fieldReference",definition:{type:"timestamp",name:"created_at",fieldUsage:[{path:["created_at"]}]},text:"created_at"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"order_item_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"order_item_count"},{type:"fieldReference",definition:{type:"timestamp",name:"created_at",fieldUsage:[{path:["created_at"]}]},text:"created_at"},{type:"joinReference",definition:{type:"table",name:"inventory_items",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["inventory_item_id"]},right:{node:"field",path:["inventory_items","id"]}}},onFieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]}]},text:"inventory_items"},{type:"fieldReference",definition:{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},text:"product_category"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},text:"last_year"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"},text:"prior_year"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},text:"last_year"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"},text:"prior_year"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},text:"last_year"},{type:"joinReference",definition:{type:"table",name:"inventory_items",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["inventory_item_id"]},right:{node:"field",path:["inventory_items","id"]}}},onFieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]}]},text:"inventory_items"},{type:"exploreReference",text:"order_items",definition:{type:"table",name:"duckdb:../data/order_items.parquet",dialect:"duckdb",tablePath:"../data/order_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"order_id",fieldUsage:[{path:["order_id"]}]},{type:"number",numberType:"integer",name:"user_id",fieldUsage:[{path:["user_id"]}]},{type:"number",numberType:"integer",name:"inventory_item_id",fieldUsage:[{path:["inventory_item_id"]}]},{type:"number",numberType:"float",name:"sale_price",fieldUsage:[{path:["sale_price"]}]},{type:"string",name:"status",fieldUsage:[{path:["status"]}]},{type:"timestamp",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"returned_at",fieldUsage:[{path:["returned_at"]}]},{type:"date",name:"shipped_at",fieldUsage:[{path:["shipped_at"]}]},{type:"date",name:"delivered_at",fieldUsage:[{path:["delivered_at"]}]},{type:"number",numberType:"integer",name:"order_item_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"inventory_items",dialect:"duckdb",tablePath:"../data/inventory_items.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"number",numberType:"integer",name:"product_id",fieldUsage:[{path:["product_id"]}]},{type:"date",name:"created_at",fieldUsage:[{path:["created_at"]}]},{type:"timestamp",name:"sold_at",fieldUsage:[{path:["sold_at"]}]},{type:"number",numberType:"float",name:"cost",fieldUsage:[{path:["cost"]}]},{type:"string",name:"product_category",fieldUsage:[{path:["product_category"]}]},{type:"string",name:"product_name",fieldUsage:[{path:["product_name"]}]},{type:"string",name:"product_brand",fieldUsage:[{path:["product_brand"]}]},{type:"number",numberType:"float",name:"product_retail_price",fieldUsage:[{path:["product_retail_price"]}]},{type:"string",name:"product_department",fieldUsage:[{path:["product_department"]}]},{type:"string",name:"product_sku",fieldUsage:[{path:["product_sku"]}]},{type:"number",numberType:"integer",name:"product_distribution_center_id",fieldUsage:[{path:["product_distribution_center_id"]}]}],parameters:{},annotation:{blockNotes:[{text:"#(docs) size=medium limit=5000\n"}]},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["inventory_item_id"]},right:{node:"field",path:["inventory_items","id"]}}},onFieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]}]},{type:"turtle",name:"category_growth",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["inventory_items","product_category"]},{type:"fieldref",path:["last_year"]},{type:"fieldref",path:["prior_year"]},{type:"number",name:"percent_change",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"field",path:["last_year"]},right:{node:"field",path:["prior_year"]}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["last_year"]},{node:"numberLiteral",literal:"0"}]},expressionType:"aggregate"}}},fieldUsage:[{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],expressionType:"aggregate",code:"(last_year - prior_year) / nullif(last_year, 0)",annotation:{notes:[{text:"# percent\n"}]}}],extendSource:[{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"}],limit:10,filterList:[],fieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]},{path:["inventory_items","product_category"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],defaultOrderBy:!0,orderBy:[{field:"last_year",dir:"desc"}]}],annotation:{}}],parameters:{},as:"order_items"}},{type:"fieldReference",definition:{type:"turtle",name:"category_growth",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["inventory_items","product_category"]},{type:"fieldref",path:["last_year"]},{type:"fieldref",path:["prior_year"]},{type:"number",name:"percent_change",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"field",path:["last_year"]},right:{node:"field",path:["prior_year"]}}}},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["last_year"]},{node:"numberLiteral",literal:"0"}]},expressionType:"aggregate"}}},fieldUsage:[{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],expressionType:"aggregate",code:"(last_year - prior_year) / nullif(last_year, 0)",annotation:{notes:[{text:"# percent\n"}]}}],extendSource:[{type:"number",numberType:"integer",name:"last_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 1 year",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 1 year }"},{type:"number",numberType:"integer",name:"prior_year",e:{node:"filteredExpr",kids:{e:{node:"field",path:["order_item_count"]},filterList:[{node:"filterCondition",code:"created_at ? now.year - 2 years",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year"}}},right:{node:"<",kids:{left:{node:"field",path:["created_at"]},right:{node:"delta",kids:{base:{node:"delta",kids:{base:{node:"trunc",e:{node:"now",typeDef:{type:"timestamp"}},units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"2"}},op:"-",units:"year",typeDef:{type:"timestamp"}},delta:{node:"numberLiteral",literal:"1"}},op:"+",units:"year"}}}}},expressionType:"scalar",fieldUsage:[{path:["created_at"]},{path:["created_at"]}]}]}},fieldUsage:[{path:["order_item_count"]},{path:["created_at"]},{path:["created_at"]}],expressionType:"aggregate",code:"order_item_count { where: created_at ? now.year - 2 years }"}],limit:10,filterList:[],fieldUsage:[{path:["inventory_item_id"]},{path:["inventory_items","id"]},{path:["inventory_items","product_category"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]},{path:["prior_year"]},{path:["last_year"]}],defaultOrderBy:!0,orderBy:[{field:"last_year",dir:"desc"}]}],annotation:{}},text:"category_growth"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   inventory_items_0."product_category" as "product_category",\n   (COUNT(CASE WHEN (base."created_at">=(DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year)) and (base."created_at"<((DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year) + INTERVAL (1) year)) THEN 1 END)) as "last_year",\n   (COUNT(CASE WHEN (base."created_at">=(DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (2) year)) and (base."created_at"<((DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (2) year) + INTERVAL (1) year)) THEN 1 END)) as "prior_year",\n   ((((COUNT(CASE WHEN (base."created_at">=(DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year)) and (base."created_at"<((DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year) + INTERVAL (1) year)) THEN 1 END)))-((COUNT(CASE WHEN (base."created_at">=(DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (2) year)) and (base."created_at"<((DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (2) year) + INTERVAL (1) year)) THEN 1 END)))))*1.0/(NULLIF(((COUNT(CASE WHEN (base."created_at">=(DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year)) and (base."created_at"<((DATE_TRUNC(\'year\', LOCALTIMESTAMP) - INTERVAL (1) year) + INTERVAL (1) year)) THEN 1 END))),0)) as "percent_change"\nFROM \'../data/order_items.parquet\' as base\n LEFT JOIN \'../data/inventory_items.parquet\' AS inventory_items_0\n  ON base."inventory_item_id"=inventory_items_0."id"\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\nLIMIT 10\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"product_category",type:"string",resultMetadata:{sourceField:"inventory_items.product_category",sourceClasses:["inventory_items.product_category"],referenceId:"c992a6c2-afe2-4d50-9f67-800d675e2fd1",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:1,character:27},end:{line:1,character:74}}},drillView:"category_growth"},{name:"last_year",numberType:"integer",type:"number",resultMetadata:{sourceField:"last_year",sourceExpression:"order_item_count { where: created_at ? now.year - 1 year }",sourceClasses:["last_year"],referenceId:"207d425e-0350-48f0-9601-d00c1e19834e",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:11,character:8},end:{line:11,character:79}}},drillView:"category_growth"},{name:"prior_year",numberType:"integer",type:"number",resultMetadata:{sourceField:"prior_year",sourceExpression:"order_item_count { where: created_at ? now.year - 2 years }",sourceClasses:["prior_year"],referenceId:"ec5490e7-c44f-4036-88e1-11000376032e",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:12,character:8},end:{line:12,character:81}}},drillView:"category_growth"},{name:"percent_change",type:"number",resultMetadata:{sourceField:"percent_change",sourceExpression:"(last_year - prior_year) / nullif(last_year, 0)",sourceClasses:["percent_change"],referenceId:"80fbf6be-a8eb-40da-8bd9-115e799aaff5",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:19,character:6},end:{line:20,character:71}}},annotation:{notes:[{text:"# percent\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/yoy.malloynb",range:{start:{line:19,character:6},end:{line:19,character:16}}}}]},drillView:"category_growth"}],dialect:"duckdb",primaryKey:"product_category",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:10,orderBy:[{field:"last_year",dir:"desc"}],drillable:!0}}],sourceExplore:"order_items",sourceArguments:{},queryName:"category_growth",connectionName:"duckdb",annotation:{inherits:{}},result:[{product_category:"Suits & Sport Coats",last_year:0,prior_year:0,percent_change:null},{product_category:"Plus",last_year:0,prior_year:0,percent_change:null},{product_category:"Underwear",last_year:0,prior_year:0,percent_change:null},{product_category:"Swim",last_year:0,prior_year:0,percent_change:null},{product_category:"Dresses",last_year:0,prior_year:0,percent_change:null}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Suits &amp; Sport Coats&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Plus&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Underwear&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Swim&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Dresses&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   inventory_items_0.</span><span style="color: #A31515">&quot;product_category&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;product_category&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&gt;=(DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&lt;((DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">) + INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;last_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&gt;=(DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&lt;((DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">) + INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;prior_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   ((((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&gt;=(DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&lt;((DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">) + INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)))-((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&gt;=(DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&lt;((DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">) + INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)))))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/(</span><span style="color: #795E26">NULLIF</span><span style="color: #000000">(((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&gt;=(DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;created_at&quot;</span><span style="color: #000000">&lt;((DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, LOCALTIMESTAMP) - INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">) + INTERVAL (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #795E26">year</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))),</span><span style="color: #098658">0</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;percent_change&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/order_items.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/inventory_items.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> inventory_items_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;inventory_item_id&quot;</span><span style="color: #000000">=inventory_items_0.</span><span style="color: #A31515">&quot;id&quot;</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div></div></div>
        </div>
        <script src="/js/view_toggles.js"></script>
        <script src="/js/jump_to_hash.js"></script>
      </div>
    </div>
    <div id="banner_wrapper">
      <div id="banner">
        <div>
          This site uses cookies from Google to deliver its services and to analyze
          traffic.
          <a
            href="https://policies.google.com/technologies/cookies"
            target="_blank"
          >
            Learn more
          </a>
        </div>
        <button id="banner_button">I Understand</button>
      </div>
    </div>
    <script src="/js/banner.js"></script>
    <script src="/js/generated/malloy-render-0.0.282.js"></script>
  </body>
</html>
