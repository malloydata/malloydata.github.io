<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Auto-binning Histograms | Malloy Documentation</title>
    <link rel="stylesheet" href="/css/document.css" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/img/favicon.ico"
    />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-0M10W7C20Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
    
      gtag("config", "G-0M10W7C20Y");
    </script>
    <style>
      malloy-render::part(table-container) {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="top">
      <div class="header">
        <div class="header-banner">
          <a href="http://www.malloydata.dev" target="_blank">
            <img
              class="logo"
              src="/img/logo.png"
              alt="malloy logo"
            />
          </a>

          Malloy
          <span class="subtitle">Documentation</span>
        </div>
        <div class="header-right">
          <div class="header-links">
            <a href="https://github.com/malloydata/malloy" target="_blank"
              ><img
                src="/img/github.svg"
                style="transform: scale(0.5)"
            /></a>
            <a href="/slack" target="_blank"
              ><img src="/img/slack.svg"
            /></a>
          </div>
          <form onSubmit="() => alert('submit')" action="/search">
            <div class="search-input-outer">
              <img src="/img/search.svg" alt="search" />
              <input placeholder="Search" id="search-input" name="query" />
            </div>
            <input type="submit" style="display: none" />
          </form>
        </div>
      </div>
      <div class="main">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
              <div id=about_malloy
                class="sidebar-section-title {% unless /documentation/index.html,/documentation/about/features.html,/documentation/about/tao.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                About Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation">
                <img src="/img/article_icon.svg" alt="document"/>
                What Is Malloy
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/features">
                <img src="/img/article_icon.svg" alt="document"/>
                Key Features
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/tao">
                <img src="/img/article_icon.svg" alt="document"/>
                The Tao of Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=setting_up malloy
                class="sidebar-section-title {% unless /documentation/setup/extension.html,/documentation/setup/connection_instructions.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Setting up Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/setup/extension">
                <img src="/img/article_icon.svg" alt="document"/>
                Installing the Malloy Extension
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/connection_instructions">
                <img src="/img/article_icon.svg" alt="document"/>
                Connecting a Database
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=user_guides
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/malloy_by_example.html,/documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                User Guides
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/querying_a_model">
                <img src="/img/article_icon.svg" alt="document"/>
                Querying a Semantic Model
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_by_example">
                <img src="/img/article_icon.svg" alt="document"/>
                Building Semantic Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts1">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for SQL Folks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts2">
                <img src="/img/article_icon.svg" alt="document"/>
                More Guidance for SQL Users
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=language_reference
                class="sidebar-section-title {% unless /documentation/language/statement.html,/documentation/language/source.html,/documentation/language/query.html,/documentation/language/views.html,/documentation/language/datatypes.html,/documentation/language/fields.html,/documentation/language/aggregates.html,/documentation/language/expressions.html,/documentation/language/functions.html,/documentation/language/filters.html,/documentation/language/calculations_windows.html,/documentation/language/order_by.html,/documentation/language/join.html,/documentation/language/nesting.html,/documentation/language/sql_sources.html,/documentation/language/imports.html,/documentation/language/connections.html,/documentation/language/tags.html,/documentation/language/quick_reference.html,/documentation/language/changelog.html,/documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Language Reference
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/statement">
                <img src="/img/article_icon.svg" alt="document"/>
                Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/source">
                <img src="/img/article_icon.svg" alt="document"/>
                Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/query">
                <img src="/img/article_icon.svg" alt="document"/>
                Queries
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/views">
                <img src="/img/article_icon.svg" alt="document"/>
                Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/datatypes">
                <img src="/img/article_icon.svg" alt="document"/>
                Data Types
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/fields">
                <img src="/img/article_icon.svg" alt="document"/>
                Fields
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/aggregates">
                <img src="/img/article_icon.svg" alt="document"/>
                Aggregates
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/functions">
                <img src="/img/article_icon.svg" alt="document"/>
                Functions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/filters">
                <img src="/img/article_icon.svg" alt="document"/>
                Filters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/calculations_windows">
                <img src="/img/article_icon.svg" alt="document"/>
                Calculations (window functions)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/order_by">
                <img src="/img/article_icon.svg" alt="document"/>
                Ordering and Limiting
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/join">
                <img src="/img/article_icon.svg" alt="document"/>
                Joins
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/nesting">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/sql_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/imports">
                <img src="/img/article_icon.svg" alt="document"/>
                Imports
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/tags">
                <img src="/img/article_icon.svg" alt="document"/>
                Tags
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/quick_reference.html">
                <img src="/img/article_icon.svg" alt="document"/>
                Quick Reference
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/changelog">
                <img src="/img/article_icon.svg" alt="document"/>
                Change Log
              </a>
            </div>
        <div class="sidebar-section">
              <div id=dialects
                class="sidebar-section-title {% unless /documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Dialects
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/dialect/bigquery">
                <img src="/img/article_icon.svg" alt="document"/>
                BigQuery
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/presto-trino">
                <img src="/img/article_icon.svg" alt="document"/>
                Presto / Trino
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/snowflake">
                <img src="/img/article_icon.svg" alt="document"/>
                Snowflake
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mysql">
                <img src="/img/article_icon.svg" alt="document"/>
                MySQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                DuckDB
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/postgres">
                <img src="/img/article_icon.svg" alt="document"/>
                PostgreSQL
              </a>
            </div>
              </div>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=common_patterns
                class="sidebar-section-title {% unless /documentation/patterns/yoy.html,/documentation/patterns/foreign_sums.html,/documentation/patterns/reading_nested.html,/documentation/patterns/percent_of_total.html,/documentation/patterns/cohorts.html,/documentation/patterns/nested_subtotals.html,/documentation/patterns/other.html,/documentation/patterns/autobin.html,/documentation/patterns/moving_avg.html,/documentation/patterns/transform.html,/documentation/patterns/sessionize.html,/documentation/patterns/dim_index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Common Patterns
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/patterns/yoy">
                <img src="/img/article_icon.svg" alt="document"/>
                Comparing Timeframes
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/foreign_sums">
                <img src="/img/article_icon.svg" alt="document"/>
                Foreign Sums and Averages
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/reading_nested">
                <img src="/img/article_icon.svg" alt="document"/>
                Reading Nested Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/percent_of_total">
                <img src="/img/article_icon.svg" alt="document"/>
                Percent of Total
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/cohorts">
                <img src="/img/article_icon.svg" alt="document"/>
                Cohort Analysis
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/nested_subtotals">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Subtotals
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/other">
                <img src="/img/article_icon.svg" alt="document"/>
                Bucketing with 'Other'
              </a>
            </div>
        <div class='sidebar-item active'>
              <a href="/documentation/patterns/autobin">
                <img src="/img/article_icon.svg" alt="document"/>
                Auto-binning Histograms
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/moving_avg">
                <img src="/img/article_icon.svg" alt="document"/>
                Moving Average
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/sessionize">
                <img src="/img/article_icon.svg" alt="document"/>
                Sessionize - Map/Reduce
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/dim_index">
                <img src="/img/article_icon.svg" alt="document"/>
                Dimensional Indexes
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_results
                class="sidebar-section-title {% unless /documentation/visualizations/about_rendering.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Results
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/about_rendering">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_legacy docs
                class="sidebar-section-title {% unless /documentation/visualizations/overview.html,/documentation/visualizations/numbers.html,/documentation/visualizations/links.html,/documentation/visualizations/pivots.html,/documentation/visualizations/transpose.html,/documentation/visualizations/dashboards.html,/documentation/visualizations/lists.html,/documentation/visualizations/bar_charts.html,/documentation/visualizations/charts_line_chart.html,/documentation/visualizations/scatter_charts.html,/documentation/visualizations/shape_maps.html,/documentation/visualizations/segment_maps.html,/documentation/visualizations/legacy_renderer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Legacy Docs
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/overview">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/numbers">
                <img src="/img/article_icon.svg" alt="document"/>
                Numbers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/links">
                <img src="/img/article_icon.svg" alt="document"/>
                Links
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/pivots">
                <img src="/img/article_icon.svg" alt="document"/>
                Pivoted Tables
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/transpose">
                <img src="/img/article_icon.svg" alt="document"/>
                Table Transpose
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/dashboards">
                <img src="/img/article_icon.svg" alt="document"/>
                Dashboards
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/lists">
                <img src="/img/article_icon.svg" alt="document"/>
                Lists
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/bar_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Bar Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/charts_line_chart">
                <img src="/img/article_icon.svg" alt="document"/>
                Line Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/scatter_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Scatter Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/shape_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Shape Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/segment_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Segment Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/legacy_renderer">
                <img src="/img/article_icon.svg" alt="document"/>
                Legacy Renderer
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloysql
                class="sidebar-section-title {% unless /documentation/malloy_sql/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                MalloySQL
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_sql/index">
                <img src="/img/article_icon.svg" alt="document"/>
                Using MalloySQL
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_cli
                class="sidebar-section-title {% unless /documentation/malloy_cli/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy CLI
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_cli/index">
                <img src="/img/article_icon.svg" alt="document"/>
                The Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_with python
                class="sidebar-section-title {% unless /documentation/malloy_python/python_package.html,/documentation/malloy_python/jupyter.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy with Python
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_python/python_package">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy Python Package
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/malloy_python/jupyter">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy in Jupyter Notebooks
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=experiments_(in process features)
                class="sidebar-section-title {% unless /documentation/experiments/experiments.html,/documentation/experiments/joins.html,/documentation/experiments/sql_expressions.html,/documentation/experiments/window.html,/documentation/experiments/parameters.html,/documentation/experiments/composite_sources.html,/documentation/experiments/include.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Experiments (in process features)
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/experiments/experiments">
                <img src="/img/article_icon.svg" alt="document"/>
                Experiments
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/joins">
                <img src="/img/article_icon.svg" alt="document"/>
                Join INNER/RIGHT/FULL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/sql_expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/window">
                <img src="/img/article_icon.svg" alt="document"/>
                Window Partitions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/parameters">
                <img src="/img/article_icon.svg" alt="document"/>
                Parameters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/composite_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                Composite "Cube" Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/include">
                <img src="/img/article_icon.svg" alt="document"/>
                Access Modifiers
              </a>
            </div>
              </div>
            </div>
          </div>        <script src="/js/sidebar_state.js"></script>
        <div class="content">
          <div class="footer">
            
<div class="linear-navigation">
  <div class="item">
      <a href="other.html"><img src="/img/previous.svg" alt="previous"/>Bucketing with &#x27;Other&#x27;</a>
  </div>
  <div class="item">
      <a href="moving_avg.html">Moving Average<img src="/img/next.svg" alt="next"/></a>
  </div>
</div> 
          </div>
          <div class="document-outer"><div class="document"><div class="title-row">
        
      <h1>
        <a id="automatically-binning-data" class="header-link anchor" href="#automatically-binning-data">
          Automatically Binning Data
        </a>
      </h1>
    
        <a class="edit-link" target="_blank" href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/autobin.malloynb#C1">VSCode <img src="/img/open_notebook.svg" alt="document"/></a>
        </div>
      <p>By examining the range of values over a dataset, we can compute the appropriate histogram bin size, while capturing the data at the same time.  We can then pipe the output to another query to display a histogram.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/autobin.malloynb#C2" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5"># bar_chart</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">by_elevation</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">bin_size</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> (</span><span style="color: #795E26">max</span><span style="color: #000000">(</span><span style="color: #001080">elevation</span><span style="color: #000000">) - </span><span style="color: #795E26">min</span><span style="color: #000000">(</span><span style="color: #001080">elevation</span><span style="color: #000000">)) / </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">data</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">elevation</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">row_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">  } -&gt; {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">elevation</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">floor</span><span style="color: #000000">(</span><span style="color: #001080">data</span><span style="color: #000000">.</span><span style="color: #001080">elevation</span><span style="color: #000000"> / </span><span style="color: #001080">bin_size</span><span style="color: #000000">) * </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">bin_size</span><span style="color: #000000">, </span><span style="color: #098658">0</span><span style="color: #000000">) + </span><span style="color: #001080">bin_size</span><span style="color: #000000"> / </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">data</span><span style="color: #000000">.</span><span style="color: #001080">row_count</span><span style="color: #000000">.</span><span style="color: #795E26">sum</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">elevation</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre></div>
      <h2>
        <a id="overall-elevation-distribution" class="header-link anchor" href="#overall-elevation-distribution">
          Overall elevation distribution
        </a>
      </h2>
    <p>The query can be used to show the overall distribution of the data.</p>
<p>We are showing the bin_size in this exmaple for clarity.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/autobin.malloynb#C4" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> -&gt; </span><span style="color: #001080">by_elevation</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="829bcc5c-a4d5-4bfb-a548-584d8aa73eae">
        <script>(()=>{var e=document.getElementById("829bcc5c-a4d5-4bfb-a548-584d8aa73eae"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:["airports"],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},queryList:[{type:"query",structRef:"airports",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:1,character:17},end:{line:1,character:29}}}},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],name:"by_elevation",annotation:{notes:[],blockNotes:[{text:"#(docs) limit=5000 size=large\n"}],inherits:{blockNotes:[{text:"# bar_chart\n"}]}}}],dependencies:{},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},{type:"fieldReference",definition:{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}},text:"by_elevation"}],imports:[]},a.queryResult={lastStageName:"__stage2",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    ((CASE WHEN group_set=0 THEN\n      max(base."elevation")\n      END-CASE WHEN group_set=0 THEN\n      min(base."elevation")\n      END))*1.0/30 as "bin_size__0",\n    CASE WHEN group_set=1 THEN\n      base."elevation"\n      END as "elevation__1",\n    CASE WHEN group_set=1 THEN\n      COUNT(1)\n      END as "row_count__1"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,1,1)) as group_set  ) as group_set\n  GROUP BY 1,3\n)\n, __stage1 AS (\n  SELECT\n    MAX(CASE WHEN group_set=0 THEN "bin_size__0" END) as "bin_size",\n    COALESCE(LIST({\n      "elevation": "elevation__1", \n      "row_count": "row_count__1"}  ORDER BY  "row_count__1" desc NULLS LAST) FILTER (WHERE group_set=1),[]) as "data"\n  FROM __stage0\n)\nSELECT \n   ((FLOOR(data_0."elevation"*1.0/base."bin_size"))*(NULLIF(base."bin_size",0)))+(base."bin_size"*1.0/2) as "elevation",\n   COALESCE(SUM(data_0."row_count"),0) as "airport_count"\nFROM __stage1 as base\nLEFT JOIN LATERAL (SELECT UNNEST(base."data"), 1 as ignoreme) as data_0_outer(data_0,ignoreme) ON data_0_outer.ignoreme=1\nGROUP BY 1\nORDER BY 1 ASC NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage2",fields:[{name:"elevation",type:"number",resultMetadata:{sourceField:"elevation",sourceExpression:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2",sourceClasses:["elevation"],referenceId:"4f5812e1-02b7-41c6-b408-ba5516f54a93",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:10,character:14},end:{line:11,character:75}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"data.row_count.sum()",sourceClasses:["airport_count"],referenceId:"902bd65a-0636-401f-976f-2054dbb35339",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:12,character:15},end:{line:12,character:52}}}}],dialect:"duckdb",primaryKey:"elevation",connection:"duckdb",resultMetadata:{sourceField:"~computeLastStage~",filterList:[],sourceClasses:["~computeLastStage~"],fieldKind:"struct",orderBy:[{field:"elevation"}],drillable:!0}}],sourceExplore:"airports",sourceArguments:{},queryName:"by_elevation",connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) limit=5000 size=large\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:0,character:0},end:{line:0,character:30}}}}],inherits:{blockNotes:[{text:"# bar_chart\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:2,character:2},end:{line:2,character:14}}}}]}},result:[{elevation:-210.86666666666667,airport_count:12},{elevation:210.86666666666667,airport_count:6230},{elevation:632.6,airport_count:5015},{elevation:1054.3333333333335,airport_count:3858},{elevation:1476.0666666666666,airport_count:1362},{elevation:1897.8000000000002,airport_count:625},{elevation:2319.5333333333338,airport_count:446},{elevation:2741.266666666667,airport_count:333},{elevation:3163,airport_count:244},{elevation:3584.7333333333336,airport_count:227},{elevation:4006.466666666667,airport_count:225},{elevation:4428.200000000001,airport_count:240},{elevation:4849.933333333333,airport_count:248},{elevation:5271.666666666667,airport_count:178},{elevation:5693.400000000001,airport_count:128},{elevation:6115.133333333333,airport_count:108},{elevation:6536.866666666667,airport_count:96},{elevation:6958.6,airport_count:70},{elevation:7380.333333333334,airport_count:40},{elevation:7802.0666666666675,airport_count:33},{elevation:8223.8,airport_count:23},{elevation:8645.533333333335,airport_count:12},{elevation:9067.266666666666,airport_count:10},{elevation:9489,airport_count:8},{elevation:9910.733333333334,airport_count:11},{elevation:10332.466666666667,airport_count:3},{elevation:10754.2,airport_count:5},{elevation:11175.933333333334,airport_count:2},{elevation:12441.133333333333,airport_count:1}],totalRows:29},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-210.86666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">210.86666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6230</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">632.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5015</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1054.3333333333335</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3858</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1476.0666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1362</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1897.8000000000002</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">625</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2319.5333333333338</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">446</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2741.266666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">333</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3163</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">244</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3584.7333333333336</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">227</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4006.466666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">225</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4428.200000000001</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">240</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4849.933333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">248</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5271.666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">178</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5693.400000000001</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">128</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6115.133333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">108</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6536.866666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">96</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6958.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">70</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7380.333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">40</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7802.0666666666675</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8223.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8645.533333333335</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9067.266666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9489</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9910.733333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10332.466666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10754.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11175.933333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12441.133333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    ((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">max</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">-</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">min</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">30</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;elevation&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;row_count__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">, __stage1 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;elevation__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;row_count__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;row_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;data&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   ((</span><span style="color: #795E26">FLOOR</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">))*(</span><span style="color: #795E26">NULLIF</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">,</span><span style="color: #098658">0</span><span style="color: #000000">)))+(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">),</span><span style="color: #098658">0</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> LATERAL (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(base.</span><span style="color: #A31515">&quot;data&quot;</span><span style="color: #000000">), </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> ignoreme) </span><span style="color: #0000FF">as</span><span style="color: #000000"> data_0_outer(data_0,ignoreme) </span><span style="color: #0000FF">ON</span><span style="color: #000000"> data_0_outer.ignoreme=</span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="distribution-adapts-automatically" class="header-link anchor" href="#distribution-adapts-automatically">
          Distribution Adapts Automatically
        </a>
      </h2>
    <p>Notice that when we look at Florida, the bin-width is different.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/autobin.malloynb#C6" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">state</span><span style="color: #000000"> = </span><span style="color: #A31515">&#39;FL&#39;</span><span style="color: #000000"> } -&gt; </span><span style="color: #001080">by_elevation</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="c5957430-f1dd-40cb-b861-f3f14403208e">
        <script>(()=>{var e=document.getElementById("c5957430-f1dd-40cb-b861-f3f14403208e"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:["airports"],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports",arguments:{},filterList:[{node:"filterCondition",code:"state = 'FL'",e:{node:"=",kids:{left:{node:"field",path:["state"],sql:'base."state"'},right:{node:"stringLiteral",literal:"FL",sql:"'FL'"}}},expressionType:"scalar",fieldUsage:[{path:["state"]}],stableFilter:{kind:"literal_equality",field_reference:{name:"state",path:[]},value:{kind:"string_literal",string_value:"FL"}}}]},pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:1,character:48},end:{line:1,character:60}}}},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],name:"by_elevation",annotation:{notes:[],blockNotes:[{text:"#(docs) limit=5000 size=large\n"}],inherits:{blockNotes:[{text:"# bar_chart\n"}]}}}],dependencies:{},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}},text:"by_elevation"}],imports:[]},a.queryResult={lastStageName:"__stage2",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    ((CASE WHEN group_set=0 THEN\n      max(base."elevation")\n      END-CASE WHEN group_set=0 THEN\n      min(base."elevation")\n      END))*1.0/30 as "bin_size__0",\n    CASE WHEN group_set=1 THEN\n      base."elevation"\n      END as "elevation__1",\n    CASE WHEN group_set=1 THEN\n      COUNT(1)\n      END as "row_count__1"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,1,1)) as group_set  ) as group_set\n  WHERE (base."state"=\'FL\')\n  AND ((group_set NOT IN (1) OR (group_set IN (1) AND base."state"=\'FL\')))\n  GROUP BY 1,3\n)\n, __stage1 AS (\n  SELECT\n    MAX(CASE WHEN group_set=0 THEN "bin_size__0" END) as "bin_size",\n    COALESCE(LIST({\n      "elevation": "elevation__1", \n      "row_count": "row_count__1"}  ORDER BY  "row_count__1" desc NULLS LAST) FILTER (WHERE group_set=1),[]) as "data"\n  FROM __stage0\n)\nSELECT \n   ((FLOOR(data_0."elevation"*1.0/base."bin_size"))*(NULLIF(base."bin_size",0)))+(base."bin_size"*1.0/2) as "elevation",\n   COALESCE(SUM(data_0."row_count"),0) as "airport_count"\nFROM __stage1 as base\nLEFT JOIN LATERAL (SELECT UNNEST(base."data"), 1 as ignoreme) as data_0_outer(data_0,ignoreme) ON data_0_outer.ignoreme=1\nGROUP BY 1\nORDER BY 1 ASC NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage2",fields:[{name:"elevation",type:"number",resultMetadata:{sourceField:"elevation",sourceExpression:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2",sourceClasses:["elevation"],referenceId:"fe997968-fe84-48b4-9891-bd6dea6cbb57",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:10,character:14},end:{line:11,character:75}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"data.row_count.sum()",sourceClasses:["airport_count"],referenceId:"63e717eb-db50-4951-9476-e7bd7585157d",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:12,character:15},end:{line:12,character:52}}}}],dialect:"duckdb",primaryKey:"elevation",connection:"duckdb",resultMetadata:{sourceField:"~computeLastStage~",filterList:[],sourceClasses:["~computeLastStage~"],fieldKind:"struct",orderBy:[{field:"elevation"}],drillable:!0}}],sourceExplore:"airports",sourceArguments:{},queryName:"by_elevation",connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) limit=5000 size=large\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:0,character:0},end:{line:0,character:30}}}}],inherits:{blockNotes:[{text:"# bar_chart\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:2,character:2},end:{line:2,character:14}}}}]}},result:[{elevation:5.566666666666666,airport_count:137},{elevation:16.7,airport_count:134},{elevation:27.833333333333332,airport_count:87},{elevation:38.96666666666667,airport_count:40},{elevation:50.099999999999994,airport_count:55},{elevation:61.233333333333334,airport_count:45},{elevation:72.36666666666666,airport_count:50},{elevation:83.5,airport_count:46},{elevation:94.63333333333333,airport_count:57},{elevation:105.76666666666665,airport_count:31},{elevation:116.89999999999999,airport_count:32},{elevation:128.03333333333333,airport_count:25},{elevation:139.16666666666666,airport_count:16},{elevation:150.29999999999998,airport_count:27},{elevation:161.43333333333334,airport_count:13},{elevation:172.56666666666666,airport_count:6},{elevation:183.7,airport_count:5},{elevation:194.83333333333331,airport_count:14},{elevation:205.96666666666664,airport_count:4},{elevation:217.1,airport_count:6},{elevation:228.23333333333332,airport_count:3},{elevation:239.36666666666665,airport_count:4},{elevation:250.5,airport_count:6},{elevation:261.6333333333333,airport_count:3},{elevation:272.76666666666665,airport_count:2},{elevation:283.9,airport_count:3},{elevation:295.0333333333333,airport_count:3},{elevation:328.43333333333334,airport_count:1},{elevation:339.56666666666666,airport_count:1}],totalRows:29},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5.566666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">137</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">134</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27.833333333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">87</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">38.96666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">40</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">50.099999999999994</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">61.233333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">72.36666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">50</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">83.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">46</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">94.63333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">57</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">105.76666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">116.89999999999999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">128.03333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">25</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">139.16666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">150.29999999999998</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">161.43333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">172.56666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">183.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">194.83333333333331</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">205.96666666666664</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">217.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">228.23333333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">239.36666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">250.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">261.6333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">272.76666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">283.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">295.0333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">328.43333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">339.56666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    ((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">max</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">-</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">min</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">30</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;elevation&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;row_count__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">=</span><span style="color: #A31515">&#39;FL&#39;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">AND</span><span style="color: #000000"> ((group_set </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OR</span><span style="color: #000000"> (group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">AND</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">=</span><span style="color: #A31515">&#39;FL&#39;</span><span style="color: #000000">)))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">, __stage1 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;elevation__1&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;row_count__1&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;row_count__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;data&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   ((</span><span style="color: #795E26">FLOOR</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">))*(</span><span style="color: #795E26">NULLIF</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">,</span><span style="color: #098658">0</span><span style="color: #000000">)))+(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">),</span><span style="color: #098658">0</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> LATERAL (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(base.</span><span style="color: #A31515">&quot;data&quot;</span><span style="color: #000000">), </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> ignoreme) </span><span style="color: #0000FF">as</span><span style="color: #000000"> data_0_outer(data_0,ignoreme) </span><span style="color: #0000FF">ON</span><span style="color: #000000"> data_0_outer.ignoreme=</span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h2>
        <a id="elevation-within-states" class="header-link anchor" href="#elevation-within-states">
          Elevation within states
        </a>
      </h2>
    <p>This binning even adapts when the queries are nested.</p>
<p>Notice that all the binning is local to the individual states.  For example the bottom bin in Colorado starts at an elevation of 3000ish feet.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/patterns/autobin.malloynb#C8" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">state</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">state</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">airport_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">by_elevation</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="e649eff3-4294-4041-80a4-033804b40776">
        <script>(()=>{var e=document.getElementById("e649eff3-4294-4041-80a4-033804b40776"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:["airports"],contents:{airports:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},queryList:[{type:"query",structRef:"airports",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"string",name:"state",e:{node:"field",path:["state"]},fieldUsage:[{path:["state"]}],expressionType:"scalar",code:"state"},{type:"fieldref",path:["airport_count"]},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:4,character:8},end:{line:4,character:20}}}},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{inherits:{blockNotes:[{text:"# bar_chart\n"}]}},fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["state"]},{path:["airport_count"]},{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"airport_count",dir:"desc"}]}],annotation:{notes:[],blockNotes:[{text:"#(docs) size=large\n"}]}}],dependencies:{},references:[{type:"exploreReference",text:"airports",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}}],parameters:{},as:"airports"}},{type:"fieldReference",definition:{type:"string",name:"state",fieldUsage:[{path:["state"]}]},text:"state"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"airport_count"},{type:"fieldReference",definition:{type:"turtle",name:"by_elevation",pipeline:[{type:"reduce",queryFields:[{type:"number",name:"bin_size",e:{node:"/",kids:{left:{node:"()",e:{node:"-",kids:{left:{node:"aggregate",function:"max",e:{node:"field",path:["elevation"]}},right:{node:"aggregate",function:"min",e:{node:"field",path:["elevation"]}}}}},right:{node:"numberLiteral",literal:"30"}}},fieldUsage:[{path:["elevation"]},{path:["elevation"]}],expressionType:"aggregate",code:"(max(elevation) - min(elevation)) / 30"},{type:"turtle",name:"data",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["elevation"],drillView:"data"},{type:"number",numberType:"integer",name:"row_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()",drillView:"data"}],filterList:[],fieldUsage:[{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"row_count",dir:"desc"}]}],annotation:{},fieldUsage:[{path:["elevation"]}]}],filterList:[],fieldUsage:[{path:["elevation"]},{path:["elevation"]},{path:["elevation"]}],defaultOrderBy:!0,orderBy:[{field:"bin_size",dir:"desc"}]},{type:"reduce",queryFields:[{type:"number",name:"elevation",e:{node:"+",kids:{left:{node:"*",kids:{left:{node:"function_call",overload:{returnType:{type:"number",expressionType:"scalar",evalSpace:"input"},params:[{name:"value",allowedTypes:[{type:"number",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value"}]},src:["FLOOR(",")"]}}}},name:"floor",kids:{args:[{node:"/",kids:{left:{node:"field",path:["data","elevation"]},right:{node:"field",path:["bin_size"]}}}]},expressionType:"scalar"},right:{node:"function_call",overload:{returnType:{type:"generic",generic:"T",expressionType:"scalar",evalSpace:"input"},params:[{name:"value1",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1},{name:"value2",allowedTypes:[{type:"generic",generic:"T",evalSpace:"input"}],isVariadic:!1}],dialect:{postgres:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},standardsql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},duckdb:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},snowflake:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},trino:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},presto:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}},mysql:{e:{node:"genericSQLExpr",kids:{args:[{node:"function_parameter",name:"value1"},{node:"function_parameter",name:"value2"}]},src:["NULLIF(",",",")"]}}},genericTypes:[{name:"T",acceptibleTypes:[{type:"string"},{type:"number"},{type:"timestamp"},{type:"date"},{type:"json"}]}]},name:"nullif",kids:{args:[{node:"field",path:["bin_size"]},{node:"numberLiteral",literal:"0"}]},expressionType:"scalar"}}},right:{node:"/",kids:{left:{node:"field",path:["bin_size"]},right:{node:"numberLiteral",literal:"2"}}}}},fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}],expressionType:"scalar",code:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2"},{type:"number",numberType:"integer",name:"airport_count",e:{node:"aggregate",function:"sum",e:{node:"field",path:["data","row_count"]},structPath:["data"]},fieldUsage:[],expressionType:"aggregate",code:"data.row_count.sum()"}],orderBy:[{field:"elevation"}],filterList:[],fieldUsage:[{path:["data","elevation"]},{path:["bin_size"]},{path:["bin_size"]},{path:["bin_size"]}]}],annotation:{blockNotes:[{text:"# bar_chart\n"}]}},text:"by_elevation"}],imports:[]},a.queryResult={lastStageName:"__stage2",malloy:"",sql:'WITH __stage0 AS (\n  SELECT\n    group_set,\n    base."state" as "state__0",\n    CASE WHEN group_set=0 THEN\n      COUNT(1)\n      END as "airport_count__0",\n    ((CASE WHEN group_set=1 THEN\n      max(base."elevation")\n      END-CASE WHEN group_set=1 THEN\n      min(base."elevation")\n      END))*1.0/30 as "bin_size__1",\n    CASE WHEN group_set=2 THEN\n      base."elevation"\n      END as "elevation__2",\n    CASE WHEN group_set=2 THEN\n      COUNT(1)\n      END as "row_count__2"\n  FROM \'../data/airports.parquet\' as base\n  CROSS JOIN (SELECT UNNEST(GENERATE_SERIES(0,2,1)) as group_set  ) as group_set\n  GROUP BY 1,2,5\n)\n, __stage1 AS (\n  SELECT \n    CASE WHEN group_set=2 THEN 1 ELSE group_set END as group_set,\n    "state__0" as "state__0",\n    FIRST("airport_count__0") FILTER (WHERE "airport_count__0" IS NOT NULL) as "airport_count__0",\n    FIRST("bin_size__1") FILTER (WHERE "bin_size__1" IS NOT NULL) as "bin_size__1",\n    COALESCE(LIST({\n      "elevation": "elevation__2", \n      "row_count": "row_count__2"}  ORDER BY  "row_count__2" desc NULLS LAST) FILTER (WHERE group_set=2),[]) as "data__1"\n  FROM __stage0\n  GROUP BY 1,2\n)\nSELECT\n  "state__0" as "state",\n  MAX(CASE WHEN group_set=0 THEN "airport_count__0" END) as "airport_count",\n  (WITH __stage0 AS (\n    SELECT \n       ((FLOOR(data_0."elevation"*1.0/base."bin_size"))*(NULLIF(base."bin_size",0)))+(base."bin_size"*1.0/2) as "elevation",\n       COALESCE(SUM(data_0."row_count"),0) as "airport_count"\n    FROM (SELECT UNNEST([COALESCE(FIRST({"bin_size": "bin_size__1" , "data": "data__1" }) FILTER(WHERE group_set=1), {"bin_size": NULL, "data": NULL})]) as base) as base\n    LEFT JOIN LATERAL (SELECT UNNEST(base."data"), 1 as ignoreme) as data_0_outer(data_0,ignoreme) ON data_0_outer.ignoreme=1\n    GROUP BY 1\n    ORDER BY 1 ASC NULLS LAST\n  )\n  SELECT LIST(STRUCT_PACK("elevation","airport_count") ORDER BY elevation asc) FROM __stage0\n  ) as "by_elevation"\nFROM __stage1\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage2",fields:[{name:"state",type:"string",resultMetadata:{sourceField:"state",sourceExpression:"state",sourceClasses:["state"],referenceId:"50812e7a-df54-4fdc-ad12-1f4738b53ce2",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:2,character:12},end:{line:2,character:26}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"count()",sourceClasses:["airport_count"],referenceId:"f90e1e83-a288-43c3-8c6a-a883f33ecd12",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:1,character:11},end:{line:1,character:35}}}},{type:"array",name:"by_elevation",fields:[{name:"elevation",type:"number",resultMetadata:{sourceField:"elevation",sourceExpression:"floor(data.elevation / bin_size) * nullif(bin_size, 0) + bin_size / 2",sourceClasses:["elevation"],referenceId:"d6a5af53-ff2e-4dec-aa71-bea6780fc403",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:10,character:14},end:{line:11,character:75}}}},{name:"airport_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"airport_count",sourceExpression:"data.row_count.sum()",sourceClasses:["airport_count"],referenceId:"0690eee9-0f89-4c22-a8dd-1b5a38d3d4d8",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:12,character:15},end:{line:12,character:52}}}}],dialect:"duckdb",primaryKey:"elevation",connection:"duckdb",resultMetadata:{sourceField:"by_elevation",filterList:[],sourceClasses:["by_elevation"],fieldKind:"struct",orderBy:[{field:"elevation"}],drillable:!1},annotation:{inherits:{blockNotes:[{text:"# bar_chart\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:2,character:2},end:{line:2,character:14}}}}]}},elementTypeDef:{type:"record_element"},join:"many"}],dialect:"duckdb",primaryKey:"state",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"airport_count",dir:"desc"}],drillable:!0}}],sourceExplore:"airports",sourceArguments:{},connectionName:"duckdb",annotation:{notes:[],blockNotes:[{text:"#(docs) size=large\n",at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/patterns/autobin.malloynb",range:{start:{line:0,character:0},end:{line:0,character:19}}}}]},result:[{state:"TX",airport_count:1845,by_elevation:[{elevation:83.26666666666667,airport_count:423},{elevation:249.8,airport_count:127},{elevation:416.3333333333333,airport_count:197},{elevation:582.8666666666667,airport_count:284},{elevation:749.4,airport_count:213},{elevation:915.9333333333333,airport_count:112},{elevation:1082.4666666666667,airport_count:68},{elevation:1249,airport_count:42},{elevation:1415.5333333333333,airport_count:49},{elevation:1582.0666666666666,airport_count:31},{elevation:1748.6,airport_count:42},{elevation:1915.1333333333332,airport_count:24},{elevation:2081.666666666667,airport_count:16},{elevation:2248.2000000000003,airport_count:18},{elevation:2414.7333333333336,airport_count:20},{elevation:2581.266666666667,airport_count:17},{elevation:2747.8,airport_count:16},{elevation:2914.3333333333335,airport_count:10},{elevation:3080.866666666667,airport_count:17},{elevation:3247.4,airport_count:25},{elevation:3413.9333333333334,airport_count:17},{elevation:3580.4666666666667,airport_count:22},{elevation:3747,airport_count:23},{elevation:3913.5333333333333,airport_count:12},{elevation:4080.066666666667,airport_count:4},{elevation:4246.599999999999,airport_count:2},{elevation:4413.133333333333,airport_count:4},{elevation:4579.666666666666,airport_count:6},{elevation:4746.2,airport_count:2},{elevation:4912.733333333333,airport_count:1},{elevation:5079.266666666666,airport_count:1}]},{state:"CA",airport_count:984,by_elevation:[{elevation:-122.3,airport_count:10},{elevation:122.3,airport_count:346},{elevation:366.9,airport_count:169},{elevation:611.5,airport_count:73},{elevation:856.0999999999999,airport_count:57},{elevation:1100.7,airport_count:44},{elevation:1345.3,airport_count:37},{elevation:1589.8999999999999,airport_count:26},{elevation:1834.5,airport_count:16},{elevation:2079.1,airport_count:13},{elevation:2323.7000000000003,airport_count:31},{elevation:2568.3,airport_count:32},{elevation:2812.9,airport_count:23},{elevation:3057.5,airport_count:17},{elevation:3302.1,airport_count:15},{elevation:3546.7000000000003,airport_count:7},{elevation:3791.3,airport_count:8},{elevation:4035.9,airport_count:10},{elevation:4280.5,airport_count:8},{elevation:4525.1,airport_count:9},{elevation:5014.3,airport_count:7},{elevation:5258.9,airport_count:4},{elevation:5503.5,airport_count:1},{elevation:5748.1,airport_count:4},{elevation:5992.7,airport_count:1},{elevation:6237.3,airport_count:4},{elevation:6481.9,airport_count:3},{elevation:6726.5,airport_count:6},{elevation:6971.1,airport_count:2},{elevation:7215.7,airport_count:1}]},{state:"IL",airport_count:890,by_elevation:[{elevation:310,airport_count:1},{elevation:334.8,airport_count:5},{elevation:359.59999999999997,airport_count:4},{elevation:384.4,airport_count:5},{elevation:409.2,airport_count:15},{elevation:434,airport_count:26},{elevation:458.8,airport_count:30},{elevation:483.59999999999997,airport_count:14},{elevation:508.4,airport_count:17},{elevation:533.2,airport_count:22},{elevation:558,airport_count:22},{elevation:582.8,airport_count:47},{elevation:607.6,airport_count:52},{elevation:632.4,airport_count:79},{elevation:657.2,airport_count:90},{elevation:682,airport_count:67},{elevation:706.8,airport_count:69},{elevation:731.6,airport_count:71},{elevation:756.4,airport_count:50},{elevation:781.2,airport_count:46},{elevation:806,airport_count:41},{elevation:830.8,airport_count:26},{elevation:855.6,airport_count:27},{elevation:880.4,airport_count:20},{elevation:905.2,airport_count:17},{elevation:930,airport_count:9},{elevation:954.8,airport_count:8},{elevation:979.6,airport_count:7},{elevation:1004.4,airport_count:1},{elevation:1054.0000000000002,airport_count:2}]},{state:"FL",airport_count:856,by_elevation:[{elevation:5.566666666666666,airport_count:137},{elevation:16.7,airport_count:134},{elevation:27.833333333333332,airport_count:87},{elevation:38.96666666666667,airport_count:40},{elevation:50.099999999999994,airport_count:55},{elevation:61.233333333333334,airport_count:45},{elevation:72.36666666666666,airport_count:50},{elevation:83.5,airport_count:46},{elevation:94.63333333333333,airport_count:57},{elevation:105.76666666666665,airport_count:31},{elevation:116.89999999999999,airport_count:32},{elevation:128.03333333333333,airport_count:25},{elevation:139.16666666666666,airport_count:16},{elevation:150.29999999999998,airport_count:27},{elevation:161.43333333333334,airport_count:13},{elevation:172.56666666666666,airport_count:6},{elevation:183.7,airport_count:5},{elevation:194.83333333333331,airport_count:14},{elevation:205.96666666666664,airport_count:4},{elevation:217.1,airport_count:6},{elevation:228.23333333333332,airport_count:3},{elevation:239.36666666666665,airport_count:4},{elevation:250.5,airport_count:6},{elevation:261.6333333333333,airport_count:3},{elevation:272.76666666666665,airport_count:2},{elevation:283.9,airport_count:3},{elevation:295.0333333333333,airport_count:3},{elevation:328.43333333333334,airport_count:1},{elevation:339.56666666666666,airport_count:1}]},{state:"PA",airport_count:804,by_elevation:[{elevation:75.01666666666667,airport_count:28},{elevation:225.05,airport_count:53},{elevation:375.0833333333333,airport_count:106},{elevation:525.1166666666667,airport_count:147},{elevation:675.15,airport_count:67},{elevation:825.1833333333333,airport_count:46},{elevation:975.2166666666667,airport_count:51},{elevation:1125.25,airport_count:85},{elevation:1275.2833333333333,airport_count:80},{elevation:1425.3166666666666,airport_count:45},{elevation:1575.35,airport_count:27},{elevation:1725.3833333333332,airport_count:25},{elevation:1875.4166666666667,airport_count:11},{elevation:2025.45,airport_count:16},{elevation:2175.4833333333336,airport_count:5},{elevation:2325.516666666667,airport_count:8},{elevation:2475.55,airport_count:2},{elevation:2925.65,airport_count:1},{elevation:4576.016666666666,airport_count:1}]}],totalRows:5},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TX&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1845</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_elevation&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">83.26666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">423</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">249.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">127</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">416.3333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">197</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">582.8666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">284</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">749.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">213</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">915.9333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">112</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1082.4666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">68</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1249</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">42</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1415.5333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1582.0666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1748.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">42</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1915.1333333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">24</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2081.666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2248.2000000000003</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2414.7333333333336</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2581.266666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2747.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2914.3333333333335</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3080.866666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3247.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">25</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3413.9333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3580.4666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">22</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3747</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3913.5333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4080.066666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4246.599999999999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4413.133333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4579.666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4746.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4912.733333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5079.266666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">984</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_elevation&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-122.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">122.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">346</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">366.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">169</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">611.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">73</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">856.0999999999999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">57</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1100.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">44</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1345.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">37</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1589.8999999999999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1834.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2079.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2323.7000000000003</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2568.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2812.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">23</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3057.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3302.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3546.7000000000003</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3791.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4035.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4280.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4525.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5014.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5258.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5503.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5748.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5992.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6237.3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6481.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6726.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6971.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7215.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;IL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">890</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_elevation&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">310</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">334.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">359.59999999999997</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">384.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">409.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">434</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">458.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">483.59999999999997</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">508.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">533.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">22</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">558</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">22</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">582.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">607.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">52</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">632.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">79</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">657.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">90</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">682</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">67</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">706.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">69</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">731.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">71</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">756.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">50</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">781.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">46</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">806</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">41</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">830.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">855.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">880.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">905.2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">930</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">954.8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">979.6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1004.4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1054.0000000000002</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;FL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">856</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_elevation&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5.566666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">137</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">134</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27.833333333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">87</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">38.96666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">40</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">50.099999999999994</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">61.233333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">72.36666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">50</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">83.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">46</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">94.63333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">57</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">105.76666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">116.89999999999999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">128.03333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">25</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">139.16666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">150.29999999999998</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">161.43333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">172.56666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">183.7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">194.83333333333331</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">205.96666666666664</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">217.1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">228.23333333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">239.36666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">250.5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">261.6333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">272.76666666666665</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">283.9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">295.0333333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">328.43333333333334</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">339.56666666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;state&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">804</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;by_elevation&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">75.01666666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">28</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">225.05</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">53</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">375.0833333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">106</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">525.1166666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">147</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">675.15</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">67</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">825.1833333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">46</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">975.2166666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">51</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1125.25</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">85</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1275.2833333333333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">80</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1425.3166666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1575.35</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1725.3833333333332</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">25</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1875.4166666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2025.45</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2175.4833333333336</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2325.516666666667</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2475.55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2925.65</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4576.016666666666</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;airport_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    base.</span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    ((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">max</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">-</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">min</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">30</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      base.</span><span style="color: #A31515">&quot;elevation&quot;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation__2&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;row_count__2&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(GENERATE_SERIES(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">, __stage1 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> group_set </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> group_set,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FIRST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;bin_size__1&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__1&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">IS</span><span style="color: #000000"> </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">NULL</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bin_size__1&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(LIST({</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;elevation__2&quot;</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;row_count__2&quot;</span><span style="color: #000000">}  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  </span><span style="color: #A31515">&quot;row_count__2&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">) </span><span style="color: #0000FF">FILTER</span><span style="color: #000000"> (</span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> group_set=</span><span style="color: #098658">2</span><span style="color: #000000">),[]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;data__1&quot;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&quot;state__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;state&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">MAX</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count__0&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  (</span><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">       ((</span><span style="color: #795E26">FLOOR</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">))*(</span><span style="color: #795E26">NULLIF</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">,</span><span style="color: #098658">0</span><span style="color: #000000">)))+(base.</span><span style="color: #A31515">&quot;bin_size&quot;</span><span style="color: #000000">*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/</span><span style="color: #098658">2</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">       </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(data_0.</span><span style="color: #A31515">&quot;row_count&quot;</span><span style="color: #000000">),</span><span style="color: #098658">0</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;airport_count&quot;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST([COALESCE(FIRST({&quot;bin_size&quot;: &quot;bin_size__1&quot; , &quot;data&quot;: &quot;data__1&quot; }) FILTER(WHERE group_set=1), {&quot;bin_size&quot;: NULL, &quot;data&quot;: NULL})]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> base) </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> LATERAL (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> UNNEST(base.</span><span style="color: #A31515">&quot;data&quot;</span><span style="color: #000000">), </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> ignoreme) </span><span style="color: #0000FF">as</span><span style="color: #000000"> data_0_outer(data_0,ignoreme) </span><span style="color: #0000FF">ON</span><span style="color: #000000"> data_0_outer.ignoreme=</span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #000000">  )</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> LIST(STRUCT_PACK(</span><span style="color: #A31515">&quot;elevation&quot;</span><span style="color: #000000">,</span><span style="color: #A31515">&quot;airport_count&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> elevation </span><span style="color: #0000FF">asc</span><span style="color: #000000">) </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #000000">  ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;by_elevation&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage1</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div></div></div>
        </div>
        <script src="/js/view_toggles.js"></script>
        <script src="/js/jump_to_hash.js"></script>
      </div>
    </div>
    <div id="banner_wrapper">
      <div id="banner">
        <div>
          This site uses cookies from Google to deliver its services and to analyze
          traffic.
          <a
            href="https://policies.google.com/technologies/cookies"
            target="_blank"
          >
            Learn more
          </a>
        </div>
        <button id="banner_button">I Understand</button>
      </div>
    </div>
    <script src="/js/banner.js"></script>
    <script src="/js/generated/malloy-render-0.0.282.js"></script>
  </body>
</html>
