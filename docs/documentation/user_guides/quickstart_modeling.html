<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Building a Semantic Model | Malloy Documentation</title>
    <link rel="stylesheet" href="/css/document.css" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/img/favicon.ico"
    />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-0M10W7C20Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
    
      gtag("config", "G-0M10W7C20Y");
    </script>
    <style>
      malloy-render::part(table-container) {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="top">
      <div class="header">
        <div class="header-banner">
          <a href="http://www.malloydata.dev" target="_blank">
            <img
              class="logo"
              src="/img/logo.png"
              alt="malloy logo"
            />
          </a>

          Malloy
          <span class="subtitle">Documentation</span>
        </div>
        <div class="header-right">
          <div class="header-links">
            <a href="https://github.com/malloydata/malloy" target="_blank"
              ><img
                src="/img/github.svg"
                style="transform: scale(0.5)"
            /></a>
            <a href="/slack" target="_blank"
              ><img src="/img/slack.svg"
            /></a>
          </div>
          <form onSubmit="() => alert('submit')" action="/search">
            <div class="search-input-outer">
              <img src="/img/search.svg" alt="search" />
              <input placeholder="Search" id="search-input" name="query" />
            </div>
            <input type="submit" style="display: none" />
          </form>
        </div>
      </div>
      <div class="main">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
              <div id=about_malloy
                class="sidebar-section-title {% unless /documentation/index.html,/documentation/about/features.html,/documentation/about/tao.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                About Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation">
                <img src="/img/article_icon.svg" alt="document"/>
                What Is Malloy
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/features">
                <img src="/img/article_icon.svg" alt="document"/>
                Key Features
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/about/tao">
                <img src="/img/article_icon.svg" alt="document"/>
                The Tao of Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=setting_up malloy
                class="sidebar-section-title {% unless /documentation/setup/extension.html,/documentation/setup/database_support.html,/documentation/setup/config.html,/documentation/setup/cli.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Setting up Malloy
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/setup/extension">
                <img src="/img/article_icon.svg" alt="document"/>
                VS Code Extension
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/database_support">
                <img src="/img/article_icon.svg" alt="document"/>
                Database Support
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/config">
                <img src="/img/article_icon.svg" alt="document"/>
                Configuration
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/setup/cli">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=user_guides
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/quickstart_modeling.html,/documentation/user_guides/malloy_by_example.html,/documentation/user_guides/notebooks.html,/documentation/user_guides/publishing/explorer.html,/documentation/user_guides/publishing/publishing.html,/documentation/user_guides/publishing/connections.html,/documentation/user_guides/publishing/rest_api.html,/documentation/user_guides/publishing/publisher_sdk.html,/documentation/user_guides/publishing/mcp_agents.html,/documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html,/documentation/user_guides/transform.html,/documentation/user_guides/malloy_for_dbt.html,/documentation/user_guides/troubleshooting.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                User Guides
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class="sidebar-section">
              <div id=getting_started
                class="sidebar-section-title {% unless /documentation/user_guides/querying_a_model.html,/documentation/user_guides/quickstart_modeling.html,/documentation/user_guides/malloy_by_example.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Getting Started
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/querying_a_model">
                <img src="/img/article_icon.svg" alt="document"/>
                Querying a Semantic Model
              </a>
            </div>
        <div class='sidebar-item active'>
              <a href="/documentation/user_guides/quickstart_modeling">
                <img src="/img/article_icon.svg" alt="document"/>
                Building a Semantic Model
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_by_example">
                <img src="/img/article_icon.svg" alt="document"/>
                Advanced Modeling
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=analyzing_& exploring
                class="sidebar-section-title {% unless /documentation/user_guides/notebooks.html,/documentation/user_guides/publishing/explorer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Analyzing & Exploring
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/notebooks">
                <img src="/img/article_icon.svg" alt="document"/>
                Analyzing with Notebooks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/explorer">
                <img src="/img/article_icon.svg" alt="document"/>
                Explorer UI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=publishing
                class="sidebar-section-title {% unless /documentation/user_guides/publishing/publishing.html,/documentation/user_guides/publishing/connections.html,/documentation/user_guides/publishing/rest_api.html,/documentation/user_guides/publishing/publisher_sdk.html,/documentation/user_guides/publishing/mcp_agents.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Publishing
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/publishing">
                <img src="/img/article_icon.svg" alt="document"/>
                Publish Your Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Publisher Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/rest_api">
                <img src="/img/article_icon.svg" alt="document"/>
                REST API
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/publisher_sdk">
                <img src="/img/article_icon.svg" alt="document"/>
                Publisher SDK (React)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/publishing/mcp_agents">
                <img src="/img/article_icon.svg" alt="document"/>
                MCP for AI Agents
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=for_sql users
                class="sidebar-section-title {% unless /documentation/user_guides/sql_experts1.html,/documentation/user_guides/sql_experts2.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                For SQL Users
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts1">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for SQL Folks
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/sql_experts2">
                <img src="/img/article_icon.svg" alt="document"/>
                Refactoring SQL to Malloy
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=data_transformation
                class="sidebar-section-title {% unless /documentation/user_guides/transform.html,/documentation/user_guides/malloy_for_dbt.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Data Transformation
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/user_guides/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform & Materialize
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/malloy_for_dbt">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy for dbt Users
              </a>
            </div>
              </div>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/user_guides/troubleshooting">
                <img src="/img/article_icon.svg" alt="document"/>
                Troubleshooting
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=language_reference
                class="sidebar-section-title {% unless /documentation/language/statement.html,/documentation/language/source.html,/documentation/language/query.html,/documentation/language/views.html,/documentation/language/datatypes.html,/documentation/language/fields.html,/documentation/language/aggregates.html,/documentation/language/expressions.html,/documentation/language/functions.html,/documentation/language/filters.html,/documentation/language/calculations_windows.html,/documentation/language/order_by.html,/documentation/language/join.html,/documentation/language/nesting.html,/documentation/language/sql_sources.html,/documentation/language/imports.html,/documentation/language/connections.html,/documentation/language/tags.html,/documentation/language/quick_reference.html,/documentation/language/changelog.html,/documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html,/documentation/language/dialect/mssql-via-duckdb.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Language Reference
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/statement">
                <img src="/img/article_icon.svg" alt="document"/>
                Models
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/source">
                <img src="/img/article_icon.svg" alt="document"/>
                Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/query">
                <img src="/img/article_icon.svg" alt="document"/>
                Queries
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/views">
                <img src="/img/article_icon.svg" alt="document"/>
                Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/datatypes">
                <img src="/img/article_icon.svg" alt="document"/>
                Data Types
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/fields">
                <img src="/img/article_icon.svg" alt="document"/>
                Fields
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/aggregates">
                <img src="/img/article_icon.svg" alt="document"/>
                Aggregates
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/functions">
                <img src="/img/article_icon.svg" alt="document"/>
                Functions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/filters">
                <img src="/img/article_icon.svg" alt="document"/>
                Filters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/calculations_windows">
                <img src="/img/article_icon.svg" alt="document"/>
                Calculations (window functions)
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/order_by">
                <img src="/img/article_icon.svg" alt="document"/>
                Ordering and Limiting
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/join">
                <img src="/img/article_icon.svg" alt="document"/>
                Joins
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/nesting">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Views
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/sql_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/imports">
                <img src="/img/article_icon.svg" alt="document"/>
                Imports
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/connections">
                <img src="/img/article_icon.svg" alt="document"/>
                Connections
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/tags">
                <img src="/img/article_icon.svg" alt="document"/>
                Tags
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/quick_reference.html">
                <img src="/img/article_icon.svg" alt="document"/>
                Quick Reference
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/changelog">
                <img src="/img/article_icon.svg" alt="document"/>
                Change Log
              </a>
            </div>
        <div class="sidebar-section">
              <div id=dialects
                class="sidebar-section-title {% unless /documentation/language/dialect/bigquery.html,/documentation/language/dialect/presto-trino.html,/documentation/language/dialect/snowflake.html,/documentation/language/dialect/mysql.html,/documentation/language/dialect/duckdb.html,/documentation/language/dialect/postgres.html,/documentation/language/dialect/mssql-via-duckdb.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Dialects
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/language/dialect/bigquery">
                <img src="/img/article_icon.svg" alt="document"/>
                BigQuery
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/presto-trino">
                <img src="/img/article_icon.svg" alt="document"/>
                Presto / Trino
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/snowflake">
                <img src="/img/article_icon.svg" alt="document"/>
                Snowflake
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mysql">
                <img src="/img/article_icon.svg" alt="document"/>
                MySQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                DuckDB
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/postgres">
                <img src="/img/article_icon.svg" alt="document"/>
                PostgreSQL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/language/dialect/mssql-via-duckdb">
                <img src="/img/article_icon.svg" alt="document"/>
                MSSQL via DuckDB
              </a>
            </div>
              </div>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=common_patterns
                class="sidebar-section-title {% unless /documentation/patterns/yoy.html,/documentation/patterns/foreign_sums.html,/documentation/patterns/reading_nested.html,/documentation/patterns/percent_of_total.html,/documentation/patterns/cohorts.html,/documentation/patterns/nested_subtotals.html,/documentation/patterns/other.html,/documentation/patterns/autobin.html,/documentation/patterns/moving_avg.html,/documentation/patterns/transform.html,/documentation/patterns/sessionize.html,/documentation/patterns/dim_index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Common Patterns
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/patterns/yoy">
                <img src="/img/article_icon.svg" alt="document"/>
                Comparing Timeframes
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/foreign_sums">
                <img src="/img/article_icon.svg" alt="document"/>
                Foreign Sums and Averages
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/reading_nested">
                <img src="/img/article_icon.svg" alt="document"/>
                Reading Nested Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/percent_of_total">
                <img src="/img/article_icon.svg" alt="document"/>
                Percent of Total
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/cohorts">
                <img src="/img/article_icon.svg" alt="document"/>
                Cohort Analysis
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/nested_subtotals">
                <img src="/img/article_icon.svg" alt="document"/>
                Nested Subtotals
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/other">
                <img src="/img/article_icon.svg" alt="document"/>
                Bucketing with 'Other'
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/autobin">
                <img src="/img/article_icon.svg" alt="document"/>
                Auto-binning Histograms
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/moving_avg">
                <img src="/img/article_icon.svg" alt="document"/>
                Moving Average
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/transform">
                <img src="/img/article_icon.svg" alt="document"/>
                Transform Data
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/sessionize">
                <img src="/img/article_icon.svg" alt="document"/>
                Sessionize - Map/Reduce
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/patterns/dim_index">
                <img src="/img/article_icon.svg" alt="document"/>
                Dimensional Indexes
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_results
                class="sidebar-section-title {% unless /documentation/visualizations/about_rendering.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Results
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/about_rendering">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=rendering_legacy docs
                class="sidebar-section-title {% unless /documentation/visualizations/overview.html,/documentation/visualizations/numbers.html,/documentation/visualizations/links.html,/documentation/visualizations/pivots.html,/documentation/visualizations/transpose.html,/documentation/visualizations/dashboards.html,/documentation/visualizations/lists.html,/documentation/visualizations/bar_charts.html,/documentation/visualizations/charts_line_chart.html,/documentation/visualizations/scatter_charts.html,/documentation/visualizations/shape_maps.html,/documentation/visualizations/segment_maps.html,/documentation/visualizations/legacy_renderer.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Rendering Legacy Docs
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/visualizations/overview">
                <img src="/img/article_icon.svg" alt="document"/>
                Overview
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/numbers">
                <img src="/img/article_icon.svg" alt="document"/>
                Numbers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/links">
                <img src="/img/article_icon.svg" alt="document"/>
                Links
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/pivots">
                <img src="/img/article_icon.svg" alt="document"/>
                Pivoted Tables
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/transpose">
                <img src="/img/article_icon.svg" alt="document"/>
                Table Transpose
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/dashboards">
                <img src="/img/article_icon.svg" alt="document"/>
                Dashboards
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/lists">
                <img src="/img/article_icon.svg" alt="document"/>
                Lists
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/bar_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Bar Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/charts_line_chart">
                <img src="/img/article_icon.svg" alt="document"/>
                Line Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/scatter_charts">
                <img src="/img/article_icon.svg" alt="document"/>
                Scatter Charts
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/shape_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Shape Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/segment_maps">
                <img src="/img/article_icon.svg" alt="document"/>
                Segment Maps
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/visualizations/legacy_renderer">
                <img src="/img/article_icon.svg" alt="document"/>
                Legacy Renderer
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloysql
                class="sidebar-section-title {% unless /documentation/malloy_sql/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                MalloySQL
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_sql/index">
                <img src="/img/article_icon.svg" alt="document"/>
                Using MalloySQL
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_cli
                class="sidebar-section-title {% unless /documentation/malloy_cli/index.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy CLI
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_cli/index">
                <img src="/img/article_icon.svg" alt="document"/>
                The Malloy CLI
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=malloy_with python
                class="sidebar-section-title {% unless /documentation/malloy_python/python_package.html,/documentation/malloy_python/jupyter.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Malloy with Python
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/malloy_python/python_package">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy Python Package
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/malloy_python/jupyter">
                <img src="/img/article_icon.svg" alt="document"/>
                Malloy in Jupyter Notebooks
              </a>
            </div>
              </div>
            </div>
        <div class="sidebar-section">
              <div id=experiments_(in process features)
                class="sidebar-section-title {% unless /documentation/experiments/experiments.html,/documentation/experiments/joins.html,/documentation/experiments/sql_expressions.html,/documentation/experiments/window.html,/documentation/experiments/parameters.html,/documentation/experiments/composite_sources.html,/documentation/experiments/include.html,/documentation/experiments/persistence.html contains page.url)} %}collapsed-this-isnt-working-its-always-collapsed-ben-took-it-out{% endunless %}"
              >
                Experiments (in process features)
                <img class="chevron-open" src="/img/section_open.svg" alt="section open"/>
                <img class="chevron-closed" src="/img/section_close.svg" alt="section closed"/>
              </div>
              <div class="sidebar-section-item-group">
                <div class='sidebar-item '>
              <a href="/documentation/experiments/experiments">
                <img src="/img/article_icon.svg" alt="document"/>
                Experiments
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/joins">
                <img src="/img/article_icon.svg" alt="document"/>
                Join INNER/RIGHT/FULL
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/sql_expressions">
                <img src="/img/article_icon.svg" alt="document"/>
                SQL Expressions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/window">
                <img src="/img/article_icon.svg" alt="document"/>
                Window Partitions
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/parameters">
                <img src="/img/article_icon.svg" alt="document"/>
                Parameters
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/composite_sources">
                <img src="/img/article_icon.svg" alt="document"/>
                Composite "Cube" Sources
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/include">
                <img src="/img/article_icon.svg" alt="document"/>
                Access Modifiers
              </a>
            </div>
        <div class='sidebar-item '>
              <a href="/documentation/experiments/persistence">
                <img src="/img/article_icon.svg" alt="document"/>
                Persistence
              </a>
            </div>
              </div>
            </div>
          </div>        <script src="/js/sidebar_state.js"></script>
        <div class="content">
          <div class="footer">
            
<div class="linear-navigation">
  <div class="item">
      <a href="querying_a_model.html"><img src="/img/previous.svg" alt="previous"/>Querying a Semantic Model</a>
  </div>
  <div class="item">
      <a href="malloy_by_example.html">Advanced Modeling<img src="/img/next.svg" alt="next"/></a>
  </div>
</div> 
          </div>
          <div class="document-outer"><div class="document"><div class="title-row">
        
      <h1>
        <a id="building-a-semantic-model" class="header-link anchor" href="#building-a-semantic-model">
          Building a Semantic Model
        </a>
      </h1>
    
        <a class="edit-link" target="_blank" href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C1">VSCode <img src="/img/open_notebook.svg" alt="document"/></a>
        </div>
      <p>A semantic model is the interface to your data—it defines what a "customer" is, how "revenue" is calculated, which tables relate to each other. Instead of scattering this logic across SQL queries, you define it once and reuse it everywhere.</p>
<p>In the previous page, <a href="querying_a_model">Querying a Semantic Model</a>, we learned how to query an existing model. Now we'll learn how to build one.</p>
<hr/>

      <h2>
        <a id="1-define-your-sources" class="header-link anchor" href="#1-define-your-sources">
          1. Define Your Sources
        </a>
      </h2>
    <p>A source is a table plus metadata. Start with just the table:</p>
<div class="code-wrapper"><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {}</span></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">airports</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {}</span></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">carriers</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {}</span></span></pre></div><p>That's it. You now have sources you can query.</p>
<p>The example above uses DuckDB with local files. To connect to other databases (Postgres, BigQuery, Snowflake, etc.), see <a href="../setup/database_support">Database Support</a>.</p>
<hr/>

      <h2>
        <a id="2-explore-with-vs-code" class="header-link anchor" href="#2-explore-with-vs-code">
          2. Explore with VS Code
        </a>
      </h2>
    <p>Before writing any model code, use the VS Code extension to understand your data.</p>

      <h3>
        <a id="schema-view" class="header-link anchor" href="#schema-view">
          Schema View
        </a>
      </h3>
    <p>Click <strong>Schema</strong> in the sidebar to see:</p>
<ul>
<li><p>All columns and their types</p>
</li>
<li><p>Sample values</p>
</li>
<li><p>What you're working with</p>
</li></ul>
<p>Once you've defined a source, you can also open <strong>Explorer</strong> (the visual query builder) directly in VS Code—click the source name and select <strong>Explore</strong> from the menu.</p>

      <h3>
        <a id="preview-data" class="header-link anchor" href="#preview-data">
          Preview Data
        </a>
      </h3>
    <p>You can also click <strong>Preview</strong> just above the <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">:</span></span></code> definition in VS Code. This runs a quick select on the top 20 rows from the source. Or in code:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C2" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) -&gt; { </span><span style="color: #AF00DB">select</span><span style="color: #000000">: * </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000"> }</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="e50380ae-2ff8-4fb8-bcf6-8d91ec21608f">
        <script>(()=>{var e=document.getElementById("e50380ae-2ff8-4fb8-bcf6-8d91ec21608f"),a=document.createElement("malloy-render");a.modelDef={name:"",exports:[],contents:{},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]}]},pipeline:[{type:"project",queryFields:[{type:"fieldref",path:["arr_delay"]},{type:"fieldref",path:["arr_time"]},{type:"fieldref",path:["cancelled"]},{type:"fieldref",path:["carrier"]},{type:"fieldref",path:["dep_delay"]},{type:"fieldref",path:["dep_time"]},{type:"fieldref",path:["destination"]},{type:"fieldref",path:["distance"]},{type:"fieldref",path:["diverted"]},{type:"fieldref",path:["flight_num"]},{type:"fieldref",path:["flight_time"]},{type:"fieldref",path:["id2"]},{type:"fieldref",path:["origin"]},{type:"fieldref",path:["tail_num"]},{type:"fieldref",path:["taxi_in"]},{type:"fieldref",path:["taxi_out"]}],limit:5,filterList:[],fieldUsage:[{path:["arr_delay"]},{path:["arr_time"]},{path:["cancelled"]},{path:["carrier"]},{path:["dep_delay"]},{path:["dep_time"]},{path:["destination"]},{path:["distance"]},{path:["diverted"]},{path:["flight_num"]},{path:["flight_time"]},{path:["id2"]},{path:["origin"]},{path:["tail_num"]},{path:["taxi_in"]},{path:["taxi_out"]}]}]}],dependencies:{},references:[],imports:[]},a.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   base."arr_delay" as "arr_delay",\n   base."arr_time" as "arr_time",\n   base."cancelled" as "cancelled",\n   base."carrier" as "carrier",\n   base."dep_delay" as "dep_delay",\n   base."dep_time" as "dep_time",\n   base."destination" as "destination",\n   base."distance" as "distance",\n   base."diverted" as "diverted",\n   base."flight_num" as "flight_num",\n   base."flight_time" as "flight_time",\n   base."id2" as "id2",\n   base."origin" as "origin",\n   base."tail_num" as "tail_num",\n   base."taxi_in" as "taxi_in",\n   base."taxi_out" as "taxi_out"\nFROM \'../data/flights.parquet\' as base\nLIMIT 5\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"arr_delay",numberType:"integer",type:"number",resultMetadata:{sourceField:"arr_delay",sourceClasses:["arr_delay"],referenceId:"5dd25e3c-cee2-48c7-a5cc-5e72603183d5",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"arr_time",type:"timestamp",resultMetadata:{sourceField:"arr_time",sourceClasses:["arr_time"],referenceId:"d4238951-61e0-4772-9528-3f8a760f6d23",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"cancelled",type:"string",resultMetadata:{sourceField:"cancelled",sourceClasses:["cancelled"],referenceId:"3cb48080-e6d7-479b-bd70-ce231c214f7c",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"carrier",type:"string",resultMetadata:{sourceField:"carrier",sourceClasses:["carrier"],referenceId:"7c1db41c-2b01-45df-a921-85e9080788ae",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"dep_delay",numberType:"integer",type:"number",resultMetadata:{sourceField:"dep_delay",sourceClasses:["dep_delay"],referenceId:"756a2aae-d4be-4ccd-bc40-ca68e9bc1ce7",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"dep_time",type:"timestamp",resultMetadata:{sourceField:"dep_time",sourceClasses:["dep_time"],referenceId:"9c3558b4-6e7a-41da-9f5b-353d1a0b5406",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"destination",type:"string",resultMetadata:{sourceField:"destination",sourceClasses:["destination"],referenceId:"d5431e35-7c96-4ab5-ab71-6eb84d4ab1d6",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"distance",sourceClasses:["distance"],referenceId:"0d958229-8749-4c4d-943b-9741b95e5517",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"diverted",type:"string",resultMetadata:{sourceField:"diverted",sourceClasses:["diverted"],referenceId:"d1d91284-a3f6-4cea-b49f-55671c0eb1ff",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"flight_num",type:"string",resultMetadata:{sourceField:"flight_num",sourceClasses:["flight_num"],referenceId:"5cd4cd3c-9b81-4043-959d-17365319571e",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"flight_time",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_time",sourceClasses:["flight_time"],referenceId:"e90dc72d-380c-4181-bbd8-339c31f9e4db",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"id2",numberType:"integer",type:"number",resultMetadata:{sourceField:"id2",sourceClasses:["id2"],referenceId:"b79e0c67-7427-445a-82cb-5c501e9e3985",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"origin",type:"string",resultMetadata:{sourceField:"origin",sourceClasses:["origin"],referenceId:"bb5338d1-a70f-4ad2-9319-58a7f8c7cb1d",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"tail_num",type:"string",resultMetadata:{sourceField:"tail_num",sourceClasses:["tail_num"],referenceId:"0177db5f-7546-455f-b069-2d86dd2fd6b0",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"taxi_in",numberType:"integer",type:"number",resultMetadata:{sourceField:"taxi_in",sourceClasses:["taxi_in"],referenceId:"9fbc03a1-d04b-48a9-bd30-42a0e8412235",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"taxi_out",numberType:"integer",type:"number",resultMetadata:{sourceField:"taxi_out",sourceClasses:["taxi_out"],referenceId:"2c2a8a5b-89ea-43a3-bd39-8789079b0f5a",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:5,drillable:!0}}],sourceExplore:"duckdb:../data/flights.parquet",connectionName:"duckdb",result:[{arr_delay:-6,arr_time:"2004-11-18T23:09:00.000Z",cancelled:"N",carrier:"US",dep_delay:-3,dep_time:"2004-11-18T22:32:00.000Z",destination:"ABE",distance:55,diverted:"N",flight_num:"1692",flight_time:15,id2:30272525,origin:"PHL",tail_num:"N806MD",taxi_in:4,taxi_out:18},{arr_delay:0,arr_time:"2004-10-12T21:28:00.000Z",cancelled:"N",carrier:"US",dep_delay:6,dep_time:"2004-10-12T20:46:00.000Z",destination:"ABE",distance:55,diverted:"N",flight_num:"1650",flight_time:18,id2:29742442,origin:"PHL",tail_num:"N806MD",taxi_in:4,taxi_out:20},{arr_delay:2,arr_time:"2004-11-24T11:14:00.000Z",cancelled:"N",carrier:"US",dep_delay:0,dep_time:"2004-11-24T10:20:00.000Z",destination:"ABE",distance:55,diverted:"N",flight_num:"1616",flight_time:19,id2:30270885,origin:"PHL",tail_num:"N816MA",taxi_in:5,taxi_out:30},{arr_delay:-19,arr_time:"2004-08-31T21:06:00.000Z",cancelled:"N",carrier:"US",dep_delay:0,dep_time:"2004-08-31T20:30:00.000Z",destination:"ABE",distance:55,diverted:"N",flight_num:"1650",flight_time:17,id2:28344746,origin:"PHL",tail_num:"N806MD",taxi_in:4,taxi_out:15},{arr_delay:-19,arr_time:"2004-07-27T10:59:00.000Z",cancelled:"N",carrier:"US",dep_delay:-4,dep_time:"2004-07-27T10:21:00.000Z",destination:"ABE",distance:55,diverted:"N",flight_num:"1643",flight_time:17,id2:27898410,origin:"PHL",tail_num:"N806MD",taxi_in:4,taxi_out:17}],totalRows:5},e.appendChild(a)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-11-18T23:09:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;cancelled&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-11-18T22:32:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;destination&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;diverted&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;1692&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;id2&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30272525</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;tail_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N806MD&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_in&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_out&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-10-12T21:28:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;cancelled&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-10-12T20:46:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;destination&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;diverted&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;1650&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">18</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;id2&quot;</span><span style="color: #000000">: </span><span style="color: #098658">29742442</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;tail_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N806MD&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_in&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_out&quot;</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-11-24T11:14:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;cancelled&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-11-24T10:20:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;destination&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;diverted&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;1616&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">19</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;id2&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30270885</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;tail_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N816MA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_in&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_out&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-19</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-08-31T21:06:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;cancelled&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-08-31T20:30:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;destination&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;diverted&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;1650&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;id2&quot;</span><span style="color: #000000">: </span><span style="color: #098658">28344746</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;tail_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N806MD&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_in&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_out&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-19</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;arr_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-07-27T10:59:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;cancelled&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_delay&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dep_time&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-07-27T10:21:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;destination&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;ABE&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;diverted&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;1643&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;id2&quot;</span><span style="color: #000000">: </span><span style="color: #098658">27898410</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;PHL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;tail_num&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;N806MD&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_in&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;taxi_out&quot;</span><span style="color: #000000">: </span><span style="color: #098658">17</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;arr_delay&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;arr_delay&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;arr_time&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;arr_time&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;cancelled&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;cancelled&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;dep_delay&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;dep_delay&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;destination&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;destination&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;diverted&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;diverted&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;flight_num&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_num&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;flight_time&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_time&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;id2&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;id2&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;origin&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;origin&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;tail_num&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;tail_num&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;taxi_in&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;taxi_in&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;taxi_out&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;taxi_out&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">5</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h3>
        <a id="run-ad-hoc-queries" class="header-link anchor" href="#run-ad-hoc-queries">
          Run Ad-hoc Queries
        </a>
      </h3>
    <div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C4" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carrier</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="6ef835af-7de4-46e9-b9d0-e8709de328a0">
        <script>(()=>{var e=document.getElementById("6ef835af-7de4-46e9-b9d0-e8709de328a0"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:[],contents:{},queryList:[{type:"query",structRef:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]}]},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carrier"]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],limit:10,filterList:[],fieldUsage:[{path:["carrier"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},text:"carrier"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   base."carrier" as "carrier",\n   COUNT(1) as "flight_count"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\nLIMIT 10\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"carrier",type:"string",resultMetadata:{sourceField:"carrier",sourceClasses:["carrier"],referenceId:"b8905e2a-d80b-4491-8b4d-5e24d1899140",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:5},end:{line:0,character:44}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"023c9d57-00fb-48f6-9055-9c545b15abc2",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:2,character:13},end:{line:2,character:36}}}}],dialect:"duckdb",primaryKey:"carrier",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:10,orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"duckdb:../data/flights.parquet",connectionName:"duckdb",result:[{carrier:"WN",flight_count:88751},{carrier:"US",flight_count:37683},{carrier:"AA",flight_count:34577},{carrier:"NW",flight_count:33580},{carrier:"UA",flight_count:32757}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">88751</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">37683</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">34577</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NW&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33580</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;UA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32757</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   base.</span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;carrier&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>Explore until you understand:</p>
<ul>
<li><p>What one row represents (the "grain")</p>
</li>
<li><p>What columns exist</p>
</li>
<li><p>What questions you want to answer</p>
</li></ul>
<p>See <a href="../language/query">Queries</a> for the full query syntax.</p>
<hr/>

      <h2>
        <a id="3-add-measures" class="header-link anchor" href="#3-add-measures">
          3. Add Measures
        </a>
      </h2>
    <p>Measures are reusable aggregations. Add them when you find yourself writing the same <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">count</span><span style="color: #000000">()</span></span></code> or <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">sum</span><span style="color: #000000">()</span></span></code> repeatedly.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C6" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">total_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">sum</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">avg_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">avg</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; { </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">total_distance</span><span style="color: #000000">, </span><span style="color: #001080">avg_distance</span><span style="color: #000000"> }</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="1168c926-6291-4611-ab56-95e27f3ae295">
        <script>(()=>{var e=document.getElementById("1168c926-6291-4611-ab56-95e27f3ae295"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"}},queryList:[{type:"query",structRef:"flights",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]},{type:"fieldref",path:["avg_distance"]}],filterList:[],fieldUsage:[{path:["flight_count"]},{path:["total_distance"]},{path:["avg_distance"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"exploreReference",text:"flights",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"}},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},text:"total_distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},text:"avg_distance"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   COUNT(1) as "flight_count",\n   COALESCE(SUM(base."distance"),0) as "total_distance",\n   AVG(base."distance") as "avg_distance"\nFROM \'../data/flights.parquet\' as base\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"f0e08129-e5a0-41dc-bc23-3ef485f3c311",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:2,character:4},end:{line:2,character:27}}}},{name:"total_distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"total_distance",sourceExpression:"sum(distance)",sourceClasses:["total_distance"],referenceId:"c0dd57ec-3ca0-4176-8ad7-db44461d3277",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:3,character:4},end:{line:3,character:35}}}},{name:"avg_distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"avg_distance",sourceExpression:"avg(distance)",sourceClasses:["avg_distance"],referenceId:"e13b1dee-61f1-4637-97e5-98602bb130a5",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:4,character:4},end:{line:4,character:33}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights",sourceArguments:{},connectionName:"duckdb",result:[{flight_count:344827,total_distance:255337195,avg_distance:740.4791243145113}],totalRows:1},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">344827</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">255337195</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">740.4791243145113</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">),</span><span style="color: #098658">0</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;total_distance&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">AVG</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;avg_distance&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h3>
        <a id="filtered-measures" class="header-link anchor" href="#filtered-measures">
          Filtered Measures
        </a>
      </h3>
    <p>You can also apply filters directly to measures:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C8" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights2</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">() { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_delay</span><span style="color: #000000"> &gt; </span><span style="color: #098658">15</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">long_flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">() { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">distance</span><span style="color: #000000"> &gt; </span><span style="color: #098658">1000</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delay_rate</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> / </span><span style="color: #001080">flight_count</span><span style="color: #000000"> * </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights2</span><span style="color: #000000"> -&gt; { </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">delayed_flights</span><span style="color: #000000">, </span><span style="color: #001080">delay_rate</span><span style="color: #000000"> }</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="3f10ce75-6982-4851-a3d9-dd2af43a3130">
        <script>(()=>{var e=document.getElementById("3f10ce75-6982-4851-a3d9-dd2af43a3130"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"}},queryList:[{type:"query",structRef:"flights2",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delayed_flights"]},{type:"fieldref",path:["delay_rate"]}],filterList:[],fieldUsage:[{path:["flight_count"]},{path:["delayed_flights"]},{path:["delay_rate"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},text:"dep_delay"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},text:"delayed_flights"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"exploreReference",text:"flights2",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"}},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},text:"delayed_flights"},{type:"fieldReference",definition:{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},text:"delay_rate"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   COUNT(1) as "flight_count",\n   COUNT(CASE WHEN base."dep_delay">15 THEN 1 END) as "delayed_flights",\n   ((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))*100 as "delay_rate"\nFROM \'../data/flights.parquet\' as base\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"dbdbba37-5875-4c47-bad7-3ee6c8fa7353",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:2,character:4},end:{line:2,character:27}}}},{name:"delayed_flights",numberType:"integer",type:"number",resultMetadata:{sourceField:"delayed_flights",sourceExpression:"count() { where: dep_delay > 15 }",sourceClasses:["delayed_flights"],referenceId:"6c7b837a-c4ad-4aa7-987a-79737a6950c0",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:3,character:4},end:{line:3,character:56}}}},{name:"delay_rate",type:"number",resultMetadata:{sourceField:"delay_rate",sourceExpression:"delayed_flights / flight_count * 100",sourceClasses:["delay_rate"],referenceId:"ed1eaee1-b410-4c2c-9c25-728e54bdab37",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:5,character:4},end:{line:5,character:54}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights2",sourceArguments:{},connectionName:"duckdb",result:[{flight_count:344827,delayed_flights:53524,delay_rate:15.52198638737686}],totalRows:1},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">344827</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delayed_flights&quot;</span><span style="color: #000000">: </span><span style="color: #098658">53524</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15.52198638737686</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_delay&quot;</span><span style="color: #000000">&gt;</span><span style="color: #098658">15</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;delayed_flights&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   ((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_delay&quot;</span><span style="color: #000000">&gt;</span><span style="color: #098658">15</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)))*</span><span style="color: #098658">100</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;delay_rate&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>Beyond <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">count</span><span style="color: #000000">()</span></span></code> and <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">sum</span><span style="color: #000000">()</span></span></code>, Malloy supports <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">avg</span><span style="color: #000000">()</span></span></code>, <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">min</span><span style="color: #000000">()</span></span></code>, <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">max</span><span style="color: #000000">()</span></span></code>, and more. Use <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">count</span><span style="color: #000000">(</span><span style="color: #001080">field</span><span style="color: #000000">)</span></span></code> for distinct counts. See <a href="../language/aggregates">Aggregates</a> for the full list.</p>
<hr/>

      <h2>
        <a id="4-add-dimensions" class="header-link anchor" href="#4-add-dimensions">
          4. Add Dimensions
        </a>
      </h2>
    <p>Dimensions are reusable groupings. Add them when you keep grouping by the same expression.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C10" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights3</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">dimension</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_month</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">month</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights3</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="0d79cbca-6f38-479a-b931-d3b8ac6eac97">
        <script>(()=>{var e=document.getElementById("0d79cbca-6f38-479a-b931-d3b8ac6eac97"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"}},queryList:[{type:"query",structRef:"flights3",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"exploreReference",text:"flights3",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"}},{type:"fieldReference",definition:{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},text:"flight_year"},{type:"fieldReference",definition:{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},text:"flight_month"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   DATE_TRUNC(\'year\', base."dep_time") as "flight_year",\n   DATE_TRUNC(\'month\', base."dep_time") as "flight_month",\n   COUNT(1) as "flight_count"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1,2\nORDER BY 1 ASC NULLS LAST,2 ASC NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"flight_year",type:"timestamp",timeframe:"year",resultMetadata:{sourceField:"flight_year",sourceExpression:"dep_time.year",sourceClasses:["flight_year"],referenceId:"4678f676-6542-4927-bce1-613d9213ea0a",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:2,character:4},end:{line:2,character:32}}}},{name:"flight_month",type:"timestamp",timeframe:"month",resultMetadata:{sourceField:"flight_month",sourceExpression:"dep_time.month",sourceClasses:["flight_month"],referenceId:"61c74b73-23d8-4418-8b54-aa1b797a5009",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:3,character:4},end:{line:3,character:34}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"15e03cfd-a804-4e4d-9fd4-f2a615d23e66",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:6,character:4},end:{line:6,character:27}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_year"},{field:"flight_month"}],drillable:!0}}],sourceExplore:"flights3",sourceArguments:{},connectionName:"duckdb",result:[{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-01-01T00:00:00.000Z",flight_count:4020},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-02-01T00:00:00.000Z",flight_count:3876},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-03-01T00:00:00.000Z",flight_count:4252},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-04-01T00:00:00.000Z",flight_count:3778},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-05-01T00:00:00.000Z",flight_count:4047}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4020</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-02-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3876</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-03-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4252</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-04-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3778</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-05-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4047</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;month&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_month&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h3>
        <a id="category-dimensions" class="header-link anchor" href="#category-dimensions">
          Category Dimensions
        </a>
      </h3>
    <p>Create buckets from numeric columns:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C12" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights4</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">dimension</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">distance_bucket</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">pick</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Short&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">when</span><span style="color: #000000"> </span><span style="color: #001080">distance</span><span style="color: #000000"> &lt; </span><span style="color: #098658">500</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">pick</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Medium&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">when</span><span style="color: #000000"> </span><span style="color: #001080">distance</span><span style="color: #000000"> &lt; </span><span style="color: #098658">1000</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">else</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Long&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights4</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">distance_bucket</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="d6dcd334-7848-40ac-8127-f1df30c0a2c4">
        <script>(()=>{var e=document.getElementById("d6dcd334-7848-40ac-8127-f1df30c0a2c4"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"}},queryList:[{type:"query",structRef:"flights4",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["distance_bucket"]},{type:"fieldref",path:["flight_count"]}],filterList:[],fieldUsage:[{path:["distance_bucket"]},{path:["flight_count"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"exploreReference",text:"flights4",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"500"}}},{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}}],caseThen:[{node:"stringLiteral",literal:"Short"},{node:"stringLiteral",literal:"Medium"}],caseElse:{node:"stringLiteral",literal:"Long"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"}},{type:"fieldReference",definition:{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"500"}}},{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}}],caseThen:[{node:"stringLiteral",literal:"Short"},{node:"stringLiteral",literal:"Medium"}],caseElse:{node:"stringLiteral",literal:"Long"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},text:"distance_bucket"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:"SELECT \n   CASE WHEN (base.\"distance\"<500) THEN 'Short' WHEN (base.\"distance\"<1000) THEN 'Medium' ELSE 'Long' END as \"distance_bucket\",\n   COUNT(1) as \"flight_count\"\nFROM '../data/flights.parquet' as base\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n",dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"distance_bucket",type:"string",resultMetadata:{sourceField:"distance_bucket",sourceExpression:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'",sourceClasses:["distance_bucket"],referenceId:"f27c602d-d13e-4bd8-a855-b648e02f49f8",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:2,character:4},end:{line:5,character:17}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"c4c844be-f98e-4128-b49c-74b7b3f8cf3a",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:7,character:11},end:{line:7,character:34}}}}],dialect:"duckdb",primaryKey:"distance_bucket",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights4",sourceArguments:{},connectionName:"duckdb",result:[{distance_bucket:"Short",flight_count:154125},{distance_bucket:"Medium",flight_count:100700},{distance_bucket:"Long",flight_count:90002}],totalRows:3},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance_bucket&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Short&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">154125</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance_bucket&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Medium&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100700</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;distance_bucket&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Long&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">90002</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">&lt;</span><span style="color: #098658">500</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Short&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">&lt;</span><span style="color: #098658">1000</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Medium&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Long&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;distance_bucket&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>Dimensions can be any expression—date extractions, string manipulations, case logic, and more.</p>
<hr/>

      <h2>
        <a id="5-add-joins" class="header-link anchor" href="#5-add-joins">
          5. Add Joins
        </a>
      </h2>
    <p>Joins connect related tables. Once defined, all joined data becomes queryable—you define the relationships once and never have to write join logic in queries again.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C14" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">carriers</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">code</span><span style="color: #000000">  </span><span style="color: #008000">// Tells Malloy this field uniquely identifies rows</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights5</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">carriers</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">carrier</span><span style="color: #000000">  </span><span style="color: #008000">// joins where carrier = carriers.code</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights5</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carriers</span><span style="color: #000000">.</span><span style="color: #001080">nickname</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="816ddd0d-f3bf-4f09-9db9-91d1e0e1961e">
        <script>(()=>{var e=document.getElementById("816ddd0d-f3bf-4f09-9db9-91d1e0e1961e"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4","carriers","flights5"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"},carriers:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"},flights5:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"],sql:'carriers_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"}},queryList:[{type:"query",structRef:"flights5",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers","nickname"]},{type:"fieldref",path:["flight_count"]}],limit:10,filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers","nickname"]},{path:["flight_count"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"exploreReference",text:"carriers",definition:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"}},{type:"fieldReference",definition:{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},text:"carrier"},{type:"exploreReference",text:"flights5",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"}},{type:"joinReference",definition:{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers"},{type:"fieldReference",definition:{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]},text:"nickname"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"joinReference",definition:{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   carriers_0."nickname" as "nickname",\n   COUNT(1) as "flight_count"\nFROM \'../data/flights.parquet\' as base\n LEFT JOIN \'../data/carriers.parquet\' AS carriers_0\n  ON carriers_0."code"=base."carrier"\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\nLIMIT 10\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"nickname",type:"string",resultMetadata:{sourceField:"carriers.nickname",sourceClasses:["carriers.nickname"],referenceId:"3761f9eb-140c-4ddb-9ca1-24f548298bdf",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:20},end:{line:0,character:60}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"99defb7a-1281-4f1e-b4ef-76790223c48b",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:7,character:11},end:{line:7,character:34}}}}],dialect:"duckdb",primaryKey:"nickname",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:10,orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights5",sourceArguments:{},connectionName:"duckdb",result:[{nickname:"Southwest",flight_count:88751},{nickname:"USAir",flight_count:37683},{nickname:"American",flight_count:34577},{nickname:"Northwest",flight_count:33580},{nickname:"United",flight_count:32757}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Southwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">88751</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;USAir&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">37683</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;American&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">34577</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Northwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33580</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;United&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32757</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   carriers_0.</span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> carriers_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> carriers_0.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">=base.</span><span style="color: #A31515">&quot;carrier&quot;</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>
      <h3>
        <a id="join-types" class="header-link anchor" href="#join-types">
          Join Types
        </a>
      </h3>
    <ul>
<li><p><code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">join_one</span></span></code>: Each flight has one carrier (many-to-one). Use when querying from the "many" side.</p>
</li>
<li><p><code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">join_many</span></span></code>: Each carrier has many flights (one-to-many). Use when querying from the "one" side—e.g., starting from carriers and analyzing their flights.</p>
</li></ul>

      <h3>
        <a id="multiple-joins-to-same-table" class="header-link anchor" href="#multiple-joins-to-same-table">
          Multiple Joins to Same Table
        </a>
      </h3>
    <p>Use an alias when joining a table with itself:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C16" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">airports2</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">code</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights6</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">origin_airport</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">airports2</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">origin</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">dest_airport</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">airports2</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">destination</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights6</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">origin_city</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">origin_airport</span><span style="color: #000000">.</span><span style="color: #001080">city</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">dest_city</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dest_airport</span><span style="color: #000000">.</span><span style="color: #001080">city</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="6e023b22-14d5-4df2-bf03-3a6004e3e84a">
        <script>(()=>{var e=document.getElementById("6e023b22-14d5-4df2-bf03-3a6004e3e84a"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4","carriers","flights5","airports2","flights6"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"},carriers:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"},flights5:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"],sql:'carriers_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"},airports2:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"},flights6:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"],sql:'origin_airport_0."code"'},right:{node:"field",path:["origin"],sql:'base."origin"'}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"],sql:'dest_airport_0."code"'},right:{node:"field",path:["destination"],sql:'base."destination"'}}},onFieldUsage:[{path:["destination"]}]}],parameters:{},as:"flights6"}},queryList:[{type:"query",structRef:"flights6",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"string",name:"origin_city",e:{node:"field",path:["origin_airport","city"]},fieldUsage:[{path:["origin_airport","city"]}],expressionType:"scalar",code:"origin_airport.city"},{type:"string",name:"dest_city",e:{node:"field",path:["dest_airport","city"]},fieldUsage:[{path:["dest_airport","city"]}],expressionType:"scalar",code:"dest_airport.city"},{type:"fieldref",path:["flight_count"]}],limit:10,filterList:[],fieldUsage:[{path:["origin"]},{path:["origin_airport","city"]},{path:["destination"]},{path:["dest_airport","city"]},{path:["flight_count"]}],defaultOrderBy:!0,orderBy:[{field:"flight_count",dir:"desc"}]}]}],dependencies:{},references:[{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"exploreReference",text:"airports2",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"}},{type:"fieldReference",definition:{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},text:"origin"},{type:"exploreReference",text:"airports2",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"}},{type:"fieldReference",definition:{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},text:"destination"},{type:"exploreReference",text:"flights6",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"]},right:{node:"field",path:["destination"]}}},onFieldUsage:[{path:["destination"]}]}],parameters:{},as:"flights6"}},{type:"joinReference",definition:{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},text:"origin_airport"},{type:"fieldReference",definition:{type:"string",name:"city",fieldUsage:[{path:["city"]}]},text:"city"},{type:"joinReference",definition:{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"]},right:{node:"field",path:["destination"]}}},onFieldUsage:[{path:["destination"]}]},text:"dest_airport"},{type:"fieldReference",definition:{type:"string",name:"city",fieldUsage:[{path:["city"]}]},text:"city"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"joinReference",definition:{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},text:"origin_airport"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   origin_airport_0."city" as "origin_city",\n   dest_airport_0."city" as "dest_city",\n   COUNT(1) as "flight_count"\nFROM \'../data/flights.parquet\' as base\n LEFT JOIN \'../data/airports.parquet\' AS origin_airport_0\n  ON origin_airport_0."code"=base."origin"\n LEFT JOIN \'../data/airports.parquet\' AS dest_airport_0\n  ON dest_airport_0."code"=base."destination"\nGROUP BY 1,2\nORDER BY 3 desc NULLS LAST\nLIMIT 10\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"origin_city",type:"string",resultMetadata:{sourceField:"origin_city",sourceExpression:"origin_airport.city",sourceClasses:["origin_city"],referenceId:"72de64d0-3bdf-4b3d-b041-812ec3935058",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:13,character:4},end:{line:13,character:38}}}},{name:"dest_city",type:"string",resultMetadata:{sourceField:"dest_city",sourceExpression:"dest_airport.city",sourceClasses:["dest_city"],referenceId:"ecbb4710-b502-460e-a57d-6fe7a73b15e6",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:14,character:4},end:{line:14,character:34}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"d1b07ed4-51e1-4f3f-87c5-d98992494c68",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:8,character:11},end:{line:8,character:34}}}}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",limit:10,orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights6",sourceArguments:{},connectionName:"duckdb",result:[{origin_city:"WASHINGTON",dest_city:"NEW YORK",flight_count:2195},{origin_city:"NEW YORK",dest_city:"WASHINGTON",flight_count:2174},{origin_city:"NEW YORK",dest_city:"BOSTON",flight_count:1292},{origin_city:"BOSTON",dest_city:"NEW YORK",flight_count:1278},{origin_city:"LOS ANGELES",dest_city:"LAS VEGAS",flight_count:1073}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WASHINGTON&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dest_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NEW YORK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2195</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NEW YORK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dest_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WASHINGTON&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2174</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NEW YORK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dest_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BOSTON&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1292</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;BOSTON&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dest_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NEW YORK&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1278</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;origin_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LOS ANGELES&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;dest_city&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;LAS VEGAS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1073</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   origin_airport_0.</span><span style="color: #A31515">&quot;city&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;origin_city&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   dest_airport_0.</span><span style="color: #A31515">&quot;city&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;dest_city&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> origin_airport_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> origin_airport_0.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">=base.</span><span style="color: #A31515">&quot;origin&quot;</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> dest_airport_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> dest_airport_0.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">=base.</span><span style="color: #A31515">&quot;destination&quot;</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">3</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>Malloy handles aggregates correctly across joins—no more fanout bugs. It automatically adjusts aggregations based on join cardinality, so <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #795E26">count</span><span style="color: #000000">()</span></span></code> returns the right number even through one-to-many joins. See <a href="../language/aggregates">symmetric aggregates</a> for details.</p>
<p>See <a href="../language/join">Joins</a> for more join patterns.</p>
<hr/>

      <h2>
        <a id="6-add-views" class="header-link anchor" href="#6-add-views">
          6. Add Views
        </a>
      </h2>
    <p>Views are saved queries. Add them when you have analysis patterns you'll reuse.</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C18" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">carriers3</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">code</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights7</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">carriers3</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">carrier</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">dimension</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_month</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">month</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">total_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">sum</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">avg_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">avg</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">() { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_delay</span><span style="color: #000000"> &gt; </span><span style="color: #098658">15</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delay_rate</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> / </span><span style="color: #001080">flight_count</span><span style="color: #000000"> * </span><span style="color: #098658">100</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">monthly_summary</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">total_distance</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">carrier_performance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carriers3</span><span style="color: #000000">.</span><span style="color: #001080">nickname</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">delay_rate</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">desc</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights7</span><span style="color: #000000"> -&gt; </span><span style="color: #001080">monthly_summary</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="2bac449c-cf26-4661-a5fa-a930c5f087d7">
        <script>(()=>{var e=document.getElementById("2bac449c-cf26-4661-a5fa-a930c5f087d7"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4","carriers","flights5","airports2","flights6","carriers3","flights7"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"},carriers:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"},flights5:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"],sql:'carriers_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"},airports2:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"},flights6:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"],sql:'origin_airport_0."code"'},right:{node:"field",path:["origin"],sql:'base."origin"'}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"],sql:'dest_airport_0."code"'},right:{node:"field",path:["destination"],sql:'base."destination"'}}},onFieldUsage:[{path:["destination"]}]}],parameters:{},as:"flights6"},carriers3:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers3"},flights7:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_performance",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["delay_rate"]}]}],annotation:{}}],parameters:{},as:"flights7"}},queryList:[{type:"query",structRef:"flights7",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"],drillView:"monthly_summary"},{type:"fieldref",path:["flight_month"],drillView:"monthly_summary"},{type:"fieldref",path:["flight_count"],drillView:"monthly_summary"},{type:"fieldref",path:["total_distance"],drillView:"monthly_summary"}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:31,character:17},end:{line:31,character:32}}}}],name:"monthly_summary",annotation:{inherits:{}}}],dependencies:{},references:[{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"exploreReference",text:"carriers3",definition:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers3"}},{type:"fieldReference",definition:{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},text:"carrier"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},text:"dep_delay"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},text:"delayed_flights"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},text:"flight_year"},{type:"fieldReference",definition:{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},text:"flight_month"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},text:"total_distance"},{type:"joinReference",definition:{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers3"},{type:"fieldReference",definition:{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]},text:"nickname"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},text:"delay_rate"},{type:"joinReference",definition:{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers3"},{type:"exploreReference",text:"flights7",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_performance",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["delay_rate"]}]}],annotation:{}}],parameters:{},as:"flights7"}},{type:"fieldReference",definition:{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},text:"monthly_summary"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   DATE_TRUNC(\'year\', base."dep_time") as "flight_year",\n   DATE_TRUNC(\'month\', base."dep_time") as "flight_month",\n   COUNT(1) as "flight_count",\n   COALESCE(SUM(base."distance"),0) as "total_distance"\nFROM \'../data/flights.parquet\' as base\nGROUP BY 1,2\nORDER BY 1 ASC NULLS LAST,2 ASC NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"flight_year",type:"timestamp",timeframe:"year",resultMetadata:{sourceField:"flight_year",sourceExpression:"dep_time.year",sourceClasses:["flight_year"],referenceId:"795fd4f6-b211-4a9a-a7ea-daf5c2156f12",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:8,character:4},end:{line:8,character:32}}},drillView:"monthly_summary"},{name:"flight_month",type:"timestamp",timeframe:"month",resultMetadata:{sourceField:"flight_month",sourceExpression:"dep_time.month",sourceClasses:["flight_month"],referenceId:"cb24c14d-c39e-430c-bc75-c9b37a32534c",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:9,character:4},end:{line:9,character:34}}},drillView:"monthly_summary"},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"6f4d1ac4-3299-46ff-a482-8bb897b467ed",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:12,character:4},end:{line:12,character:27}}},drillView:"monthly_summary"},{name:"total_distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"total_distance",sourceExpression:"sum(distance)",sourceClasses:["total_distance"],referenceId:"05f61f94-c49e-4c5f-9093-b9e504b9866e",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:13,character:4},end:{line:13,character:35}}},drillView:"monthly_summary"}],dialect:"duckdb",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_year"},{field:"flight_month"}],drillable:!0}}],sourceExplore:"flights7",sourceArguments:{},queryName:"monthly_summary",connectionName:"duckdb",annotation:{inherits:{}},result:[{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-01-01T00:00:00.000Z",flight_count:4020,total_distance:3425091},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-02-01T00:00:00.000Z",flight_count:3876,total_distance:3181806},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-03-01T00:00:00.000Z",flight_count:4252,total_distance:3568248},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-04-01T00:00:00.000Z",flight_count:3778,total_distance:3208048},{flight_year:"2000-01-01T00:00:00.000Z",flight_month:"2000-05-01T00:00:00.000Z",flight_count:4047,total_distance:3319093}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4020</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3425091</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-02-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3876</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3181806</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-03-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4252</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3568248</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-04-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3778</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3208048</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_month&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-05-01T00:00:00.000Z&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4047</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3319093</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;year&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_year&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   DATE_TRUNC(</span><span style="color: #A31515">&#39;month&#39;</span><span style="color: #000000">, base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_month&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">),</span><span style="color: #098658">0</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;total_distance&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">ASC</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><blockquote>
<blockquote>
<blockquote>
<p>malloy
run: flights7 -> carrier_performance</p>
</blockquote>
</blockquote>
</blockquote>

      <h3>
        <a id="ad-hoc-queries-still-work" class="header-link anchor" href="#ad-hoc-queries-still-work">
          Ad-hoc Queries Still Work
        </a>
      </h3>
    <p>Views don't limit you. You can still write any query:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C20" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights7</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> ? </span><span style="color: #098658">@2003-01</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carriers3</span><span style="color: #000000">.</span><span style="color: #001080">nickname</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">avg_distance</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">desc</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">5</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="4de92a8d-5821-4823-891a-469faf3cdefe">
        <script>(()=>{var e=document.getElementById("4de92a8d-5821-4823-891a-469faf3cdefe"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4","carriers","flights5","airports2","flights6","carriers3","flights7"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"},carriers:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"},flights5:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"],sql:'carriers_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"},airports2:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"},flights6:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"],sql:'origin_airport_0."code"'},right:{node:"field",path:["origin"],sql:'base."origin"'}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"],sql:'dest_airport_0."code"'},right:{node:"field",path:["destination"],sql:'base."destination"'}}},onFieldUsage:[{path:["destination"]}]}],parameters:{},as:"flights6"},carriers3:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers3"},flights7:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"],sql:'carriers3_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_performance",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["delay_rate"]}]}],annotation:{}}],parameters:{},as:"flights7"}},queryList:[{type:"query",structRef:"flights7",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]}],orderBy:[{field:"flight_count",dir:"desc"}],limit:5,filterList:[{node:"filterCondition",code:"dep_time ? @2003-01",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"month"}}}},right:{node:"<",kids:{left:{node:"field",path:["dep_time"]},right:{node:"timeLiteral",literal:"2003-02-01 00:00:00",typeDef:{type:"timestamp",timeframe:"month"}}}}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"]},{path:["dep_time"]}]}],fieldUsage:[{path:["dep_time"]},{path:["dep_time"]},{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["avg_distance"]}]}]}],dependencies:{},references:[{type:"exploreReference",text:"flights7",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_performance",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["delay_rate"]}]}],annotation:{}}],parameters:{},as:"flights7"}},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"joinReference",definition:{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers3"},{type:"fieldReference",definition:{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]},text:"nickname"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},text:"avg_distance"},{type:"joinReference",definition:{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers3"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   carriers3_0."nickname" as "nickname",\n   COUNT(1) as "flight_count",\n   AVG(base."distance") as "avg_distance"\nFROM \'../data/flights.parquet\' as base\n LEFT JOIN \'../data/carriers.parquet\' AS carriers3_0\n  ON carriers3_0."code"=base."carrier"\nWHERE (base."dep_time">=TIMESTAMP \'2003-01-01 00:00:00\') and (base."dep_time"<TIMESTAMP \'2003-02-01 00:00:00\')\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\nLIMIT 5\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"nickname",type:"string",resultMetadata:{sourceField:"carriers3.nickname",sourceClasses:["carriers3.nickname"],referenceId:"90da7e6f-deb7-489d-bbcc-39c0fe8a0546",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:21},end:{line:0,character:61}}}},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"de16bafd-d653-4121-aaae-46153abec61f",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:12,character:4},end:{line:12,character:27}}}},{name:"avg_distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"avg_distance",sourceExpression:"avg(distance)",sourceClasses:["avg_distance"],referenceId:"b445adfd-8a14-4ed2-99e4-5a716d1c1ad3",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:14,character:4},end:{line:14,character:33}}}}],dialect:"duckdb",primaryKey:"nickname",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[{node:"filterCondition",code:"dep_time ? @2003-01",e:{node:"and",kids:{left:{node:">=",kids:{left:{node:"field",path:["dep_time"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:1,character:9},end:{line:1,character:17}}},sql:'base."dep_time"'},right:{node:"timeLiteral",literal:"2003-01-01 00:00:00",typeDef:{type:"timestamp",timeframe:"month"},sql:"TIMESTAMP '2003-01-01 00:00:00'"}},sql:"(base.\"dep_time\">=TIMESTAMP '2003-01-01 00:00:00')"},right:{node:"<",kids:{left:{node:"field",path:["dep_time"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:1,character:9},end:{line:1,character:17}}},sql:'base."dep_time"'},right:{node:"timeLiteral",literal:"2003-02-01 00:00:00",typeDef:{type:"timestamp",timeframe:"month"},sql:"TIMESTAMP '2003-02-01 00:00:00'"}},sql:"(base.\"dep_time\"<TIMESTAMP '2003-02-01 00:00:00')"}}},expressionType:"scalar",fieldUsage:[{path:["dep_time"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:1,character:9},end:{line:1,character:17}}}},{path:["dep_time"],at:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:1,character:9},end:{line:1,character:17}}}}]}],sourceClasses:["ignoreme"],fieldKind:"struct",limit:5,orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights7",sourceArguments:{},connectionName:"duckdb",result:[{nickname:"Southwest",flight_count:1209,avg_distance:643.7229114971051},{nickname:"Atlantic Southeast",flight_count:547,avg_distance:212.12797074954295},{nickname:"United",flight_count:524,avg_distance:1187.3034351145038},{nickname:"American",flight_count:422,avg_distance:1235.521327014218},{nickname:"Northwest",flight_count:419,avg_distance:1063.6229116945108}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Southwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1209</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">643.7229114971051</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Atlantic Southeast&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">547</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">212.12797074954295</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;United&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">524</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1187.3034351145038</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;American&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">422</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1235.521327014218</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Northwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">419</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1063.6229116945108</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   carriers3_0.</span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">AVG</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;avg_distance&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> carriers3_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> carriers3_0.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">=base.</span><span style="color: #A31515">&quot;carrier&quot;</span></span>
<span class="line"><span style="color: #0000FF">WHERE</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-01-01 00:00:00&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">and</span><span style="color: #000000"> (base.</span><span style="color: #A31515">&quot;dep_time&quot;</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;2003-02-01 00:00:00&#39;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">5</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><p>See <a href="../language/views">Views</a> for more view patterns including nested views.</p>
<hr/>

      <h2>
        <a id="complete-example" class="header-link anchor" href="#complete-example">
          Complete Example
        </a>
      </h2>
    <p>In practice, put your source definitions in a <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">.</span><span style="color: #001080">malloy</span></span></code> file and import them into notebooks for analysis. Here's what a complete model looks like:</p>
<div class="code-wrapper"><a href="https://github.dev/malloydata/malloydata.github.io/blob/main/src/documentation/user_guides/quickstart_modeling.malloynb#C22" target="_blank" class="open_notebook"><img src="/img/open_notebook.svg" alt="document"/></a><pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">carriers_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">code</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">airports_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/airports.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">code</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">duckdb</span><span style="color: #000000">.</span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000">) </span><span style="color: #AF00DB">extend</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">carriers_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">carrier</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">origin_airport</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">airports_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">origin</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">dest_airport</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">airports_full</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">destination</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">dimension</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_month</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">month</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">distance_bucket</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">pick</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Short&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">when</span><span style="color: #000000"> </span><span style="color: #001080">distance</span><span style="color: #000000"> &lt; </span><span style="color: #098658">500</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">pick</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Medium&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">when</span><span style="color: #000000"> </span><span style="color: #001080">distance</span><span style="color: #000000"> &lt; </span><span style="color: #098658">1000</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">else</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;Long&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">total_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">sum</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">avg_distance</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">avg</span><span style="color: #000000">(</span><span style="color: #001080">distance</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">() { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_delay</span><span style="color: #000000"> &gt; </span><span style="color: #098658">15</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">delay_rate</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">delayed_flights</span><span style="color: #000000"> / </span><span style="color: #001080">flight_count</span><span style="color: #000000"> * </span><span style="color: #098658">100</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">monthly_summary</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">total_distance</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000">, </span><span style="color: #001080">flight_month</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">carrier_stats</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carriers_full</span><span style="color: #000000">.</span><span style="color: #001080">nickname</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">avg_distance</span><span style="color: #000000">, </span><span style="color: #001080">delay_rate</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">desc</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">view</span><span style="color: #000000">: </span><span style="color: #001080">route_analysis</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">origin_city</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">origin_airport</span><span style="color: #000000">.</span><span style="color: #001080">city</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">dest_city</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dest_airport</span><span style="color: #000000">.</span><span style="color: #001080">city</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000">, </span><span style="color: #001080">avg_distance</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">order_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">desc</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">limit</span><span style="color: #000000">: </span><span style="color: #098658">20</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">run</span><span style="color: #000000">: </span><span style="color: #001080">flights_full</span><span style="color: #000000"> -&gt; </span><span style="color: #001080">carrier_stats</span></span></pre><div class="result-outer small">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner" id="6291ff70-fc56-4f23-a82f-703ea5aea508">
        <script>(()=>{var e=document.getElementById("6291ff70-fc56-4f23-a82f-703ea5aea508"),t=document.createElement("malloy-render");t.modelDef={name:"",exports:["flights","flights2","flights3","flights4","carriers","flights5","airports2","flights6","carriers3","flights7","carriers_full","airports_full","flights_full"],contents:{flights:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"}],parameters:{},as:"flights"},flights2:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",numberType:"integer",name:"long_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"distance > 1000",e:{node:">",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}},expressionType:"scalar",fieldUsage:[{path:["distance"]}]}]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"count() { where: distance > 1000 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"}],parameters:{},as:"flights2"},flights3:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights3"},flights4:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"500",sql:"500"}},sql:'(base."distance"<500)'},{node:"<",kids:{left:{node:"field",path:["distance"],sql:'base."distance"'},right:{node:"numberLiteral",literal:"1000",sql:"1000"}},sql:'(base."distance"<1000)'}],caseThen:[{node:"stringLiteral",literal:"Short",sql:"'Short'"},{node:"stringLiteral",literal:"Medium",sql:"'Medium'"}],caseElse:{node:"stringLiteral",literal:"Long",sql:"'Long'"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"}],parameters:{},as:"flights4"},carriers:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers"},flights5:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"carriers",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers","code"],sql:'carriers_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]}],parameters:{},as:"flights5"},airports2:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports2"},flights6:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"],sql:'origin_airport_0."code"'},right:{node:"field",path:["origin"],sql:'base."origin"'}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"],sql:'dest_airport_0."code"'},right:{node:"field",path:["destination"],sql:'base."destination"'}}},onFieldUsage:[{path:["destination"]}]}],parameters:{},as:"flights6"},carriers3:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers3"},flights7:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers3",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers3","code"],sql:'carriers3_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_performance",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers3","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers3","nickname"]},{path:["flight_count"]},{path:["delay_rate"]}]}],annotation:{}}],parameters:{},as:"flights7"},carriers_full:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers_full"},airports_full:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports_full"},flights_full:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"500"}}},{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}}],caseThen:[{node:"stringLiteral",literal:"Short"},{node:"stringLiteral",literal:"Medium"}],caseElse:{node:"stringLiteral",literal:"Long"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""},sql:"COUNT(1)"},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"],sql:'base."dep_delay"'},right:{node:"numberLiteral",literal:"15",sql:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}],sql:'(base."dep_delay">15)'}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"],sql:'(COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))'},right:{node:"field",path:["flight_count"],sql:"(COUNT(1))"}},sql:'((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))'},right:{node:"numberLiteral",literal:"100",sql:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers_full",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers_full","code"],sql:'carriers_full_0."code"'},right:{node:"field",path:["carrier"],sql:'base."carrier"'}}},onFieldUsage:[{path:["carrier"]}]},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"]},right:{node:"field",path:["destination"]}}},onFieldUsage:[{path:["destination"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_stats",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers_full","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers_full","nickname"]},{path:["flight_count"]},{path:["avg_distance"]},{path:["delay_rate"]}]}],annotation:{}},{type:"turtle",name:"route_analysis",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"origin_city",e:{node:"field",path:["origin_airport","city"]},fieldUsage:[{path:["origin_airport","city"]}],expressionType:"scalar",code:"origin_airport.city"},{type:"string",name:"dest_city",e:{node:"field",path:["dest_airport","city"]},fieldUsage:[{path:["dest_airport","city"]}],expressionType:"scalar",code:"dest_airport.city"},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]}],orderBy:[{field:"flight_count",dir:"desc"}],limit:20,filterList:[],fieldUsage:[{path:["origin"]},{path:["origin_airport","city"]},{path:["destination"]},{path:["dest_airport","city"]},{path:["flight_count"]},{path:["avg_distance"]}]}],annotation:{}}],parameters:{},as:"flights_full"}},queryList:[{type:"query",structRef:"flights_full",sourceArguments:{},pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers_full","nickname"],drillView:"carrier_stats"},{type:"fieldref",path:["flight_count"],drillView:"carrier_stats"},{type:"fieldref",path:["avg_distance"],drillView:"carrier_stats"},{type:"fieldref",path:["delay_rate"],drillView:"carrier_stats"}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers_full","nickname"]},{path:["flight_count"]},{path:["avg_distance"]},{path:["delay_rate"]}],referencedAt:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:49,character:21},end:{line:49,character:34}}}}],name:"carrier_stats",annotation:{inherits:{}}}],dependencies:{},references:[{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"fieldReference",definition:{type:"string",name:"code",fieldUsage:[{path:["code"]}]},text:"code"},{type:"exploreReference",text:"carriers_full",definition:{type:"table",name:"duckdb:../data/carriers.parquet",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},as:"carriers_full"}},{type:"fieldReference",definition:{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},text:"carrier"},{type:"exploreReference",text:"airports_full",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports_full"}},{type:"fieldReference",definition:{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},text:"origin"},{type:"exploreReference",text:"airports_full",definition:{type:"table",name:"duckdb:../data/airports.parquet",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},as:"airports_full"}},{type:"fieldReference",definition:{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},text:"destination"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},text:"dep_time"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},text:"distance"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},text:"dep_delay"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},text:"delayed_flights"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},text:"flight_year"},{type:"fieldReference",definition:{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},text:"flight_month"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},text:"total_distance"},{type:"joinReference",definition:{type:"table",name:"carriers_full",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers_full","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers_full"},{type:"fieldReference",definition:{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]},text:"nickname"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},text:"avg_distance"},{type:"fieldReference",definition:{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},text:"delay_rate"},{type:"joinReference",definition:{type:"table",name:"carriers_full",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers_full","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},text:"carriers_full"},{type:"joinReference",definition:{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},text:"origin_airport"},{type:"fieldReference",definition:{type:"string",name:"city",fieldUsage:[{path:["city"]}]},text:"city"},{type:"joinReference",definition:{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"]},right:{node:"field",path:["destination"]}}},onFieldUsage:[{path:["destination"]}]},text:"dest_airport"},{type:"fieldReference",definition:{type:"string",name:"city",fieldUsage:[{path:["city"]}]},text:"city"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},text:"flight_count"},{type:"fieldReference",definition:{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},text:"avg_distance"},{type:"joinReference",definition:{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},text:"origin_airport"},{type:"exploreReference",text:"flights_full",definition:{type:"table",name:"duckdb:../data/flights.parquet",dialect:"duckdb",tablePath:"../data/flights.parquet",connection:"duckdb",fields:[{type:"string",name:"carrier",fieldUsage:[{path:["carrier"]}]},{type:"string",name:"origin",fieldUsage:[{path:["origin"]}]},{type:"string",name:"destination",fieldUsage:[{path:["destination"]}]},{type:"string",name:"flight_num",fieldUsage:[{path:["flight_num"]}]},{type:"number",numberType:"integer",name:"flight_time",fieldUsage:[{path:["flight_time"]}]},{type:"string",name:"tail_num",fieldUsage:[{path:["tail_num"]}]},{type:"timestamp",name:"dep_time",fieldUsage:[{path:["dep_time"]}]},{type:"timestamp",name:"arr_time",fieldUsage:[{path:["arr_time"]}]},{type:"number",numberType:"integer",name:"dep_delay",fieldUsage:[{path:["dep_delay"]}]},{type:"number",numberType:"integer",name:"arr_delay",fieldUsage:[{path:["arr_delay"]}]},{type:"number",numberType:"integer",name:"taxi_out",fieldUsage:[{path:["taxi_out"]}]},{type:"number",numberType:"integer",name:"taxi_in",fieldUsage:[{path:["taxi_in"]}]},{type:"number",numberType:"integer",name:"distance",fieldUsage:[{path:["distance"]}]},{type:"string",name:"cancelled",fieldUsage:[{path:["cancelled"]}]},{type:"string",name:"diverted",fieldUsage:[{path:["diverted"]}]},{type:"number",numberType:"integer",name:"id2",fieldUsage:[{path:["id2"]}]},{type:"timestamp",name:"flight_year",timeframe:"year",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"year"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.year"},{type:"timestamp",name:"flight_month",timeframe:"month",e:{node:"trunc",e:{node:"field",path:["dep_time"],typeDef:{type:"timestamp"}},units:"month"},fieldUsage:[{path:["dep_time"]}],expressionType:"scalar",code:"dep_time.month"},{type:"string",name:"distance_bucket",e:{node:"case",kids:{caseWhen:[{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"500"}}},{node:"<",kids:{left:{node:"field",path:["distance"]},right:{node:"numberLiteral",literal:"1000"}}}],caseThen:[{node:"stringLiteral",literal:"Short"},{node:"stringLiteral",literal:"Medium"}],caseElse:{node:"stringLiteral",literal:"Long"}}},fieldUsage:[{path:["distance"]},{path:["distance"]}],expressionType:"scalar",code:"pick 'Short' when distance < 500\n      pick 'Medium' when distance < 1000\n      else 'Long'"},{type:"number",numberType:"integer",name:"flight_count",e:{node:"aggregate",function:"count",e:{node:""}},fieldUsage:[],expressionType:"aggregate",code:"count()"},{type:"number",numberType:"integer",name:"total_distance",e:{node:"aggregate",function:"sum",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"sum(distance)"},{type:"number",numberType:"integer",name:"avg_distance",e:{node:"aggregate",function:"avg",e:{node:"field",path:["distance"]}},fieldUsage:[{path:["distance"]}],expressionType:"aggregate",code:"avg(distance)"},{type:"number",numberType:"integer",name:"delayed_flights",e:{node:"filteredExpr",kids:{e:{node:"aggregate",function:"count",e:{node:""}},filterList:[{node:"filterCondition",code:"dep_delay > 15",e:{node:">",kids:{left:{node:"field",path:["dep_delay"]},right:{node:"numberLiteral",literal:"15"}}},expressionType:"scalar",fieldUsage:[{path:["dep_delay"]}]}]}},fieldUsage:[{path:["dep_delay"]}],expressionType:"aggregate",code:"count() { where: dep_delay > 15 }"},{type:"number",name:"delay_rate",e:{node:"*",kids:{left:{node:"/",kids:{left:{node:"field",path:["delayed_flights"]},right:{node:"field",path:["flight_count"]}}},right:{node:"numberLiteral",literal:"100"}}},fieldUsage:[{path:["delayed_flights"]},{path:["flight_count"]}],expressionType:"aggregate",code:"delayed_flights / flight_count * 100"},{type:"table",name:"carriers_full",dialect:"duckdb",tablePath:"../data/carriers.parquet",connection:"duckdb",fields:[{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"name",fieldUsage:[{path:["name"]}]},{type:"string",name:"nickname",fieldUsage:[{path:["nickname"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["carriers_full","code"]},right:{node:"field",path:["carrier"]}}},onFieldUsage:[{path:["carrier"]}]},{type:"table",name:"origin_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["origin_airport","code"]},right:{node:"field",path:["origin"]}}},onFieldUsage:[{path:["origin"]}]},{type:"table",name:"dest_airport",dialect:"duckdb",tablePath:"../data/airports.parquet",connection:"duckdb",fields:[{type:"number",numberType:"integer",name:"id",fieldUsage:[{path:["id"]}]},{type:"string",name:"code",fieldUsage:[{path:["code"]}]},{type:"string",name:"site_number",fieldUsage:[{path:["site_number"]}]},{type:"string",name:"fac_type",fieldUsage:[{path:["fac_type"]}]},{type:"string",name:"fac_use",fieldUsage:[{path:["fac_use"]}]},{type:"string",name:"faa_region",fieldUsage:[{path:["faa_region"]}]},{type:"string",name:"faa_dist",fieldUsage:[{path:["faa_dist"]}]},{type:"string",name:"city",fieldUsage:[{path:["city"]}]},{type:"string",name:"county",fieldUsage:[{path:["county"]}]},{type:"string",name:"state",fieldUsage:[{path:["state"]}]},{type:"string",name:"full_name",fieldUsage:[{path:["full_name"]}]},{type:"string",name:"own_type",fieldUsage:[{path:["own_type"]}]},{type:"number",numberType:"float",name:"longitude",fieldUsage:[{path:["longitude"]}]},{type:"number",numberType:"float",name:"latitude",fieldUsage:[{path:["latitude"]}]},{type:"number",numberType:"integer",name:"elevation",fieldUsage:[{path:["elevation"]}]},{type:"string",name:"aero_cht",fieldUsage:[{path:["aero_cht"]}]},{type:"number",numberType:"integer",name:"cbd_dist",fieldUsage:[{path:["cbd_dist"]}]},{type:"string",name:"cbd_dir",fieldUsage:[{path:["cbd_dir"]}]},{type:"string",name:"act_date",fieldUsage:[{path:["act_date"]}]},{type:"string",name:"cert",fieldUsage:[{path:["cert"]}]},{type:"string",name:"fed_agree",fieldUsage:[{path:["fed_agree"]}]},{type:"string",name:"cust_intl",fieldUsage:[{path:["cust_intl"]}]},{type:"string",name:"c_ldg_rts",fieldUsage:[{path:["c_ldg_rts"]}]},{type:"string",name:"joint_use",fieldUsage:[{path:["joint_use"]}]},{type:"string",name:"mil_rts",fieldUsage:[{path:["mil_rts"]}]},{type:"string",name:"cntl_twr",fieldUsage:[{path:["cntl_twr"]}]},{type:"string",name:"major",fieldUsage:[{path:["major"]}]}],primaryKey:"code",parameters:{},arguments:{},join:"one",matrixOperation:"left",onExpression:{node:"=",kids:{left:{node:"field",path:["dest_airport","code"]},right:{node:"field",path:["destination"]}}},onFieldUsage:[{path:["destination"]}]},{type:"turtle",name:"monthly_summary",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["flight_year"]},{type:"fieldref",path:["flight_month"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["total_distance"]}],orderBy:[{field:"flight_year"},{field:"flight_month"}],filterList:[],fieldUsage:[{path:["flight_year"]},{path:["flight_month"]},{path:["flight_count"]},{path:["total_distance"]}]}],annotation:{}},{type:"turtle",name:"carrier_stats",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers_full","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers_full","nickname"]},{path:["flight_count"]},{path:["avg_distance"]},{path:["delay_rate"]}]}],annotation:{}},{type:"turtle",name:"route_analysis",pipeline:[{type:"reduce",queryFields:[{type:"string",name:"origin_city",e:{node:"field",path:["origin_airport","city"]},fieldUsage:[{path:["origin_airport","city"]}],expressionType:"scalar",code:"origin_airport.city"},{type:"string",name:"dest_city",e:{node:"field",path:["dest_airport","city"]},fieldUsage:[{path:["dest_airport","city"]}],expressionType:"scalar",code:"dest_airport.city"},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]}],orderBy:[{field:"flight_count",dir:"desc"}],limit:20,filterList:[],fieldUsage:[{path:["origin"]},{path:["origin_airport","city"]},{path:["destination"]},{path:["dest_airport","city"]},{path:["flight_count"]},{path:["avg_distance"]}]}],annotation:{}}],parameters:{},as:"flights_full"}},{type:"fieldReference",definition:{type:"turtle",name:"carrier_stats",pipeline:[{type:"reduce",queryFields:[{type:"fieldref",path:["carriers_full","nickname"]},{type:"fieldref",path:["flight_count"]},{type:"fieldref",path:["avg_distance"]},{type:"fieldref",path:["delay_rate"]}],orderBy:[{field:"flight_count",dir:"desc"}],filterList:[],fieldUsage:[{path:["carrier"]},{path:["carriers_full","nickname"]},{path:["flight_count"]},{path:["avg_distance"]},{path:["delay_rate"]}]}],annotation:{}},text:"carrier_stats"}],imports:[]},t.queryResult={lastStageName:"__stage0",malloy:"",sql:'SELECT \n   carriers_full_0."nickname" as "nickname",\n   COUNT(1) as "flight_count",\n   AVG(base."distance") as "avg_distance",\n   ((COUNT(CASE WHEN base."dep_delay">15 THEN 1 END))*1.0/(COUNT(1)))*100 as "delay_rate"\nFROM \'../data/flights.parquet\' as base\n LEFT JOIN \'../data/carriers.parquet\' AS carriers_full_0\n  ON carriers_full_0."code"=base."carrier"\nGROUP BY 1\nORDER BY 2 desc NULLS LAST\n',dependenciesToMaterialize:{},structs:[{type:"query_result",name:"__stage0",fields:[{name:"nickname",type:"string",resultMetadata:{sourceField:"carriers_full.nickname",sourceClasses:["carriers_full.nickname"],referenceId:"58d1fdbd-d498-4dab-b81e-010a8a716c53",fieldKind:"dimension"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:0,character:25},end:{line:0,character:65}}},drillView:"carrier_stats"},{name:"flight_count",numberType:"integer",type:"number",resultMetadata:{sourceField:"flight_count",sourceExpression:"count()",sourceClasses:["flight_count"],referenceId:"1607e66b-8be7-48ea-848b-598ebf1769b2",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:21,character:4},end:{line:21,character:27}}},drillView:"carrier_stats"},{name:"avg_distance",numberType:"integer",type:"number",resultMetadata:{sourceField:"avg_distance",sourceExpression:"avg(distance)",sourceClasses:["avg_distance"],referenceId:"43042f35-783f-4c49-bbbf-312f667d0f4a",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:23,character:4},end:{line:23,character:33}}},drillView:"carrier_stats"},{name:"delay_rate",type:"number",resultMetadata:{sourceField:"delay_rate",sourceExpression:"delayed_flights / flight_count * 100",sourceClasses:["delay_rate"],referenceId:"d3be7a92-809b-4247-b107-e92677fa0cf7",filterList:[],fieldKind:"measure"},location:{url:"file:///home/runner/work/malloydata.github.io/malloydata.github.io/src/documentation/user_guides/quickstart_modeling.malloynb",range:{start:{line:25,character:4},end:{line:25,character:54}}},drillView:"carrier_stats"}],dialect:"duckdb",primaryKey:"nickname",connection:"duckdb",resultMetadata:{sourceField:"ignoreme",filterList:[],sourceClasses:["ignoreme"],fieldKind:"struct",orderBy:[{field:"flight_count",dir:"desc"}],drillable:!0}}],sourceExplore:"flights_full",sourceArguments:{},queryName:"carrier_stats",connectionName:"duckdb",annotation:{inherits:{}},result:[{nickname:"Southwest",flight_count:88751,avg_distance:615.4201304774031,delay_rate:16.919245980326984},{nickname:"USAir",flight_count:37683,avg_distance:629.5051349414855,delay_rate:15.261523764031526},{nickname:"American",flight_count:34577,avg_distance:1089.8830147207682,delay_rate:14.859588743962751},{nickname:"Northwest",flight_count:33580,avg_distance:993.9399344848124,delay_rate:13.764145324597976},{nickname:"United",flight_count:32757,avg_distance:1187.0114479347926,delay_rate:15.346338187257686}],totalRows:5},e.appendChild(t)})();</script>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Southwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">88751</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">615.4201304774031</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">16.919245980326984</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;USAir&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">37683</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">629.5051349414855</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15.261523764031526</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;American&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">34577</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1089.8830147207682</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14.859588743962751</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Northwest&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33580</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">993.9399344848124</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">13.764145324597976</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;nickname&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;United&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32757</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;avg_distance&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1187.0114479347926</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;delay_rate&quot;</span><span style="color: #000000">: </span><span style="color: #098658">15.346338187257686</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   carriers_full_0.</span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;nickname&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;flight_count&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">AVG</span><span style="color: #000000">(base.</span><span style="color: #A31515">&quot;distance&quot;</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;avg_distance&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">   ((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> base.</span><span style="color: #A31515">&quot;dep_delay&quot;</span><span style="color: #000000">&gt;</span><span style="color: #098658">15</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))*</span><span style="color: #098658">1</span><span style="color: #000000">.</span><span style="color: #098658">0</span><span style="color: #000000">/(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">)))*</span><span style="color: #098658">100</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;delay_rate&quot;</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/flights.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> base</span></span>
<span class="line"><span style="color: #000000"> </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;../data/carriers.parquet&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> carriers_full_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> carriers_full_0.</span><span style="color: #A31515">&quot;code&quot;</span><span style="color: #000000">=base.</span><span style="color: #A31515">&quot;carrier&quot;</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span><span style="color: #000000"> NULLS </span><span style="color: #0000FF">LAST</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div><hr/>

      <h2>
        <a id="the-workflow" class="header-link anchor" href="#the-workflow">
          The Workflow
        </a>
      </h2>
    <ol>
<li><p><strong>Define sources</strong> - Point at your tables</p>
</li>
<li><p><strong>Explore</strong> - Use VS Code to understand data</p>
</li>
<li><p><strong>Query</strong> - Write ad-hoc queries to answer questions</p>
</li>
<li><p><strong>Notice patterns</strong> - Same aggregations? Same groupings?</p>
</li>
<li><p><strong>Promote</strong> - Move repeated patterns to measures/dimensions</p>
</li>
<li><p><strong>Add joins</strong> - When you need data from other tables</p>
</li>
<li><p><strong>Save views</strong> - For queries you'll reuse</p>
</li></ol>
<p>Build iteratively. Start simple, add what you need.</p>
<hr/>

      <h2>
        <a id="learn-more" class="header-link anchor" href="#learn-more">
          Learn More
        </a>
      </h2>
    <p>This guide covers the basics. See the language reference for <a href="../language/filters">filters</a>, <a href="../language/functions">functions</a>, <a href="../language/calculations_windows">window calculations</a>, and <a href="../language/nesting">nested views</a>. For common analytics patterns, see <a href="../patterns/percent_of_total">percent of total</a>, <a href="../patterns/yoy">year-over-year</a>, and <a href="../patterns/cohorts">cohort analysis</a>.</p>
<hr/>

      <h2>
        <a id="next-steps" class="header-link anchor" href="#next-steps">
          Next Steps
        </a>
      </h2>
    <ul>
<li><p><a href="malloy_by_example">Advanced Modeling</a> - Deep dive into nesting, pipelines, and complex joins</p>
</li>
<li><p><a href="troubleshooting">Troubleshooting</a> - Fix common modeling issues</p>
</li>
<li><p><a href="publishing/publishing">Publishing</a> - Deploy your model</p>
</li>
<li><p><a href="../language/statement">Language Reference</a> - Full syntax documentation</p>
</li></ul>
</div></div>
        </div>
        <script src="/js/view_toggles.js"></script>
        <script src="/js/jump_to_hash.js"></script>
      </div>
    </div>
    <div id="banner_wrapper">
      <div id="banner">
        <div>
          This site uses cookies from Google to deliver its services and to analyze
          traffic.
          <a
            href="https://policies.google.com/technologies/cookies"
            target="_blank"
          >
            Learn more
          </a>
        </div>
        <button id="banner_button">I Understand</button>
      </div>
    </div>
    <script src="/js/banner.js"></script>
    <script src="/js/generated/malloy-render-0.0.282.js"></script>
  </body>
</html>
